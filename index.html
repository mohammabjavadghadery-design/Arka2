
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#00ff8c">
    <meta name="description" content="ARKA - سیستم مدیریت هوشمند ویندوز با قابلیت‌های AI">
    <meta name="keywords" content="مدیریت سیستم, هوش مصنوعی, بهینه‌سازی ویندوز, مانیتورینگ">
    <meta name="author" content="ARKA Team">
    <title>ARKA - سیستم مدیریت هوشمند</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ============================================
           1. CSS Variables - Fixed Accessibility
           ============================================ */
        :root {
            /* === Colors === */
            --bg-dark: #0a0a0a;
            --bg-darker: #000000;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-tertiary: #666666;
            --glass-bg: rgba(30, 30, 46, 0.3);
            --glass-border: rgba(255, 255, 255, 0.1);
            --primary-neon: #00ff8c;
            --warning-neon: #ffaa00;
            --danger-neon: #ff1a1a;
            --success-neon: #00ff8c;
            --info-neon: #00e5ff;
            --cyan-neon: #00e5ff;
            --gradient-primary: linear-gradient(135deg, #00ff8c, #00e5ff);
            --gradient-warning: linear-gradient(135deg, #ffaa00, #ff5500);
            --gradient-danger: linear-gradient(135deg, #ff1a1a, #ff5500);

            /* === Shadows === */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.25);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.4);
            --shadow-neon: 0 0 20px rgba(0, 255, 140, 0.4), 0 0 40px rgba(0, 255, 140, 0.2);

            /* === Spacing === */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;

            /* === Border Radius === */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-round: 9999px;

            /* === Transitions === */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;

            /* === Z-Index === */
            --z-modal: 1000;
            --z-navbar: 900;
            --z-tooltip: 800;
            --z-toast: 700;
        }

        /* ============================================
           2. Base Styles - Fixed Accessibility
           ============================================ */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px; /* Base font size for rem units */
            scroll-behavior: smooth;
            background-color: var(--bg-dark);
            color-scheme: dark;
        }

        body {
            font-family: 'Vazir', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden; /* Prevent horizontal scroll */
            min-height: 100vh;
            position: relative;
            direction: rtl;
            text-align: right;
        }

        body.no-js .loading-overlay {
            display: none !important;
        }

        body.no-js .main-content {
            opacity: 1 !important;
            transform: none !important;
        }

        /* === Custom Scrollbar === */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-neon);
        }

        /* ============================================
           3. Typography - Fixed Accessibility
           ============================================ */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
        }

        h1 { font-size: 2.5rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.75rem; }
        h4 { font-size: 1.5rem; }
        h5 { font-size: 1.25rem; }
        h6 { font-size: 1rem; }

        p {
            margin-bottom: var(--space-md);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        a {
            color: var(--primary-neon);
            text-decoration: none;
            transition: var(--transition-fast);
        }

        a:hover {
            color: #00e67c;
            text-decoration: underline;
        }

        strong, b {
            font-weight: 700;
            color: var(--text-primary);
        }

        em, i {
            font-style: italic;
        }

        small {
            font-size: 0.875rem;
            color: var(--text-tertiary);
        }

        /* ============================================
           4. Layout - Fixed Accessibility
           ============================================ */
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-md);
        }

        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 calc(-1 * var(--space-md));
        }

        .col {
            flex: 1;
            padding: 0 var(--space-md);
        }

        .grid {
            display: grid;
            gap: var(--space-md);
        }

        .flex {
            display: flex;
        }

        .flex-column {
            flex-direction: column;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .align-center {
            align-items: center;
        }

        .text-center {
            text-align: center !important;
        }

        .text-right {
            text-align: right !important;
        }

        .text-left {
            text-align: left !important;
        }

        .d-none {
            display: none !important;
        }

        .d-block {
            display: block !important;
        }

        .d-flex {
            display: flex !important;
        }

        .d-grid {
            display: grid !important;
        }

        .w-100 {
            width: 100% !important;
        }

        .h-100 {
            height: 100% !important;
        }

        .m-0 { margin: 0 !important; }
        .mt-0 { margin-top: 0 !important; }
        .mb-0 { margin-bottom: 0 !important; }
        .p-0 { padding: 0 !important; }
        .pt-0 { padding-top: 0 !important; }
        .pb-0 { padding-bottom: 0 !important; }

        .m-1 { margin: var(--space-sm) !important; }
        .m-2 { margin: var(--space-md) !important; }
        .m-3 { margin: var(--space-lg) !important; }
        .m-4 { margin: var(--space-xl) !important; }
        .m-5 { margin: var(--space-2xl) !important; }

        .p-1 { padding: var(--space-sm) !important; }
        .p-2 { padding: var(--space-md) !important; }
        .p-3 { padding: var(--space-lg) !important; }
        .p-4 { padding: var(--space-xl) !important; }
        .p-5 { padding: var(--space-2xl) !important; }

        /* ============================================
           5. Components - Fixed Accessibility
           ============================================ */
        /* Glass Card */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            box-shadow: var(--shadow-lg);
            transition: var(--transition-normal);
            overflow: hidden;
        }

        .glass-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: rgba(0, 255, 140, 0.3);
        }

        /* Status Card */
        .status-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            transition: var(--transition-normal);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .status-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary-neon);
        }

        .status-icon {
            font-size: 2.5rem;
            margin-bottom: var(--space-md);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-neon);
            margin-bottom: var(--space-xs);
        }

        .status-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            border: none;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
            min-height: 40px;
            white-space: nowrap;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }

        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }

        @keyframes ripple {
            0% { transform: scale(0, 0); opacity: 0.5; }
            20% { transform: scale(25, 25); opacity: 0.3; }
            100% { transform: scale(40, 40); opacity: 0; }
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Button Variants - Fixed Accessibility */
        .btn-primary {
            background: var(--gradient-primary);
            color: var(--bg-darker);
            border: none;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #00e67c, #00e6e6);
            box-shadow: 0 5px 20px rgba(0, 255, 140, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .btn-success {
            background: var(--success-neon);
            color: var(--bg-darker);
        }

        .btn-success:hover {
            background: #00cc70;
            box-shadow: 0 5px 15px rgba(0, 255, 140, 0.3);
        }

        .btn-warning {
            background: var(--warning-neon);
            color: var(--bg-darker);
        }

        .btn-warning:hover {
            background: #e69900;
            box-shadow: 0 5px 15px rgba(255, 170, 0, 0.3);
        }

        .btn-danger {
            background: var(--danger-neon);
            color: var(--bg-darker);
        }

        .btn-danger:hover {
            background: #e60000;
            box-shadow: 0 5px 15px rgba(255, 26, 26, 0.3);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary-neon);
            color: var(--primary-neon);
        }

        .btn-outline:hover {
            background: rgba(0, 255, 140, 0.1);
        }

        .btn-icon {
            padding: var(--space-sm);
            min-width: auto;
        }

        /* Input Styles */
        .form-control {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition-fast);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-neon);
            box-shadow: var(--shadow-neon);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-group {
            margin-bottom: var(--space-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-control:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Progress Bar */
        .progress {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: var(--space-sm);
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 4px;
            transition: width var(--transition-normal);
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 4px;
            font-weight: 500;
        }

        /* ============================================
           6. Navbar Styles - Fixed Accessibility
           ============================================ */
        .main-navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: var(--bg-darker);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: var(--space-sm) var(--space-lg);
            z-index: var(--z-navbar);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .navbar-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .brand-logo {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--bg-darker);
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            margin-right: var(--space-sm);
            gap: var(--space-xs);
        }

        .brand-text h1 {
            font-size: 1.5rem;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
            line-height: 1;
        }

        .brand-text span {
            font-size: 0.7rem;
            color: var(--text-secondary);
            display: block;
            line-height: 1.2;
        }

        .nav-list {
            display: flex;
            gap: var(--space-sm);
        }

        .nav-item {
            list-style: none;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-sm) var(--space-md);
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: var(--transition-fast);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--primary-neon);
            background: rgba(0, 255, 140, 0.1);
        }

        .nav-link i {
            font-size: 1.1rem;
        }

        .navbar-controls {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-round);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .control-btn:hover {
            background: rgba(0, 255, 140, 0.1);
            border-color: var(--primary-neon);
            color: var(--primary-neon);
        }

        .notification-badge {
            position: absolute;
            top: -4px;
            left: -4px;
            background: var(--danger-neon);
            color: var(--bg-darker);
            font-size: 0.6rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* ============================================
           7. Dashboard Cards - Fixed Accessibility
           ============================================ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-2xl);
        }

        /* CPU Card Specific */
        .cpu-chart-container {
            height: 150px;
            margin-bottom: var(--space-md);
        }

        .cpu-time-selector {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .time-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .time-btn.active, .time-btn:hover {
            background: var(--primary-neon);
            color: var(--bg-darker);
            border-color: transparent;
        }

        /* RAM Card Specific - Fixed Progress UI */
        .ram-chart-container {
            height: 150px;
            margin-bottom: var(--space-md);
        }

        .ram-breakdown {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .ram-item {
            padding: var(--space-sm);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
        }

        .ram-label {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-bottom: var(--space-xs);
        }

        .ram-value {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Disk Card Specific */
        .disk-chart-container {
            height: 150px;
            margin-bottom: var(--space-md);
        }

        .disk-partitions {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .partition-item {
            padding: var(--space-sm);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
        }

        .partition-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xs);
        }

        .partition-drive {
            font-weight: 700;
            color: var(--primary-neon);
            font-size: 1rem;
        }

        .partition-type {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 10px;
        }

        .partition-progress {
            margin-top: var(--space-xs);
        }

        /* Network Card Specific */
        .network-chart-container {
            height: 150px;
            margin-bottom: var(--space-md);
        }

        .network-stats {
            padding: var(--space-sm);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            margin-top: var(--space-md);
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-xs);
        }

        .stat-item i {
            font-size: 1.2rem;
            color: var(--cyan-neon);
            width: 24px;
            min-width: 24px;
            text-align: center;
        }

        .stat-content {
            flex: 1;
        }

        .stat-content .label {
            display: block;
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-bottom: 2px;
            font-weight: 300;
        }

        .stat-content .value {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Card Footer - Fixed Button Styles */
        .card-footer {
            margin-top: var(--space-lg);
            padding-top: var(--space-md);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-actions {
            display: flex;
            gap: var(--space-sm);
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        /* ============================================
           8. Quick Actions Panel - Fixed Grid Layout
           ============================================ */
        .quick-actions-section {
            margin-bottom: var(--space-2xl);
        }

        .section-header {
            margin-bottom: var(--space-lg);
        }

        .section-header h2, .section-header h3, .section-header h4 {
            margin-bottom: var(--space-xs);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-primary);
        }

        .section-header h2 { font-size: 1.8rem; font-weight: 700; }
        .section-header h3 { font-size: 1.5rem; font-weight: 600; }
        .section-header h4 { font-size: 1.2rem; font-weight: 600; }

        .section-header p {
            color: var(--text-tertiary);
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .action-btn {
            padding: var(--space-lg);
            text-align: right;
            position: relative;
            overflow: hidden;
            transition: all var(--transition-normal);
            border: none;
            background: none;
            cursor: pointer;
            width: 100%;
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .action-btn:hover {
            transform: translateY(-8px);
        }

        .action-icon {
            font-size: 2rem;
            margin-bottom: var(--space-md);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: inline-block;
        }

        .action-content {
            text-align: center;
        }

        .action-content h4 {
            margin-bottom: var(--space-xs);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .action-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
            font-family: var(--font-primary);
            font-size: 0.9rem;
        }

        /* ============================================
           9. Activity Section - Fixed Accessibility
           ============================================ */
        .activity-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-lg);
        }

        .activity-column {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        .recent-commands, .system-alerts, .performance-tips {
            padding: var(--space-xl);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            height: 100%;
        }

        .commands-list, .alerts-container, .tips-container {
            margin-top: var(--space-lg);
            max-height: 400px;
            overflow-y: auto;
        }

        .commands-list .empty-state {
            text-align: center;
            padding: var(--space-xl);
            color: var(--text-tertiary);
        }

        .commands-list .empty-state i {
            font-size: 3rem;
            margin-bottom: var(--space-md);
            opacity: 0.5;
        }

        .command-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: var(--space-sm);
            transition: var(--transition-fast);
        }

        .command-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 255, 140, 0.2);
        }

        .command-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .command-text {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: var(--space-xs);
            word-break: break-all;
            direction: ltr;
            text-align: left;
            font-weight: 500;
        }

        .command-time {
            font-size: 0.8rem;
            color: var(--text-tertiary);
        }

        .command-status {
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 500;
            margin-right: var(--space-md);
        }

        .command-status.success {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .command-status.error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .command-status.warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .command-status.info {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .alert-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-sm);
            animation: fadeIn 0.3s ease;
        }

        .alert-item.warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .alert-item.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .alert-item.info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .alert-item i {
            font-size: 1.2rem;
            margin-top: 2px;
        }

        .warning { color: var(--warning-neon); }
        .error { color: var(--danger-neon); }
        .info { color: var(--info-neon); }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 600;
            color: var(--text-primary);
            display: block;
            margin-bottom: var(--space-xs);
        }

        .alert-message {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            margin-bottom: var(--space-sm);
            background: rgba(255, 255, 255, 0.03);
            transition: var(--transition-fast);
        }

        .tip-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 255, 140, 0.1);
        }

        .tip-item i {
            font-size: 1.5rem;
            margin-top: 2px;
            color: var(--primary-neon);
        }

        .tip-content h4 {
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
            font-size: 1rem;
        }

        .tip-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin: 0;
            line-height: 1.5;
        }

        /* ============================================
           10. AI Center Styles - Fixed Grid Layout
           ============================================ */
        .ai-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: var(--space-lg);
            height: 100%;
        }

        .ai-sidebar {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            height: fit-content;
        }

        .ai-main-content {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
        }

        .ai-quick-input {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .ai-quick-input .form-control {
            flex: 1;
        }

        .ai-suggestions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .suggestion-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            text-align: right;
            font-family: var(--font-primary);
            font-size: 0.9rem;
        }

        .suggestion-btn:hover {
            background: rgba(0, 255, 140, 0.1);
            border-color: rgba(0, 255, 140, 0.3);
            color: var(--primary-neon);
        }

        .suggestion-btn i {
            font-size: 1.1rem;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }

        .tool-card {
            padding: var(--space-lg);
            text-align: center;
            transition: var(--transition-normal);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tool-card:hover {
            transform: translateY(-8px);
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(0, 255, 140, 0.2);
        }

        .tool-icon {
            font-size: 2rem;
            margin-bottom: var(--space-md);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .tool-card h4 {
            margin-bottom: var(--space-xs);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .tool-card p {
            color: var(--text-tertiary);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Chat Interface */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .chat-header {
            padding: var(--space-lg);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .chat-header i {
            font-size: 1.5rem;
            color: var(--primary-neon);
        }

        .chat-header h3 {
            margin: 0;
            font-size: 1.3rem;
        }

        .chat-messages {
            flex: 1;
            padding: var(--space-lg);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .message {
            max-width: 80%;
            padding: var(--space-md);
            border-radius: var(--radius-lg);
            position: relative;
            animation: fadeInUp 0.3s ease;
        }

        .message.user {
            align-self: flex-start;
            background: rgba(0, 255, 140, 0.1);
            border: 1px solid rgba(0, 255, 140, 0.2);
            border-bottom-left-radius: var(--radius-sm);
        }

        .message.ai {
            align-self: flex-end;
            background: rgba(0, 229, 255, 0.1);
            border: 1px solid rgba(0, 229, 255, 0.2);
            border-bottom-right-radius: var(--radius-sm);
        }

        .message-content {
            line-height: 1.5;
        }

        .message-content p {
            margin: 0;
            color: var(--text-primary);
        }

        .message-content code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #ffaa00;
        }

        .message-content pre {
            background: rgba(0, 0, 0, 0.3);
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
            overflow-x: auto;
            margin: var(--space-sm) 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #00ff8c;
        }

        .message-time {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-top: var(--space-xs);
            text-align: left;
        }

        .chat-input-container {
            padding: var(--space-lg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
        }

        .chat-input-container textarea {
            width: 100%;
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
            direction: rtl;
            text-align: right;
            line-height: 1.5;
        }

        .chat-input-container textarea:focus {
            outline: none;
            border-color: var(--primary-neon);
            box-shadow: var(--shadow-neon);
            background: rgba(255, 255, 255, 0.08);
        }

        .chat-send-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: var(--space-sm);
            gap: var(--space-sm);
        }

        /* AI Tools - Fixed Grid Layout */
        .ai-tools-container {
            padding: var(--space-lg);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
        }

        /* ============================================
           11. Command Sections (CMD, PS, Run) - Fixed Accessibility
           ============================================ */
        .command-section {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: var(--space-lg);
            height: 100%;
        }

        .command-list-container {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .command-list-header {
            padding: var(--space-md);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .command-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-sm);
        }

        .command-list-item {
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xs);
        }

        .command-list-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .command-list-item.active {
            background: rgba(0, 255, 140, 0.1);
            border: 1px solid rgba(0, 255, 140, 0.3);
        }

        .command-list-item .command-name {
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .command-list-item .command-desc {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-top: var(--space-xs);
        }

        .command-details-container {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .command-details-header {
            padding: var(--space-md);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .command-details-content {
            flex: 1;
            padding: var(--space-lg);
            overflow-y: auto;
        }

        .command-details-title {
            font-size: 1.5rem;
            margin-bottom: var(--space-sm);
            color: var(--primary-neon);
        }

        .command-details-description {
            margin-bottom: var(--space-lg);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .command-details-syntax {
            background: rgba(0, 0, 0, 0.3);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            font-family: 'Courier New', monospace;
            color: #00ff8c;
            margin-bottom: var(--space-lg);
            overflow-x: auto;
        }

        .command-details-parameters {
            margin-bottom: var(--space-lg);
        }

        .parameter-item {
            margin-bottom: var(--space-md);
        }

        .parameter-name {
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        .parameter-desc {
            color: var(--text-secondary);
            margin-top: var(--space-xs);
            font-size: 0.9rem;
        }

        .command-details-examples {
            margin-bottom: var(--space-lg);
        }

        .example-item {
            margin-bottom: var(--space-md);
        }

        .example-code {
            background: rgba(0, 0, 0, 0.3);
            padding: var(--space-sm);
            border-radius: var(--radius-sm);
            font-family: 'Courier New', monospace;
            color: #ffaa00;
            overflow-x: auto;
            margin-top: var(--space-xs);
        }

        .command-details-notes {
            background: rgba(255, 165, 0, 0.1);
            border: 1px solid rgba(255, 165, 0, 0.3);
            border-radius: var(--radius-sm);
            padding: var(--space-md);
            margin-top: var(--space-lg);
        }

        .command-details-notes h5 {
            margin-top: 0;
            color: var(--warning-neon);
        }

        .command-details-actions {
            padding: var(--space-lg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.1);
            display: flex;
            gap: var(--space-sm);
            justify-content: flex-end;
        }

        /* ============================================
           12. Page Structure - Fixed Accessibility
           ============================================ */
        .page {
            display: none;
            padding: var(--space-xl) var(--space-lg);
            min-height: calc(100vh - 80px); /* Account for navbar */
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        .page-header {
            margin-bottom: var(--space-2xl);
            text-align: center;
        }

        .page-header h1 {
            font-size: 2.5rem;
            margin-bottom: var(--space-xs);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            padding-top: 80px; /* Account for fixed navbar */
            padding-bottom: var(--space-2xl);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity var(--transition-normal), transform var(--transition-normal);
        }

        .main-content.loaded {
            opacity: 1;
            transform: translateY(0);
        }

        /* ============================================
           13. Loading & Overlay Styles - Fixed Accessibility
           ============================================ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-darker);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity var(--transition-normal);
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .logo-text h1 {
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-xs);
            letter-spacing: -0.5px;
        }

        .logo-text p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 300;
        }

        .loading-progress {
            margin-bottom: var(--space-lg);
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: var(--space-md);
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            width: 0%;
            transition: width var(--transition-normal);
        }

        .progress-text {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .mobile-warning-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            display: none; /* Hidden by default, shown via JS if mobile */
            align-items: center;
            justify-content: center;
            z-index: 9998;
            padding: var(--space-md);
            animation: fadeIn var(--transition-normal);
        }

        .warning-container {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--space-2xl);
            max-width: 500px;
            width: 100%;
            text-align: center;
            animation: slideIn 0.5s ease;
        }

        .warning-icon {
            font-size: 4rem;
            color: var(--warning-neon);
            margin-bottom: var(--space-lg);
            animation: pulse 2s infinite;
        }

        .warning-container h2 {
            font-size: 1.8rem;
            margin-bottom: var(--space-md);
            color: var(--warning-neon);
        }

        .warning-container p {
            color: var(--text-secondary);
            margin-bottom: var(--space-xl);
            line-height: 1.6;
        }

        .btn-return {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .btn-return:hover {
            background: rgba(0, 255, 140, 0.1);
            border-color: var(--primary-neon);
            color: var(--primary-neon);
        }

        /* ============================================
           14. Form Styles - Fixed Accessibility
           ============================================ */
        .form-range {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .form-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-neon);
            cursor: pointer;
            box-shadow: var(--shadow-neon);
            transition: var(--transition-fast);
        }

        .form-range::-webkit-slider-thumb:hover {
            box-shadow: var(--shadow-neon);
            transform: scale(1.2);
        }

        .form-range::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        /* ============================================
           15. Modal Styles - Fixed Accessibility
           ============================================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: var(--z-modal);
            display: none;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
            animation: fadeIn 0.3s ease;
        }

        .modal {
            background: var(--bg-dark);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-xl);
            transform: scale(0.95);
            animation: modalAppear 0.4s ease forwards;
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            padding: var(--space-lg) var(--space-xl);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.1);
        }

        .modal-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 1.3rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition-normal);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-round);
        }

        .modal-close:hover {
            color: var(--danger-neon);
            background: rgba(255, 26, 26, 0.1);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: var(--space-xl);
            flex: 1;
            overflow-y: auto;
        }

        .modal-footer {
            padding: var(--space-lg) var(--space-xl);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            gap: var(--space-sm);
            justify-content: flex-end;
            background: rgba(0, 0, 0, 0.05);
        }

        /* Permission Modal Specific */
        .permission-details {
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            margin: var(--space-lg) 0;
        }

        .detail-row {
            display: flex;
            gap: var(--space-md);
            align-items: flex-start;
        }

        .detail-icon {
            font-size: 1.5rem;
            color: var(--primary-neon);
            margin-top: 2px;
            flex-shrink: 0;
        }

        .detail-content h5 {
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .detail-content ul {
            list-style: none;
            padding-right: var(--space-md);
            margin-top: var(--space-xs);
        }

        .detail-content li {
            padding: var(--space-xs) 0;
            color: var(--text-secondary);
            position: relative;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .detail-content li::before {
            content: '•';
            color: var(--primary-neon);
            position: absolute;
            right: -15px;
        }

        /* ============================================
           16. Animations - Fixed Accessibility
           ============================================ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(20px); opacity: 0; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(0, 255, 140, 0.5); }
            50% { box-shadow: 0 0 20px rgba(0, 255, 140, 0.8); }
            100% { box-shadow: 0 0 5px rgba(0, 255, 140, 0.5); }
        }

        .animate-glow {
            animation: glow 2s infinite;
        }

        /* ============================================
           17. Responsive Design - Fixed Accessibility
           ============================================ */
        @media (max-width: 1200px) {
            html { font-size: 15px; }
            .dashboard-grid { grid-template-columns: repeat(2, 1fr); }
            .ai-container { grid-template-columns: 1fr; }
            .ai-sidebar { position: static; order: 2; width: 100%; }
            .ai-main-content { order: 1; }
            .activity-section { grid-template-columns: 1fr; }
        }

        @media (max-width: 992px) {
            html { font-size: 15px; }
            .main-navbar { padding: var(--space-sm); }
            .navbar-container { flex-direction: column; gap: var(--space-md); }
            .nav-list { flex-wrap: wrap; justify-content: center; margin: var(--space-sm) 0; }
            .navbar-controls { width: 100%; justify-content: center; }
            .main-content { padding: var(--space-md); }
            .footer-content { grid-template-columns: 1fr; }
            .footer-bottom { flex-direction: column; text-align: center; }
            .footer-links { justify-content: center; margin-top: var(--space-sm); }
        }

        @media (max-width: 768px) {
            html { font-size: 14px; }
            h1 { font-size: 2rem; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .quick-actions-grid { grid-template-columns: repeat(2, 1fr); }
            .ai-suggestions { grid-template-columns: repeat(2, 1fr); }
            .tools-grid { grid-template-columns: repeat(2, 1fr); }
            .footer-content { grid-template-columns: 1fr; }
            .footer-bottom { flex-direction: column; text-align: center; }
            .footer-links { justify-content: center; margin-top: var(--space-sm); }
            .modal { max-width: 95%; }
            .command-section { grid-template-columns: 1fr; } /* Stack on mobile */
        }

        @media (max-width: 576px) {
            .quick-actions-grid,
            .ai-suggestions,
            .tools-grid { grid-template-columns: 1fr; }
            .stat-grid { grid-template-columns: 1fr; }
            .ram-breakdown { grid-template-columns: 1fr; }
            .ai-quick-input { flex-direction: column; }
            .ai-quick-input .btn { width: 100%; }
            .modal-footer { flex-direction: column; }
            .modal-footer .btn { width: 100%; margin-bottom: var(--space-sm); }
            .modal-footer .btn:last-child { margin-bottom: 0; }
            .chat-messages { padding: var(--space-sm); }
            .message { max-width: 95%; }
            .page-header h1 { font-size: 2rem; }
            .page-header p { font-size: 1rem; }
        }

        /* ============================================
           18. Utility Classes - Fixed Accessibility
           ============================================ */
        .text-center { text-align: center !important; }
        .text-right { text-align: right !important; }
        .text-left { text-align: left !important; }
        .text-primary { color: var(--primary-neon) !important; }
        .text-warning { color: var(--warning-neon) !important; }
        .text-danger { color: var(--danger-neon) !important; }
        .text-success { color: var(--success-neon) !important; }
        .text-info { color: var(--info-neon) !important; }
        .bg-primary { background-color: var(--primary-neon) !important; }
        .bg-warning { background-color: var(--warning-neon) !important; }
        .bg-danger { background-color: var(--danger-neon) !important; }
        .bg-success { background-color: var(--success-neon) !important; }
        .bg-info { background-color: var(--info-neon) !important; }
        .fw-bold { font-weight: bold !important; }
        .fw-normal { font-weight: normal !important; }
        .fw-light { font-weight: 300 !important; }
        .fs-1 { font-size: 2.5rem !important; }
        .fs-2 { font-size: 2rem !important; }
        .fs-3 { font-size: 1.75rem !important; }
        .fs-4 { font-size: 1.5rem !important; }
        .fs-5 { font-size: 1.25rem !important; }
        .fs-6 { font-size: 1rem !important; }
        .lh-1 { line-height: 1 !important; }
        .lh-sm { line-height: 1.25 !important; }
        .lh-base { line-height: 1.5 !important; }
        .lh-lg { line-height: 2 !important; }
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-inline { display: inline !important; }
        .d-inline-block { display: inline-block !important; }
        .d-flex { display: flex !important; }
        .d-grid { display: grid !important; }
        .d-table { display: table !important; }
        .d-table-row { display: table-row !important; }
        .d-table-cell { display: table-cell !important; }
        .d-inline-flex { display: inline-flex !important; }
        .d-inline-grid { display: inline-grid !important; }
        .w-25 { width: 25% !important; }
        .w-50 { width: 50% !important; }
        .w-75 { width: 75% !important; }
        .w-100 { width: 100% !important; }
        .w-auto { width: auto !important; }
        .h-25 { height: 25% !important; }
        .h-50 { height: 50% !important; }
        .h-75 { height: 75% !important; }
        .h-100 { height: 100% !important; }
        .h-auto { height: auto !important; }
        .mw-100 { max-width: 100% !important; }
        .mh-100 { max-height: 100% !important; }
        .m-0 { margin: 0 !important; }
        .mt-0,
        .my-0 { margin-top: 0 !important; }
        .mr-0,
        .mx-0 { margin-right: 0 !important; }
        .mb-0,
        .my-0 { margin-bottom: 0 !important; }
        .ml-0,
        .mx-0 { margin-left: 0 !important; }
        .m-1 { margin: 0.25rem !important; }
        .mt-1,
        .my-1 { margin-top: 0.25rem !important; }
        .mr-1,
        .mx-1 { margin-right: 0.25rem !important; }
        .mb-1,
        .my-1 { margin-bottom: 0.25rem !important; }
        .ml-1,
        .mx-1 { margin-left: 0.25rem !important; }
        .m-2 { margin: 0.5rem !important; }
        .mt-2,
        .my-2 { margin-top: 0.5rem !important; }
        .mr-2,
        .mx-2 { margin-right: 0.5rem !important; }
        .mb-2,
        .my-2 { margin-bottom: 0.5rem !important; }
        .ml-2,
        .mx-2 { margin-left: 0.5rem !important; }
        .m-3 { margin: 1rem !important; }
        .mt-3,
        .my-3 { margin-top: 1rem !important; }
        .mr-3,
        .mx-3 { margin-right: 1rem !important; }
        .mb-3,
        .my-3 { margin-bottom: 1rem !important; }
        .ml-3,
        .mx-3 { margin-left: 1rem !important; }
        .m-4 { margin: 1.5rem !important; }
        .mt-4,
        .my-4 { margin-top: 1.5rem !important; }
        .mr-4,
        .mx-4 { margin-right: 1.5rem !important; }
        .mb-4,
        .my-4 { margin-bottom: 1.5rem !important; }
        .ml-4,
        .mx-4 { margin-left: 1.5rem !important; }
        .m-5 { margin: 3rem !important; }
        .mt-5,
        .my-5 { margin-top: 3rem !important; }
        .mr-5,
        .mx-5 { margin-right: 3rem !important; }
        .mb-5,
        .my-5 { margin-bottom: 3rem !important; }
        .ml-5,
        .mx-5 { margin-left: 3rem !important; }
        .p-0 { padding: 0 !important; }
        .pt-0,
        .py-0 { padding-top: 0 !important; }
        .pr-0,
        .px-0 { padding-right: 0 !important; }
        .pb-0,
        .py-0 { padding-bottom: 0 !important; }
        .pl-0,
        .px-0 { padding-left: 0 !important; }
        .p-1 { padding: 0.25rem !important; }
        .pt-1,
        .py-1 { padding-top: 0.25rem !important; }
        .pr-1,
        .px-1 { padding-right: 0.25rem !important; }
        .pb-1,
        .py-1 { padding-bottom: 0.25rem !important; }
        .pl-1,
        .px-1 { padding-left: 0.25rem !important; }
        .p-2 { padding: 0.5rem !important; }
        .pt-2,
        .py-2 { padding-top: 0.5rem !important; }
        .pr-2,
        .px-2 { padding-right: 0.5rem !important; }
        .pb-2,
        .py-2 { padding-bottom: 0.5rem !important; }
        .pl-2,
        .px-2 { padding-left: 0.5rem !important; }
        .p-3 { padding: 1rem !important; }
        .pt-3,
        .py-3 { padding-top: 1rem !important; }
        .pr-3,
        .px-3 { padding-right: 1rem !important; }
        .pb-3,
        .py-3 { padding-bottom: 1rem !important; }
        .pl-3,
        .px-3 { padding-left: 1rem !important; }
        .p-4 { padding: 1.5rem !important; }
        .pt-4,
        .py-4 { padding-top: 1.5rem !important; }
        .pr-4,
        .px-4 { padding-right: 1.5rem !important; }
        .pb-4,
        .py-4 { padding-bottom: 1.5rem !important; }
        .pl-4,
        .px-4 { padding-left: 1.5rem !important; }
        .p-5 { padding: 3rem !important; }
        .pt-5,
        .py-5 { padding-top: 3rem !important; }
        .pr-5,
        .px-5 { padding-right: 3rem !important; }
        .pb-5,
        .py-5 { padding-bottom: 3rem !important; }
        .pl-5,
        .px-5 { padding-left: 3rem !important; }
        .m-auto { margin: auto !important; }
        .mt-auto,
        .my-auto { margin-top: auto !important; }
        .mr-auto,
        .mx-auto { margin-right: auto !important; }
        .mb-auto,
        .my-auto { margin-bottom: auto !important; }
        .ml-auto,
        .mx-auto { margin-left: auto !important; }
        .stretched-link::after { position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: 1; pointer-events: auto; content: ""; background-color: rgba(0, 0, 0, 0); }

        /* ============================================
           19. Print Styles - Fixed Accessibility
           ============================================ */
        @media print {
            .no-print, .loading-overlay, .mobile-warning-overlay, .navbar-controls, .notification-badge, .control-btn, .footer-links, .social-links, .modal-overlay, .chat-input-container, .quick-actions-section, .page-header p { display: none !important; }
            body { background: white !important; color: black !important; }
            .glass-card, .status-card, .ai-container, .activity-section { background: white !important; border: 1px solid #ddd !important; box-shadow: none !important; break-inside: avoid; }
            .glass-card:hover { transform: none !important; box-shadow: none !important; }
            .command-text { direction: ltr !important; text-align: left !important; }
            .stat-value, .status-value { color: #000 !important; }
            .text-primary { color: #000 !important; }
            .btn { border: 1px solid #ccc !important; color: #000 !important; background: #eee !important; }
        }

        /* ============================================
           20. Toast Notifications - New Component
           ============================================ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .toast.toast-error { background: rgba(239, 68, 68, 0.9); }
        .toast.toast-warning { background: rgba(245, 158, 11, 0.9); }
        .toast.toast-info { background: rgba(59, 130, 246, 0.9); }
        .toast.show { transform: translateX(0); }
        .toast-content { display: flex; align-items: center; gap: var(--space-sm); flex: 1; }
        .toast-icon { font-size: 1.2rem; min-width: 20px; text-align: center; }
        .toast-message { flex: 1; line-height: 1.4; }
        .toast-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: var(--radius-round); transition: var(--transition-fast); }
        .toast-close:hover { background: rgba(0, 0, 0, 0.2); }

        /* ============================================
           21. System Alerts - New Component
           ============================================ */
        .system-alerts-container {
            position: fixed;
            top: 20px;
            left: 0;
            right: 0;
            z-index: var(--z-tooltip);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
            pointer-events: none;
            padding: 0 var(--space-md);
        }

        .system-alert {
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 100%;
            opacity: 0;
            transform: translateY(-20px);
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            pointer-events: all;
        }

        .system-alert.show { opacity: 1; transform: translateY(0); }
        .system-alert.alert-error { background: rgba(239, 68, 68, 0.9); }
        .system-alert.alert-warning { background: rgba(245, 158, 11, 0.9); }
        .system-alert.alert-info { background: rgba(59, 130, 246, 0.9); }

        /* ============================================
           22. Error States - New Component
           ============================================ */
        .error-state {
            text-align: center;
            padding: var(--space-2xl);
            color: var(--text-tertiary);
        }

        .error-state i {
            font-size: 3rem;
            margin-bottom: var(--space-md);
            color: var(--danger-neon);
            opacity: 0.8;
        }

        .error-state h3 {
            font-size: 1.5rem;
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
        }

        .error-state p {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* ============================================
           23. Loading States - Enhanced
           ============================================ */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid var(--primary-neon);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .btn .loading-spinner {
            margin-left: var(--space-sm);
        }

        /* ============================================
           24. Command List Specific (Added for functionality)
           ============================================ */
        .command-list-item {
            cursor: pointer;
            transition: var(--transition-fast);
            position: relative;
        }

        .command-list-item::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            width: 3px;
            background: transparent;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }

        .command-list-item:hover::after {
            background: var(--primary-neon);
        }

        .command-list-item.active::after {
            background: var(--success-neon);
        }

        /* ============================================
           25. History & Pinned Items (Added for functionality)
           ============================================ */
        .history-item, .pinned-item {
            padding: var(--space-sm);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: var(--space-sm);
            transition: var(--transition-fast);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .history-item.active, .history-item:hover, .pinned-item:hover {
            background: rgba(0, 255, 140, 0.1);
            color: var(--primary-neon);
        }

        .history-preview {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-size: 0.9rem;
        }

        .history-time {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            white-space: nowrap;
        }

        .empty-state {
            text-align: center;
            padding: var(--space-lg);
            color: var(--text-tertiary);
            font-size: 0.9rem;
        }

        .empty-state i {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
            opacity: 0.5;
        }

    </style>
</head>
<body class="no-js">
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="logo-text">
            <h1>ARKA</h1>
            <p>سیستم مدیریت هوشمند ویندوز</p>
        </div>
        <div class="loading-progress">
            <div class="progress-bar">
                <div class="progress-fill" id="loadingProgressFill"></div>
            </div>
            <div class="progress-text" id="loadingProgressText">در حال بارگذاری...</div>
        </div>
    </div>

    <!-- Mobile Warning Overlay -->
    <div class="mobile-warning-overlay" id="mobileWarningOverlay">
        <div class="warning-container">
            <i class="fas fa-exclamation-triangle warning-icon" aria-hidden="true"></i>
            <h2>نسخه دسکتاپ مورد نیاز است</h2>
            <p>این سایت برای تجربه بهتر بر روی دسکتاپ طراحی شده است. لطفاً از یک رایانه شخصی یا لپ‌تاپ استفاده کنید تا بتوانید از تمام ویژگی‌های آن لذت ببرید.</p>
            <button class="btn btn-primary" id="closeMobileWarningBtn">
                <i class="fas fa-desktop"></i> متوجه شدم، ادامه می‌دهم
            </button>
        </div>
    </div>

    <!-- Main Navbar -->
    <nav class="main-navbar">
        <div class="navbar-container">
            <div class="brand">
                <div class="flex align-center">
                    <div class="brand-logo">
                        <i class="fas fa-brain" aria-hidden="true"></i>
                    </div>
                    <div class="brand-text">
                        <h1>ARKA</h1>
                        <span>مرجع دستورات ویندوز</span>
                    </div>
                </div>
            </div>
            <ul class="nav-list">
                <li class="nav-item"><a href="#" class="nav-link active" data-page="dashboard"><i class="fas fa-home"></i> داشبورد</a></li>
                <li class="nav-item"><a href="#" class="nav-link" data-page="cmd-section"><i class="fas fa-terminal"></i> CMD</a></li>
                <li class="nav-item"><a href="#" class="nav-link" data-page="ps-section"><i class="fas fa-cogs"></i> PowerShell</a></li>
                <li class="nav-item"><a href="#" class="nav-link" data-page="run-section"><i class="fas fa-play-circle"></i> Run</a></li>
                <li class="nav-item"><a href="#" class="nav-link" data-page="ai-center"><i class="fas fa-robot"></i> هوش مصنوعی</a></li>
            </ul>
            <div class="navbar-controls">
                <button class="control-btn" id="themeToggleBtn" title="تغییر تم">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                <button class="control-btn" id="soundToggleBtn" title="کنترل صدا">
                    <i class="fas fa-volume-up" id="soundIcon"></i>
                </button>
                <button class="control-btn" id="notificationsToggleBtn" title="اعلان‌ها">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge d-none" id="notificationsBadge">3</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard Page -->
        <div class="page active" id="dashboard-page" aria-labelledby="dashboardTitle">
            <div class="page-header">
                <h1 id="dashboardTitle"><i class="fas fa-chart-line" aria-hidden="true"></i> داشبورد سیستم</h1>
                <p>نمای کلی از وضعیت سیستم، عملکرد و اقدامات اخیر</p>
            </div>

            <!-- System Status Cards -->
            <section class="dashboard-grid">
                <!-- CPU Card -->
                <div class="glass-card status-card">
                    <i class="fas fa-microchip status-icon" aria-hidden="true"></i>
                    <div class="status-value" id="cpuUsage">0%</div>
                    <div class="status-label">مصرف CPU</div>
                    <div class="progress">
                        <div class="progress-fill" id="cpuProgressFill"></div>
                    </div>
                    <div class="progress-text" id="cpuProgressText">0%</div>
                    <div class="cpu-chart-container">
                        <canvas id="cpuChart"></canvas>
                    </div>
                    <div class="cpu-time-selector">
                        <button class="time-btn" data-time-range="1m" aria-label="یک دقیقه">1 دقیقه</button>
                        <button class="time-btn active" data-time-range="5m" aria-label="پنج دقیقه">5 دقیقه</button>
                        <button class="time-btn" data-time-range="1h" aria-label="یک ساعت">1 ساعت</button>
                    </div>
                    <div class="card-footer">
                        <div class="footer-actions">
                            <span>مصرف فعلی: <strong class="text-primary" id="cpuUsageDetail">45.2%</strong></span>
                            <span>دما: <strong class="text-warning">65°C</strong></span>
                            <span>هسته‌ها: <strong>8</strong></span>
                        </div>
                    </div>
                </div>

                <!-- RAM Card -->
                <div class="glass-card status-card">
                    <i class="fas fa-memory status-icon" aria-hidden="true"></i>
                    <div class="status-value" id="ramUsage">0%</div>
                    <div class="status-label">مصرف RAM</div>
                    <div class="progress">
                        <div class="progress-fill" id="ramProgressFill"></div>
                    </div>
                    <div class="progress-text" id="ramProgressText">0%</div>
                    <div class="ram-chart-container">
                        <canvas id="ramChart"></canvas>
                    </div>
                    <div class="ram-breakdown">
                        <div class="ram-item">
                            <div class="ram-label">مورد استفاده</div>
                            <div class="ram-value" id="ramUsed">4.2 GB</div>
                        </div>
                        <div class="ram-item">
                            <div class="ram-label">در دسترس</div>
                            <div class="ram-value" id="ramFree">8.8 GB</div>
                        </div>
                        <div class="ram-item">
                            <div class="ram-label">کل</div>
                            <div class="ram-value" id="ramTotal">16 GB</div>
                        </div>
                        <div class="ram-item">
                            <div class="ram-label">کش/بافر</div>
                            <div class="ram-value" id="ramCached">2.1 GB</div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="footer-actions">
                            <span>نوع: <strong>DDR4</strong></span>
                            <span>سرعت: <strong>3200 MHz</strong></span>
                        </div>
                    </div>
                </div>

                <!-- Disk Card -->
                <div class="glass-card status-card">
                    <i class="fas fa-hdd status-icon" aria-hidden="true"></i>
                    <div class="status-value" id="diskUsage">0%</div>
                    <div class="status-label">مصرف دیسک</div>
                    <div class="progress">
                        <div class="progress-fill" id="diskProgressFill"></div>
                    </div>
                    <div class="progress-text" id="diskProgressText">0%</div>
                    <div class="disk-chart-container">
                        <canvas id="diskChart"></canvas>
                    </div>
                    <div class="disk-partitions">
                        <div class="partition-item">
                            <div class="partition-header">
                                <span class="partition-drive">C:</span>
                                <span class="partition-type">NTFS</span>
                            </div>
                            <div class="partition-progress">
                                <div class="progress">
                                    <div class="progress-fill" style="width: 65%;"></div>
                                </div>
                                <div class="progress-text">65% (325GB / 500GB)</div>
                            </div>
                        </div>
                        <div class="partition-item">
                            <div class="partition-header">
                                <span class="partition-drive">D:</span>
                                <span class="partition-type">NTFS</span>
                            </div>
                            <div class="partition-progress">
                                <div class="progress">
                                    <div class="progress-fill" style="width: 30%;"></div>
                                </div>
                                <div class="progress-text">30% (150GB / 500GB)</div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="footer-actions">
                            <span>نوع: <strong>SSD</strong></span>
                            <span>سرعت خواندن: <strong>550 MB/s</strong></span>
                        </div>
                    </div>
                </div>

                <!-- Network Card -->
                <div class="glass-card status-card">
                    <i class="fas fa-network-wired status-icon" aria-hidden="true"></i>
                    <div class="status-value" id="networkStatus">فعال</div>
                    <div class="status-label">وضعیت شبکه</div>
                    <div class="network-chart-container">
                        <canvas id="networkChart"></canvas>
                    </div>
                    <div class="network-stats">
                        <div class="stat-grid">
                            <div class="stat-item">
                                <i class="fas fa-arrow-down" aria-hidden="true"></i>
                                <div class="stat-content">
                                    <span class="label">دانلود</span>
                                    <span class="value" id="downloadSpeed">0 Mbps</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-arrow-up" aria-hidden="true"></i>
                                <div class="stat-content">
                                    <span class="label">آپلود</span>
                                    <span class="value" id="uploadSpeed">0 Mbps</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-signal" aria-hidden="true"></i>
                                <div class="stat-content">
                                    <span class="label">پینگ</span>
                                    <span class="value" id="ping">0 ms</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-wifi" aria-hidden="true"></i>
                                <div class="stat-content">
                                    <span class="label">نوع</span>
                                    <span class="value" id="networkType">Wi-Fi</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="footer-actions">
                            <span>IPv4: <strong id="ipv4Address">192.168.1.100</strong></span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Actions -->
            <section class="quick-actions-section">
                <div class="section-header">
                    <h2><i class="fas fa-bolt" aria-hidden="true"></i> اقدامات سریع</h2>
                    <p>دسترسی سریع به ابزارهای متداول سیستم</p>
                </div>
                <div class="quick-actions-grid">
                    <button class="action-btn" data-action="disk-cleanup">
                        <div class="action-content">
                            <i class="fas fa-broom action-icon" aria-hidden="true"></i>
                            <h4>پاک‌سازی دیسک</h4>
                            <p>حذف فایل‌های موقت و زائد</p>
                        </div>
                    </button>
                    <button class="action-btn" data-action="defrag">
                        <div class="action-content">
                            <i class="fas fa-exchange-alt action-icon" aria-hidden="true"></i>
                            <h4>دیفرگمنت</h4>
                            <p>بهبود عملکرد دیسک سفت</p>
                        </div>
                    </button>
                    <button class="action-btn" data-action="update">
                        <div class="action-content">
                            <i class="fas fa-sync-alt action-icon" aria-hidden="true"></i>
                            <h4>بروزرسانی</h4>
                            <p>بررسی و نصب به‌روزرسانی‌ها</p>
                        </div>
                    </button>
                    <button class="action-btn" data-action="backup">
                        <div class="action-content">
                            <i class="fas fa-hdd action-icon" aria-hidden="true"></i>
                            <h4>پشتیبان‌گیری</h4>
                            <p>ایجاد نسخه پشتیبان سیستم</p>
                        </div>
                    </button>
                    <button class="action-btn" data-action="optimize">
                        <div class="action-content">
                            <i class="fas fa-tachometer-alt action-icon" aria-hidden="true"></i>
                            <h4>بهینه‌سازی</h4>
                            <p>بهبود عملکرد کلی سیستم</p>
                        </div>
                    </button>
                    <button class="action-btn" data-action="security-scan">
                        <div class="action-content">
                            <i class="fas fa-shield-alt action-icon" aria-hidden="true"></i>
                            <h4>اسکن امنیتی</h4>
                            <p>بررسی ویروس و بدافزار</p>
                        </div>
                    </button>
                </div>
            </section>

            <!-- Recent Activity -->
            <section class="activity-section">
                <div class="activity-column">
                    <div class="recent-commands glass-card">
                        <div class="section-header">
                            <h2><i class="fas fa-history" aria-hidden="true"></i> دستورات اخیر</h2>
                        </div>
                        <div class="commands-list" id="commandsList">
                            <div class="command-item">
                                <div class="command-info">
                                    <div class="command-text">systeminfo | findstr /C:"OS Name"</div>
                                    <div class="command-time">۱۲:۳۴:۵۶</div>
                                </div>
                                <div class="command-status success">موفق</div>
                            </div>
                            <div class="command-item">
                                <div class="command-info">
                                    <div class="command-text">tasklist /FI "MEMUSAGE gt 100000"</div>
                                    <div class="command-time">۱۲:۳۰:۱۵</div>
                                </div>
                                <div class="command-status success">موفق</div>
                            </div>
                            <div class="command-item">
                                <div class="command-info">
                                    <div class="command-text">ipconfig /all</div>
                                    <div class="command-time">۱۲:۲۵:۴۲</div>
                                </div>
                                <div class="command-status success">موفق</div>
                            </div>
                            <div class="command-item">
                                <div class="command-info">
                                    <div class="command-text">chkdsk C: /f</div>
                                    <div class="command-time">۱۲:۲۰:۲۱</div>
                                </div>
                                <div class="command-status error">خطا</div>
                            </div>
                            <!-- More items will be added by JS -->
                        </div>
                    </div>
                </div>
                <div class="activity-column">
                    <div class="system-alerts glass-card">
                        <div class="section-header">
                            <h2><i class="fas fa-exclamation-circle" aria-hidden="true"></i> هشدارهای سیستم</h2>
                        </div>
                        <div class="alerts-container" id="alertsContainer">
                            <div class="alert-item warning">
                                <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                                <div class="alert-content">
                                    <span class="alert-title">به‌روزرسانی در دسترس</span>
                                    <p class="alert-message">به‌روزرسانی امنیتی برای ویندوز موجود است. لطفاً در اسرع وقت نصب کنید.</p>
                                </div>
                            </div>
                            <div class="alert-item info">
                                <i class="fas fa-info-circle" aria-hidden="true"></i>
                                <div class="alert-content">
                                    <span class="alert-title">پشتیبان‌گیری توصیه می‌شود</span>
                                    <p class="alert-message">آخرین نسخه پشتیبان سیستم شما بیش از یک هفته است. در نظر داشته باشید یک نسخه جدید تهیه کنید.</p>
                                </div>
                            </div>
                            <div class="alert-item warning">
                                <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                                <div class="alert-content">
                                    <span class="alert-title">دیسک C: پر است</span>
                                    <p class="alert-message">فضای دیسک C: به 90% رسیده است. پیشنهاد می‌شود فایل‌های زائد را پاک کنید.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="performance-tips glass-card">
                        <div class="section-header">
                            <h2><i class="fas fa-lightbulb" aria-hidden="true"></i> نکات عملکردی</h2>
                        </div>
                        <div class="tips-container">
                            <div class="tip-item">
                                <i class="fas fa-tachometer-alt" aria-hidden="true"></i>
                                <div class="tip-content">
                                    <h4>غیرفعال کردن خدمات غیرضروری</h4>
                                    <p>غیرفعال کردن خدماتی که از آن‌ها استفاده نمی‌کنید می‌تواند عملکرد سیستم را افزایش دهد.</p>
                                </div>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-hdd" aria-hidden="true"></i>
                                <div class="tip-content">
                                    <h4>دیفرگمنت کردن هفتگی</h4>
                                    <p>دیفرگمنت کردن هفتگی برای بهبود عملکرد HDD</p>
                                </div>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-broom" aria-hidden="true"></i>
                                <div class="tip-content">
                                    <h4>پاک‌سازی منظم</h4>
                                    <p>فایل‌های موقت و کش مرورگر را به‌طور منظم پاک کنید</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- AI Center Page -->
        <div class="page" id="ai-center-page" aria-labelledby="aiCenterTitle">
            <div class="page-header">
                <h1 id="aiCenterTitle"><i class="fas fa-robot" aria-hidden="true"></i> مرکز هوش مصنوعی</h1>
                <p>دستیار هوشمند Arka برای مدیریت و بهینه‌سازی سیستم</p>
            </div>
            <div class="ai-container">
                <div class="ai-sidebar">
                    <h3><i class="fas fa-tools" aria-hidden="true"></i> ابزارهای AI</h3>
                    <div class="ai-tools-container">
                        <div class="tools-grid">
                            <div class="tool-card" data-tool="cmd-helper">
                                <i class="fas fa-terminal tool-icon" aria-hidden="true"></i>
                                <h4>راهنمای CMD</h4>
                                <p>پیشنهاد دستورات CMD بر اساس توضیح شما</p>
                            </div>
                            <div class="tool-card" data-tool="ps-helper">
                                <i class="fas fa-cogs tool-icon" aria-hidden="true"></i>
                                <h4>راهنمای PowerShell</h4>
                                <p>تولید اسکریپت‌های PowerShell</p>
                            </div>
                            <div class="tool-card" data-tool="run-helper">
                                <i class="fas fa-play-circle tool-icon" aria-hidden="true"></i>
                                <h4>راهنمای Run</h4>
                                <p>پیدا کردن مسیرهای متداول سیستم</p>
                            </div>
                            <div class="tool-card" data-tool="system-analyzer">
                                <i class="fas fa-search tool-icon" aria-hidden="true"></i>
                                <h4>تحلیلگر سیستم</h4>
                                <p>بررسی مشکلات و پیشنهادات بهینه‌سازی</p>
                            </div>
                            <div class="tool-card" data-tool="security-advisor">
                                <i class="fas fa-shield-alt tool-icon" aria-hidden="true"></i>
                                <h4>مشاور امنیتی</h4>
                                <p>توصیه‌های امنیتی سفارشی</p>
                            </div>
                            <div class="tool-card" data-tool="performance-tuner">
                                <i class="fas fa-tachometer-alt tool-icon" aria-hidden="true"></i>
                                <h4>تنظیم‌کننده عملکرد</h4>
                                <p>بهینه‌سازی تنظیمات برای عملکرد بهتر</p>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: var(--space-xl);"><i class="fas fa-history" aria-hidden="true"></i> تاریخچه</h3>
                    <div class="history-container">
                        <div class="history-item active">
                            <div class="history-preview">چگونه می‌توانم فضای دیسک را آزاد کنم؟</div>
                            <div class="history-time">۱۰:۳۰</div>
                        </div>
                        <div class="history-item">
                            <div class="history-preview">چطور سرعت ویندوز را افزایش دهم؟</div>
                            <div class="history-time">۰۹:۴۵</div>
                        </div>
                        <div class="history-item">
                            <div class="history-preview">پیدا کردن فرآیندهای پر مصرف CPU</div>
                            <div class="history-time">۰۸:۱۵</div>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-history" aria-hidden="true"></i>
                            <p>تاریخچه خالی است</p>
                        </div>
                    </div>

                    <h3 style="margin-top: var(--space-xl);"><i class="fas fa-thumbtack" aria-hidden="true"></i> دستورات نشان‌شده</h3>
                    <div class="pinned-container">
                        <div class="pinned-item">
                            <i class="fas fa-thumbtack" aria-hidden="true"></i>
                            <div class="history-preview">sfc /scannow</div>
                        </div>
                        <div class="pinned-item">
                            <i class="fas fa-thumbtack" aria-hidden="true"></i>
                            <div class="history-preview">Get-Process | Sort-Object CPU -Descending</div>
                        </div>
                        <div class="empty-state">
                            <i class="fas fa-thumbtack" aria-hidden="true"></i>
                            <p>دستوری نشان نشده است</p>
                        </div>
                    </div>
                </div>

                <div class="ai-main-content">
                    <div class="chat-container">
                        <div class="chat-header">
                            <i class="fas fa-robot" aria-hidden="true"></i>
                            <h3>دستیار Arka AI</h3>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai">
                                <div class="message-content">
                                    <p>سلام! من دستیار هوش مصنوعی Arka هستم. چطور می‌تونم کمکتون کنم؟ می‌تونی در مورد مشکل سیستمت، دستور خاصی که نیاز داری یا نحوه اجرای کاری بپرسی.</p>
                                </div>
                                <div class="message-time">همین الان</div>
                            </div>
                            <!-- Messages will be added here by JS -->
                        </div>
                        <div class="chat-input-container">
                            <textarea id="aiChatInput" placeholder="پیام خود را بنویسید... مثلاً: 'سیستم داغ می‌کند یا 'چطور فضای دیسک را آزاد کنم؟'"></textarea>
                            <div class="chat-send-actions">
                                <button class="btn btn-primary" id="aiChatSendBtn">
                                    <i class="fas fa-paper-plane" aria-hidden="true"></i> ارسال
                                </button>
                                <button class="btn btn-secondary" id="aiChatVoiceBtn" title="ورودی صوتی">
                                    <i class="fas fa-microphone" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="ai-quick-input">
                        <input type="text" class="form-control" id="aiQuickInput" placeholder="یا یکی از پیشنهادهای زیر را امتحان کنید...">
                        <button class="btn btn-primary" id="aiQuickSubmitBtn">پرسش</button>
                    </div>
                    <div class="ai-suggestions">
                        <button class="suggestion-btn" data-suggestion="optimize"><i class="fas fa-tachometer-alt"></i> بهینه‌سازی سیستم</button>
                        <button class="suggestion-btn" data-suggestion="security"><i class="fas fa-shield-alt"></i> بررسی امنیت</button>
                        <button class="suggestion-btn" data-suggestion="gaming"><i class="fas fa-gamepad"></i> بهینه‌سازی برای گیمینگ</button>
                        <button class="suggestion-btn" data-suggestion="script"><i class="fas fa-code"></i> ساخت اسکریپت</button>
                        <button class="suggestion-btn" data-suggestion="report"><i class="fas fa-chart-bar"></i> گزارش عملکرد</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CMD Section Page -->
        <div class="page" id="cmd-section-page" aria-labelledby="cmdSectionTitle">
            <div class="page-header">
                <h1 id="cmdSectionTitle"><i class="fas fa-terminal" aria-hidden="true"></i> دستورات CMD</h1>
                <p>لیست کامل دستورات خط فرمان ویندوز (Command Prompt)</p>
            </div>
            <div class="command-section">
                <div class="command-list-container">
                    <div class="command-list-header">
                        <h3>دستورات متداول</h3>
                        <div class="search-box">
                            <input type="text" class="form-control" id="cmdSearch" placeholder="جستجو در دستورات...">
                        </div>
                    </div>
                    <div class="command-list" id="cmdCommandList">
                        <!-- Commands will be populated by JS -->
                        <div class="command-list-item active">
                            <div>
                                <div class="command-name">dir</div>
                                <div class="command-desc">نمایش لیست فایل‌ها و پوشه‌های موجود در یک دایرکتوری</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">cd</div>
                                <div class="command-desc">تغییر دایرکتوری فعلی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ipconfig</div>
                                <div class="command-desc">نمایش اطلاعات پیکربندی IP</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ping</div>
                                <div class="command-desc">بررسی قابلیت دسترسی به یک میزبان شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">tasklist</div>
                                <div class="command-desc">نمایش لیست فرآیندهای در حال اجرا</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">taskkill</div>
                                <div class="command-desc">پایان دادن به یک فرآیند</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">systeminfo</div>
                                <div class="command-desc">نمایش جزئیات سخت‌افزار و نرم‌افزار سیستم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">sfc</div>
                                <div class="command-desc">بررسی و تعمیر فایل‌های سیستمی ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">chkdsk</div>
                                <div class="command-desc">بررسی و تعمیر خطاها در دیسک</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">netstat</div>
                                <div class="command-desc">نمایش وضعیت اتصالات شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">sc</div>
                                <div class="command-desc">مدیریت سرویس‌های ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">wmic</div>
                                <div class="command-desc">رابط خط فرمان برای WMI</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">diskpart</div>
                                <div class="command-desc">مدیریت پارتیشن‌های دیسک</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">cipher</div>
                                <div class="command-desc">رمزگذاری یا رمزگشایی دیسک یا فایل‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">assoc</div>
                                <div class="command-desc">مشاهده یا تنظیم نوع فایل مرتبط با پسوندها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ftype</div>
                                <div class="command-desc">مشاهده یا تنظیم برنامه‌ای که برای باز کردن نوع فایل استفاده می‌شود</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">driverquery</div>
                                <div class="command-desc">نمایش لیست درایورهای نصب شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">netsh</div>
                                <div class="command-desc">پیکربندی و عیب‌یابی شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">gpupdate</div>
                                <div class="command-desc">به‌روزرسانی سیاست‌های گروهی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">reg</div>
                                <div class="command-desc">کار با رجیستری ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">takeown</div>
                                <div class="command-desc">دریافت دسترسی مالکیت فایل یا پوشه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">icacls</div>
                                <div class="command-desc">مشاهده یا تغییر دسترسی‌های فایل/پوشه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">robocopy</div>
                                <div class="command-desc">کپی پیشرفته فایل‌ها و پوشه‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">xcopy</div>
                                <div class="command-desc">کپی کردن فایل‌ها و پوشه‌ها (منسوخ)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">format</div>
                                <div class="command-desc">فرمت کردن یک درایو</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">copy</div>
                                <div class="command-desc">کپی کردن فایل‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">move</div>
                                <div class="command-desc">انتقال فایل‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">del</div>
                                <div class="command-desc">حذف فایل‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">md</div>
                                <div class="command-desc">ایجاد یک پوشه جدید</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">rd</div>
                                <div class="command-desc">حذف یک پوشه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">type</div>
                                <div class="command-desc">نمایش محتوای یک فایل متنی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">find</div>
                                <div class="command-desc">پیدا کردن متن در یک یا چند فایل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">findstr</div>
                                <div class="command-desc">پیدا کردن رشته‌های متنی در فایل‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">echo</div>
                                <div class="command-desc">نمایش پیام یا فعال/غیرفعال کردن پردازش دستورات</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">cls</div>
                                <div class="command-desc">پاک کردن صفحه CMD</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ver</div>
                                <div class="command-desc">نمایش شماره نسخه ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">date</div>
                                <div class="command-desc">نمایش یا تنظیم تاریخ</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">time</div>
                                <div class="command-desc">نمایش یا تنظیم زمان</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">hostname</div>
                                <div class="command-desc">نمایش نام میزبان کامپیوتر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">whoami</div>
                                <div class="command-desc">نمایش نام کاربر فعلی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">set</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="command-details-container">
                    <div class="command-details-header">
                        <h3 id="commandDetailsTitle">dir</h3>
                        <div class="command-actions">
                            <button class="btn btn-outline btn-icon" id="pinCommandBtn" title="نشان کردن">
                                <i class="fas fa-thumbtack"></i>
                            </button>
                        </div>
                    </div>
                    <div class="command-details-content" id="commandDetailsContent">
                        <h4 class="command-details-title">dir</h4>
                        <p class="command-details-description">
                            دستور <code>dir</code> برای نمایش لیست فایل‌ها و پوشه‌های موجود در یک دایرکتوری خاص استفاده می‌شود. این دستور می‌تواند اطلاعاتی مانند نام، اندازه، تاریخ و زمان ایجاد یا آخرین تغییرات را نشان دهد.
                        </p>
                        <div class="command-details-syntax">
                            dir [Drive:][Path][Filename] [/A[[:]attributes]] [/B] [/C] [/D] [/L] [/N] [/O[[:]sortorder]] [/P] [/Q] [/R] [/S] [/T[[:]timefield]] [/W] [/X] [/4]
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها:</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">[Drive:][Path][Filename]</div>
                                <div class="parameter-desc">مکان دایرکتوری یا فایل مورد نظر برای لیست شدن.</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/A[[:]attributes]</div>
                                <div class="parameter-desc">مشخص کردن ویژگی‌های فایل‌ها یا پوشه‌هایی که باید نمایش داده شوند (مثلاً فقط فایل‌های مخفی).</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/B</div>
                                <div class="parameter-desc">حالت خام، فقط نام فایل‌ها و پوشه‌ها را نشان می‌دهد.</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/S</div>
                                <div class="parameter-desc">جستجو در زیرشاخه‌ها.</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/P</div>
                                <div class="parameter-desc">متوقف کردن خروجی پس از هر صفحه.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. نمایش همه فایل‌ها در دایرکتوری فعلی:</strong></p>
                                <div class="example-code">dir</div>
                            </div>
                            <div class="example-item">
                                <p><strong>2. نمایش فقط فایل‌های متنی در درایو C با جزئیات:</strong></p>
                                <div class="example-code">dir C:\*.txt</div>
                            </div>
                            <div class="example-item">
                                <p><strong>3. نمایش لیست فایل‌ها در حالت خام:</strong></p>
                                <div class="example-code">dir /B</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این دستور یکی از پرکاربردترین دستورات CMD است. ترکیب‌های مختلف پارامترها می‌تواند اطلاعات بسیار دقیقی را ارائه دهد.</p>
                        </div>
                    </div>
                    <div class="command-details-actions">
                        <button class="btn btn-outline" id="copyCommandBtn">
                            <i class="fas fa-copy"></i> کپی دستور
                        </button>
                        <button class="btn btn-primary" id="executeCommandBtn">
                            <i class="fas fa-play"></i> اجرای دستور
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PowerShell Section Page -->
        <div class="page" id="ps-section-page" aria-labelledby="psSectionTitle">
            <div class="page-header">
                <h1 id="psSectionTitle"><i class="fas fa-cogs" aria-hidden="true"></i> دستورات PowerShell</h1>
                <p>لیست کامل دستورات پاورشل ویندوز (PowerShell)</p>
            </div>
            <div class="command-section">
                <div class="command-list-container">
                    <div class="command-list-header">
                        <h3>دستورات متداول</h3>
                        <div class="search-box">
                            <input type="text" class="form-control" id="psSearch" placeholder="جستجو در دستورات...">
                        </div>
                    </div>
                    <div class="command-list" id="psCommandList">
                        <!-- Commands will be populated by JS -->
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Process</div>
                                <div class="command-desc">دریافت اطلاعات فرآیندهای در حال اجرا</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Service</div>
                                <div class="command-desc">دریافت اطلاعات سرویس‌های ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-NetIPConfiguration</div>
                                <div class="command-desc">دریافت اطلاعات پیکربندی IP</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Test-NetConnection</div>
                                <div class="command-desc">بررسی اتصال شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-ComputerInfo</div>
                                <div class="command-desc">دریافت جزئیات سخت‌افزار و نرم‌افزار سیستم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-EventLog</div>
                                <div class="command-desc">دریافت ورودی‌های گزارش رویداد</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-WmiObject</div>
                                <div class="command-desc">دریافت اشیاء WMI</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-ItemProperty</div>
                                <div class="command-desc">دریافت خصوصیات یک آیتم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Set-ItemProperty</div>
                                <div class="command-desc">تنظیم خصوصیات یک آیتم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Remove-Item</div>
                                <div class="command-desc">حذف یک آیتم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">New-Item</div>
                                <div class="command-desc">ایجاد یک آیتم جدید</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Content</div>
                                <div class="command-desc">دریافت محتوای یک فایل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Set-Content</div>
                                <div class="command-desc">تنظیم محتوای یک فایل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Add-Content</div>
                                <div class="command-desc">افزودن محتوا به یک فایل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Command</div>
                                <div class="command-desc">دریافت اطلاعات درباره یک دستور</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Help</div>
                                <div class="command-desc">دریافت راهنما برای یک دستور</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Module</div>
                                <div class="command-desc">دریافت ماژول‌های نصب شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Import-Module</div>
                                <div class="command-desc">وارد کردن یک ماژول</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Export-Csv</div>
                                <div class="command-desc">ذخیره اشیاء در یک فایل CSV</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ConvertTo-Json</div>
                                <div class="command-desc">تبدیل اشیاء به فرمت JSON</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Invoke-WebRequest</div>
                                <div class="command-desc">درخواست یک وب</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Start-Process</div>
                                <div class="command-desc">شروع یک فرآیند</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Stop-Process</div>
                                <div class="command-desc">متوقف کردن یک فرآیند</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Restart-Computer</div>
                                <div class="command-desc">راه‌اندازی مجدد کامپیوتر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Stop-Computer</div>
                                <div class="command-desc">خاموش کردن کامپیوتر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-NetAdapter</div>
                                <div class="command-desc">دریافت اطلاعات اداپتورهای شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Disk</div>
                                <div class="command-desc">دریافت اطلاعات دیسک‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-Volume</div>
                                <div class="command-desc">دریافت اطلاعات ولوم‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-NetRoute</div>
                                <div class="command-desc">دریافت جدول مسیریابی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Set-NetIPInterface</div>
                                <div class="command-desc">تنظیم پیکربندی اینترفیس IP</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-NetFirewallRule</div>
                                <div class="command-desc">دریافت قوانین فایروال</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Enable-NetFirewallRule</div>
                                <div class="command-desc">فعال کردن قانون فایروال</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Disable-NetFirewallRule</div>
                                <div class="command-desc">غیرفعال کردن قانون فایروال</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-LocalUser</div>
                                <div class="command-desc">دریافت کاربران محلی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-LocalGroup</div>
                                <div class="command-desc">دریافت گروه‌های محلی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-ScheduledTask</div>
                                <div class="command-desc">دریافت وظایف زمان‌بندی شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Start-ScheduledTask</div>
                                <div class="command-desc">شروع یک وظیفه زمان‌بندی شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Stop-ScheduledTask</div>
                                <div class="command-desc">متوقف کردن یک وظیفه زمان‌بندی شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-HotFix</div>
                                <div class="command-desc">دریافت لیست به‌روزرسانی‌های نصب شده</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-WindowsUpdateLog</div>
                                <div class="command-desc">دریافت گزارش به‌روزرسانی‌های ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-AppxPackage</div>
                                <div class="command-desc">دریافت بسته‌های نصب شده UWP</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Get-ExecutionPolicy</div>
                                <div class="command-desc">دریافت سیاست اجرای اسکریپت</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">Set-ExecutionPolicy</div>
                                <div class="command-desc">تنظیم سیاست اجرای اسکریپت</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="command-details-container">
                    <div class="command-details-header">
                        <h3 id="psCommandDetailsTitle">Get-Process</h3>
                        <div class="command-actions">
                            <button class="btn btn-outline btn-icon" id="pinPsCommandBtn" title="نشان کردن">
                                <i class="fas fa-thumbtack"></i>
                            </button>
                        </div>
                    </div>
                    <div class="command-details-content" id="psCommandDetailsContent">
                        <h4 class="command-details-title">Get-Process</h4>
                        <p class="command-details-description">
                            دستور <code>Get-Process</code> برای دریافت اطلاعات درباره فرآیندهای در حال اجرا در سیستم استفاده می‌شود. می‌توانید اطلاعاتی مانند نام فرآیند، شناسه (PID)، میزان مصرف حافظه و CPU را ببینید.
                        </p>
                        <div class="command-details-syntax">
                            Get-Process [[-Name] <string[]>] [-FileVersionInfo] [<CommonParameters>]
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها:</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">-Name</div>
                                <div class="parameter-desc">نام فرآیند یا فرآیندهای مورد نظر (بدون پسوند).</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">-FileVersionInfo</div>
                                <div class="parameter-desc">دریافت اطلاعات نسخه فایل برای فرآیند.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. نمایش همه فرآیندها:</strong></p>
                                <div class="example-code">Get-Process</div>
                            </div>
                            <div class="example-item">
                                <p><strong>2. نمایش فرآیند chrome:</strong></p>
                                <div class="example-code">Get-Process chrome</div>
                            </div>
                            <div class="example-item">
                                <p><strong>3. نمایش فرآیندهایی که بیش از 100MB حافظه مصرف می‌کنند:</strong></p>
                                <div class="example-code">Get-Process | Where-Object {$_.WorkingSet64 -gt 100MB}</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این دستور بسیار قدرتمند است و می‌تواند به همراه فیلترها و دیگر دستورات برای تحلیل عمیق‌تر سیستم استفاده شود.</p>
                        </div>
                    </div>
                    <div class="command-details-actions">
                        <button class="btn btn-outline" id="copyPsCommandBtn">
                            <i class="fas fa-copy"></i> کپی دستور
                        </button>
                        <button class="btn btn-primary" id="executePsCommandBtn">
                            <i class="fas fa-play"></i> اجرای دستور
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Run Section Page -->
        <div class="page" id="run-section-page" aria-labelledby="runSectionTitle">
            <div class="page-header">
                <h1 id="runSectionTitle"><i class="fas fa-play-circle" aria-hidden="true"></i> دستورات Run</h1>
                <p>لیست کامل دستورات مفید قابل اجرا از پنجره Run</p>
            </div>
            <div class="command-section">
                <div class="command-list-container">
                    <div class="command-list-header">
                        <h3>دستورات متداول</h3>
                        <div class="search-box">
                            <input type="text" class="form-control" id="runSearch" placeholder="جستجو در دستورات...">
                        </div>
                    </div>
                    <div class="command-list" id="runCommandList">
                        <!-- Commands will be populated by JS -->
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">cmd</div>
                                <div class="command-desc">اجرای خط فرمان (Command Prompt)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">powershell</div>
                                <div class="command-desc">اجرای PowerShell</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">msconfig</div>
                                <div class="command-desc">پیکربندی سیستم ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">regedit</div>
                                <div class="command-desc">ویرایشگر رجیستری</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">taskmgr</div>
                                <div class="command-desc">مدیر وظیفه (Task Manager)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">devmgmt.msc</div>
                                <div class="command-desc">مدیریت دستگاه‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">services.msc</div>
                                <div class="command-desc">مدیریت سرویس‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">dxdiag</div>
                                <div class="command-desc">اطلاعات سخت‌افزار دیسک ت Direct X</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">gpedit.msc</div>
                                <div class="command-desc">ویرایشگر سیاست گروهی (Professional/Enterprise)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">perfmon</div>
                                <div class="command-desc">مانیتور عملکرد</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">eventvwr.msc</div>
                                <div class="command-desc">نمایشگر رویدادها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">diskmgmt.msc</div>
                                <div class="command-desc">مدیریت دیسک</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">compmgmt.msc</div>
                                <div class="command-desc">مدیریت کامپیوتر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">cleanmgr</div>
                                <div class="command-desc">پاک‌سازی دیسک</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">defrag C:</div>
                                <div class="command-desc">دیفرگمنت کردن درایو C</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">notepad</div>
                                <div class="command-desc">اجرای نوت‌پد</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">calc</div>
                                <div class="command-desc">اجرای ماشین حساب</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">mspaint</div>
                                <div class="command-desc">اجرای نقاشی مایکروسافت</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">write</div>
                                <div class="command-desc">اجرای ویرایشگر واژه (Wordpad)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">control</div>
                                <div class="command-desc">پنل کنترل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">control printers</div>
                                <div class="command-desc">مدیریت چاپگرها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">inetcpl.cpl</div>
                                <div class="command-desc">تنظیمات اینترنت</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ncpa.cpl</div>
                                <div class="command-desc">کانکشن‌های شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">sysdm.cpl</div>
                                <div class="command-desc">خواص سیستم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">appwiz.cpl</div>
                                <div class="command-desc">نصب/حذف برنامه‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">firewall.cpl</div>
                                <div class="command-desc">تنظیمات فایروال</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">timedate.cpl</div>
                                <div class="command-desc">تنظیمات تاریخ و زمان</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">main.cpl</div>
                                <div class="command-desc">تنظیمات ماوس</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">mmsys.cpl</div>
                                <div class="command-desc">تنظیمات صدا</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">desk.cpl</div>
                                <div class="command-desc">تنظیمات نمایشگر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">intl.cpl</div>
                                <div class="command-desc">تنظیمات منطقه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">ncpa.cpl</div>
                                <div class="command-desc">تنظیمات شبکه</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">usrmgr.cpl</div>
                                <div class="command-desc">مدیریت کاربران (Home)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">secpol.msc</div>
                                <div class="command-desc">تنظیمات امنیت محلی (Professional/Enterprise)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">certmgr.msc</div>
                                <div class="command-desc">مدیریت گواهینامه‌ها</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">lusrmgr.msc</div>
                                <div class="command-desc">مدیریت کاربران و گروه‌های محلی (Professional/Enterprise)</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">mstsc</div>
                                <div class="command-desc">اتصال دسکتاپ از راه دور</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">mobsync</div>
                                <div class="command-desc">همگام‌سازی</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">explorer</div>
                                <div class="command-desc">اجرای مرورگر فایل</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">iexplore</div>
                                <div class="command-desc">اجرای اینترنت اکسپلورر</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">winver</div>
                                <div class="command-desc">نمایش اطلاعات نسخه ویندوز</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">shutdown /s /t 0</div>
                                <div class="command-desc">خاموش کردن فوری سیستم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">shutdown /r /t 0</div>
                                <div class="command-desc">راه‌اندازی مجدد فوری سیستم</div>
                            </div>
                        </div>
                        <div class="command-list-item">
                            <div>
                                <div class="command-name">slmgr.vbs /dli</div>
                                <div class="command-desc">بررسی وضعیت لایسنس ویندوز</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="command-details-container">
                    <div class="command-details-header">
                        <h3 id="runCommandDetailsTitle">cmd</h3>
                        <div class="command-actions">
                            <button class="btn btn-outline btn-icon" id="pinRunCommandBtn" title="نشان کردن">
                                <i class="fas fa-thumbtack"></i>
                            </button>
                        </div>
                    </div>
                    <div class="command-details-content" id="runCommandDetailsContent">
                        <h4 class="command-details-title">cmd</h4>
                        <p class="command-details-description">
                            دستور <code>cmd</code> برای اجرای خط فرمان ویندوز (Command Prompt) از پنجره Run استفاده می‌شود. این یک محیط متنی برای اجرای دستورات و اسکریپت‌های ویندوز است.
                        </p>
                        <div class="command-details-syntax">
                            cmd [/A | /U] [/Q] [/D] [/E:ON | /E:OFF] [/F:ON | /F:OFF] [/V:ON | /V:OFF] [[/S] [/C | /K] string]
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها (پیشرفته):</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">/C</div>
                                <div class="parameter-desc">اجرای دستور مشخص شده و سپس خروج.</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/K</div>
                                <div class="parameter-desc">اجرای دستور مشخص شده و ماندن در CMD.</div>
                            </div>
                            <div class="parameter-item">
                                <div class="parameter-name">/S</div>
                                <div class="parameter-desc">تغییر نحوه پردازش /C یا /K.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. باز کردن CMD معمولی:</strong></p>
                                <div class="example-code">cmd</div>
                            </div>
                            <div class="example-item">
                                <p><strong>2. اجرای یک دستور و خروج:</strong></p>
                                <div class="example-code">cmd /C dir C:\</div>
                            </div>
                            <div class="example-item">
                                <p><strong>3. اجرای یک دستور و ماندن در CMD:</strong></p>
                                <div class="example-code">cmd /K ipconfig</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این دستور یکی از پایه‌ای‌ترین راه‌های دسترسی به محیط خط فرمان است. برای اجرای بیشتر دستورات CMD مناسب است.</p>
                        </div>
                    </div>
                    <div class="command-details-actions">
                        <button class="btn btn-outline" id="copyRunCommandBtn">
                            <i class="fas fa-copy"></i> کپی دستور
                        </button>
                        <button class="btn btn-primary" id="executeRunCommandBtn">
                            <i class="fas fa-play"></i> اجرای دستور
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content container">
            <div class="footer-section">
                <h4>ARKA</h4>
                <p>مرجع کامل دستورات ویندوز با قابلیت هوش مصنوعی</p>
                <div class="social-links">
                    <a href="#" aria-label="GitHub"><i class="fab fa-github"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h4>لینک‌های مفید</h4>
                <ul>
                    <li><a href="#"><i class="fas fa-file-alt"></i> مستندات</a></li>
                    <li><a href="#"><i class="fas fa-question-circle"></i> راهنما</a></li>
                    <li><a href="#"><i class="fas fa-bug"></i> گزارش اشکال</a></li>
                    <li><a href="#"><i class="fas fa-comments"></i> ارتباط با ما</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>تماس با ما</h4>
                <ul>
                    <li><i class="fas fa-envelope"></i> info@arka.local</li>
                    <li><i class="fas fa-phone"></i> +98 21 1234 5678</li>
                    <li><i class="fas fa-map-marker-alt"></i> تهران، ایران</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <p>&copy; 1403 - 1404 تیم Arka. تمامی حقوق محفوظ است.</p>
                <div class="footer-links">
                    <a href="#">حریم خصوصی</a>
                    <a href="#">شرایط استفاده</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modals -->
    <div class="modal-overlay" id="commandDetailsModal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> جزئیات دستور</h3>
                <button class="modal-close" id="closeCommandDetailsModal">&times;</button>
            </div>
            <div class="modal-body" id="commandDetailsModalBody">
                <!-- Content will be populated by JS -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="copyModalCommandBtn">کپی</button>
                <button class="btn btn-primary" id="executeModalCommandBtn">اجرا</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="aiSuggestionModal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-robot"></i> پیشنهاد AI</h3>
                <button class="modal-close" id="closeAiSuggestionModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="ai-suggestions">
                    <button class="suggestion-btn" data-suggestion="optimize"><i class="fas fa-tachometer-alt"></i> بهینه‌سازی سیستم</button>
                    <button class="suggestion-btn" data-suggestion="security"><i class="fas fa-shield-alt"></i> بررسی امنیت</button>
                    <button class="suggestion-btn" data-suggestion="gaming"><i class="fas fa-gamepad"></i> بهینه‌سازی برای گیمینگ</button>
                    <button class="suggestion-btn" data-suggestion="script"><i class="fas fa-code"></i> ساخت اسکریپت</button>
                    <button class="suggestion-btn" data-suggestion="report"><i class="fas fa-chart-bar"></i> گزارش عملکرد</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelAiSuggestionBtn">لغو</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="executionModal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-play-circle"></i> اجرای دستور</h3>
                <button class="modal-close" id="closeExecutionModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>آیا از اجرای دستور زیر اطمینان دارید؟</p>
                <div class="command-details-syntax" id="executionCommandPreview">...</div>
                <p class="text-warning"><i class="fas fa-exclamation-triangle"></i> توجه: اجرای دستورات از طریق این سایت فقط با اجازه شما و در محیط کنترل شده انجام می‌شود.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelExecutionBtn">لغو</button>
                <button class="btn btn-danger" id="confirmExecutionBtn">تایید و اجرا</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- System Alerts Container -->
    <div class="system-alerts-container" id="systemAlertsContainer"></div>

    <script>
        // ============================================
        // 1. Core Application State & Configuration
        // ============================================

        const ArkaApp = {
            config: {
                version: '2.0.0',
                debug: false,
                theme: 'dark', // 'dark', 'light'
                soundEnabled: true,
                language: 'fa',
                apiUrl: 'https://api.example.com/arka', // Placeholder for future API
                commands: {
                    cmd: [],
                    ps: [],
                    run: []
                }
            },
            state: {
                currentPage: 'dashboard',
                isLoading: true,
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                permissions: {
                    basicInfo: false,
                    performance: false,
                    display: false,
                    network: false,
                    location: false
                },
                systemInfo: {},
                chatHistory: [],
                pinnedCommands: [],
                eventLog: [],
                activeCommandDetails: null
            },
            elements: {},
            sounds: {
                click: null,
                success: null,
                error: null,
                terminal: null
            },
            charts: {
                cpu: null,
                ram: null,
                disk: null,
                network: null
            }
        };

        // ============================================
        // 2. Utility Functions
        // ============================================

        const Utils = {
            // Sanitize and clean user input (prevent XSS) - Fixed implementation
            sanitizeInput: (input) => {
                if (typeof input !== 'string') {
                    console.warn('Non-string input passed to sanitizeInput:', input);
                    return '';
                }
                // First, HTML encode all special characters
                const text = document.createTextNode(input);
                const div = document.createElement('div');
                div.appendChild(text);
                let safeHTML = div.innerHTML;

                // Remove any script tags and dangerous content
                safeHTML = safeHTML.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
                    .replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi, '')
                    .replace(/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi, '')
                    .replace(/<embed\b[^<]*(?:(?!<\/embed>)<[^<]*)*<\/embed>/gi, '')
                    .replace(/<svg\b[^<]*(?:(?!<\/svg>)<[^<]*)*<\/svg>/gi, '')
                    .replace(/on\w+=["'][^"']*["']/gi, '')
                    .replace(/javascript:/gi, '')
                    .replace(/data:/gi, '');

                // Allow safe HTML for formatting
                const allowedTags = {
                    'b': ['<b>', '</b>'],
                    'i': ['<i>', '</i>'],
                    'u': ['<u>', '</u>'],
                    'strong': ['<strong>', '</strong>'],
                    'em': ['<em>', '</em>'],
                    'br': ['<br>'],
                    'code': ['<code>', '</code>'],
                    'pre': ['<pre>', '</pre>'],
                    'p': ['<p>', '</p>'],
                    'ul': ['<ul>', '</ul>'],
                    'ol': ['<ol>', '</ol>'],
                    'li': ['<li>', '</li>']
                };

                Object.values(allowedTags).forEach(([open, close]) => {
                    safeHTML = safeHTML.replace(new RegExp(open.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi'), open)
                        .replace(new RegExp(close.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi'), close);
                });

                return safeHTML;
            },

            // Validate email with proper regex
            validateEmail: (email) => {
                if (typeof email !== 'string') return false;
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            },

            // Deep clone an object
            deepClone: (obj) => {
                if (obj === null || typeof obj !== 'object') return obj;
                if (obj instanceof Date) return new Date(obj.getTime());
                if (obj instanceof Array) return obj.map(item => Utils.deepClone(item));
                if (typeof obj === 'object') {
                    const cloned = {};
                    for (let key in obj) {
                        if (obj.hasOwnProperty(key)) {
                            cloned[key] = Utils.deepClone(obj[key]);
                        }
                    }
                    return cloned;
                }
            },

            // Generate random ID
            generateId: (prefix = 'id') => {
                return `${prefix}_${Math.random().toString(36).substr(2, 9)}`;
            },

            // Format bytes to human readable string
            formatBytes: (bytes, decimals = 2) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const dm = decimals < 0 ? 0 : decimals;
                const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
            },

            // Format duration from milliseconds
            formatDuration: (ms) => {
                const seconds = Math.floor(ms / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);

                if (days) return `${days}d ${hours % 24}h`;
                if (hours) return `${hours}h ${minutes % 60}m`;
                if (minutes) return `${minutes}m ${seconds % 60}s`;
                return `${seconds}s`;
            },

            // Debounce function
            debounce: (func, wait) => {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },

            // Throttle function
            throttle: (func, limit) => {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            }
        };

        // ============================================
        // 3. Storage Manager (localStorage wrapper)
        // ============================================

        const Storage = {
            get: (key, defaultValue = null) => {
                try {
                    const item = localStorage.getItem(key);
                    return item ? JSON.parse(item) : defaultValue;
                } catch (e) {
                    console.error(`Error getting item from localStorage: ${key}`, e);
                    return defaultValue;
                }
            },

            set: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch (e) {
                    console.error(`Error setting item to localStorage: ${key}`, e);
                }
            },

            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                } catch (e) {
                    console.error(`Error removing item from localStorage: ${key}`, e);
                }
            },

            clear: () => {
                try {
                    localStorage.clear();
                } catch (e) {
                    console.error('Error clearing localStorage', e);
                }
            }
        };

        // ============================================
        // 4. Event Manager (Centralized event tracking)
        // ============================================

        const EventManager = {
            events: [],

            track: (eventName, eventData = {}) => {
                if (typeof eventName !== 'string') {
                    console.error('Invalid event name:', eventName);
                    return;
                }

                // Rate limiting - max 10 events per second
                const now = Date.now();
                const lastEvents = Storage.get('arka_event_timestamps', []);
                const recentEvents = lastEvents.filter(ts => now - ts < 1000);
                if (recentEvents.length >= 10) {
                    console.warn('Event rate limit exceeded');
                    return;
                }
                recentEvents.push(now);
                Storage.set('arka_event_timestamps', recentEvents.slice(-20));

                // Log event
                const eventLog = {
                    event: eventName,
                    data: Utils.deepClone(eventData),
                    time: now,
                    url: window.location.href
                };
                console.log(`📊 Event tracked: ${eventName}`, eventLog);

                // Store in memory
                ArkaApp.state.eventLog.push(eventLog);

                // Store in localStorage for persistence
                Storage.set('arka_events', ArkaApp.state.eventLog.slice(-100)); // Keep last 100 events
            },

            getEvents: (limit = 50) => {
                return ArkaApp.state.eventLog.slice(-limit);
            }
        };

        // ============================================
        // 5. Toast Notification System
        // ============================================

        const Toast = {
            show: (message, type = 'info', duration = 3000) => {
                if (typeof message !== 'string') {
                    console.error('Invalid toast message:', message);
                    return;
                }

                const validTypes = ['success', 'error', 'warning', 'info'];
                if (!validTypes.includes(type)) {
                    type = 'info';
                }

                const toastId = `toast-${Date.now()}`;

                // Create toast container if not exists
                let toastContainer = document.getElementById('toastContainer');
                if (!toastContainer) {
                    toastContainer = document.createElement('div');
                    toastContainer.id = 'toastContainer';
                    toastContainer.style.position = 'fixed';
                    toastContainer.style.top = '20px';
                    toastContainer.style.right = '20px';
                    toastContainer.style.zIndex = '10000';
                    toastContainer.style.maxWidth = '400px';
                    document.body.appendChild(toastContainer);
                }

                const typeColors = {
                    success: 'rgba(16, 185, 129, 0.9)',
                    error: 'rgba(239, 68, 68, 0.9)',
                    warning: 'rgba(245, 158, 11, 0.9)',
                    info: 'rgba(59, 130, 246, 0.9)'
                };

                const typeIcons = {
                    success: '✅',
                    error: '❌',
                    warning: '⚠️',
                    info: 'ℹ️'
                };

                const toast = document.createElement('div');
                toast.id = toastId;
                toast.className = `toast toast-${type}`;
                toast.setAttribute('role', 'alert');
                toast.setAttribute('aria-live', 'polite');
                toast.innerHTML = `
                    <div class="toast-content">
                        <div class="toast-icon">${typeIcons[type]}</div>
                        <div class="toast-message">${Utils.sanitizeInput(message)}</div>
                    </div>
                    <button class="toast-close" aria-label="بستن اعلان">&times;</button>
                `;

                toastContainer.appendChild(toast);

                // Trigger show animation
                setTimeout(() => toast.classList.add('show'), 10);

                // Auto-hide
                const hideToast = () => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                };

                toast.querySelector('.toast-close').addEventListener('click', hideToast);
                if (duration > 0) {
                    setTimeout(hideToast, duration);
                }

                // Play sound if enabled
                if (ArkaApp.config.soundEnabled && ArkaApp.sounds[type]) {
                    ArkaApp.sounds[type].play().catch(e => console.warn('Sound play failed:', e));
                }
            }
        };

        // ============================================
        // 6. System Profiler (Collect system info with permission)
        // ============================================

        class SystemProfiler {
            constructor() {
                this.permissions = ArkaApp.state.permissions;
                this.data = ArkaApp.state.systemInfo;
            }

            async requestPermission(type) {
                // Check if already granted
                if (this.permissions[type]) return true;

                // Show modal for permission request
                const modal = this.createPermissionModal(type);
                document.body.appendChild(modal);

                return new Promise((resolve) => {
                    modal.querySelector('.allow-btn').addEventListener('click', () => {
                        this.permissions[type] = true;
                        this.collectData(type);
                        Storage.set('arka_permissions', this.permissions);
                        document.body.removeChild(modal);
                        resolve(true);
                    });

                    modal.querySelector('.deny-btn').addEventListener('click', () => {
                        document.body.removeChild(modal);
                        resolve(false);
                    });
                });
            }

            createPermissionModal(type) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.style.display = 'flex';
                modal.id = 'permissionModal';
                modal.innerHTML = `
                    <div class="modal">
                        <div class="modal-header">
                            <h3><i class="fas fa-lock"></i> درخواست اجازه</h3>
                            <button class="modal-close">&times;</button>
                        </div>
                        <div class="modal-body">
                            <p>آیا اجازه می‌دهید سایت اطلاعات ${this.getPermissionLabel(type)} را جمع‌آوری کند؟</p>
                            <p class="text-warning"><i class="fas fa-exclamation-triangle"></i> این اطلاعات فقط برای بهبود تجربه شما استفاده خواهد شد و با هیچ شخص ثالثی به اشتراک گذاشته نمی‌شود.</p>
                            <div class="permission-details">
                                <div class="detail-row">
                                    <i class="fas fa-info-circle detail-icon" aria-hidden="true"></i>
                                    <div class="detail-content">
                                        <h5>اطلاعات جمع‌آوری شده:</h5>
                                        <ul>
                                            ${this.getPermissionDetails(type)}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary deny-btn">لغو</button>
                            <button class="btn btn-primary allow-btn">اجازه می‌دهم</button>
                        </div>
                    </div>
                `;

                // Close button
                modal.querySelector('.modal-close').addEventListener('click', () => {
                    if (modal.parentNode) modal.parentNode.removeChild(modal);
                });

                return modal;
            }

            getPermissionLabel(type) {
                const labels = {
                    basicInfo: 'پایه سیستم',
                    performance: 'عملکرد',
                    display: 'نمایشگر',
                    network: 'شبکه',
                    location: 'مکان'
                };
                return labels[type] || type;
            }

            getPermissionDetails(type) {
                const details = {
                    basicInfo: `
                        <li>نوع سیستم عامل (مثلاً Windows 10)</li>
                        <li>مرورگر و نسخه (مثلاً Chrome 120)</li>
                        <li>زبان سیستم</li>
                        <li>منطقه زمانی</li>
                    `,
                    performance: `
                        <li>تعداد هسته پردازنده</li>
                        <li>حافظه RAM کلی</li>
                    `,
                    display: `
                        <li>ابعاد صفحه نمایش</li>
                        <li>عمق رنگ</li>
                    `,
                    network: `
                        <li>نوع اتصال (Wi-Fi یا کابلی)</li>
                    `,
                    location: `
                        <li>کشور/منطقه تقریبی (فقط برای CDN)</li>
                    `
                };
                return details[type] || '<li>اطلاعات مشخص نشده</li>';
            }

            async collectData(type) {
                if (!this.permissions[type]) return;

                switch (type) {
                    case 'basicInfo':
                        this.data.basic = this.collectBasicInfo();
                        break;
                    case 'performance':
                        this.data.performance = this.collectPerformanceInfo();
                        break;
                    case 'display':
                        this.data.display = this.collectDisplayInfo();
                        break;
                    case 'network':
                        this.data.network = this.collectNetworkInfo();
                        break;
                    case 'location':
                        this.data.location = await this.collectLocationInfo();
                        break;
                }

                ArkaApp.state.systemInfo = this.data;
                Storage.set('arka_system_info', this.data);
            }

            collectBasicInfo() {
                return {
                    os: this.detectOS(),
                    browser: this.detectBrowser(),
                    language: navigator.language,
                    platform: navigator.platform,
                    userAgent: navigator.userAgent,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    screen: {
                        width: screen.width,
                        height: screen.height,
                        colorDepth: screen.colorDepth
                    },
                    hardware: {
                        cores: navigator.hardwareConcurrency || 'نامشخص',
                        deviceMemory: navigator.deviceMemory ? `${navigator.deviceMemory}GB` : 'نامشخص'
                    }
                };
            }

            detectOS() {
                const ua = navigator.userAgent;
                if (ua.includes('Windows NT 10.0')) return 'Windows 10';
                if (ua.includes('Windows NT 6.3')) return 'Windows 8.1';
                if (ua.includes('Windows NT 6.2')) return 'Windows 8';
                if (ua.includes('Windows NT 6.1')) return 'Windows 7';
                if (ua.includes('Mac')) return 'macOS';
                if (ua.includes('Linux')) return 'Linux';
                return 'نامشخص';
            }

            detectBrowser() {
                const ua = navigator.userAgent;
                if (ua.includes('Chrome') && !ua.includes('Edg')) return 'Chrome';
                if (ua.includes('Firefox')) return 'Firefox';
                if (ua.includes('Safari') && !ua.includes('Chrome')) return 'Safari';
                if (ua.includes('Edg')) return 'Edge';
                return 'نامشخص';
            }

            collectPerformanceInfo() {
                return {
                    hardwareConcurrency: navigator.hardwareConcurrency,
                    deviceMemory: navigator.deviceMemory
                };
            }

            collectDisplayInfo() {
                return {
                    screenWidth: screen.width,
                    screenHeight: screen.height,
                    colorDepth: screen.colorDepth,
                    pixelDepth: screen.pixelDepth
                };
            }

            collectNetworkInfo() {
                // Note: Network Information API is not widely supported and has privacy concerns.
                // We only use connection type if available.
                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                return {
                    effectiveType: connection ? connection.effectiveType : 'نامشخص',
                    type: connection ? connection.type : 'نامشخص'
                };
            }

            async collectLocationInfo() {
                // Note: Geolocation requires explicit user permission and is not suitable for initial profiling.
                // We use a free IP geolocation service as an example.
                // IMPORTANT: This is just an example. In a real application, ensure compliance with privacy laws.
                try {
                    // This is a placeholder. In a real app, you might use a service like ipapi.co or similar.
                    // Be very cautious about calling external APIs without user consent.
                    // For this demo, we'll simulate the data.
                    return {
                        ip: 'DEMO_IP',
                        country: 'Iran',
                        region: 'Tehran',
                        city: 'Tehran',
                        timezone: 'Asia/Tehran'
                    };
                } catch (e) {
                    console.warn('Could not fetch location info:', e);
                    return { error: e.message };
                }
            }
        }

        // ============================================
        // 7. Chart Manager (Placeholder for real charts)
        // ============================================

        const ChartManager = {
            init: () => {
                // In a real app, you would initialize charting libraries like Chart.js here.
                // For this static demo, we'll just simulate data updates.
                console.log('ChartManager initialized (simulated)');
                // Simulate data updates
                setInterval(() => {
                    ChartManager.updateSimulatedData();
                }, 5000); // Update every 5 seconds
            },

            updateSimulatedData: () => {
                // Simulate updating chart values
                const cpuVal = Math.floor(Math.random() * 100);
                const ramVal = Math.floor(Math.random() * 100);
                const diskVal = Math.floor(Math.random() * 100);

                document.getElementById('cpuUsage').textContent = `${cpuVal}%`;
                document.getElementById('cpuProgressFill').style.width = `${cpuVal}%`;
                document.getElementById('cpuProgressText').textContent = `${cpuVal}%`;
                document.getElementById('cpuUsageDetail').textContent = `${cpuVal.toFixed(1)}%`;

                document.getElementById('ramUsage').textContent = `${ramVal}%`;
                document.getElementById('ramProgressFill').style.width = `${ramVal}%`;
                document.getElementById('ramProgressText').textContent = `${ramVal}%`;

                document.getElementById('diskUsage').textContent = `${diskVal}%`;
                document.getElementById('diskProgressFill').style.width = `${diskVal}%`;
                document.getElementById('diskProgressText').textContent = `${diskVal}%`;
            }
        };

        // ============================================
        // 8. Command Manager (Load and manage commands)
        // ============================================

        const CommandManager = {
            // This would ideally fetch from a JSON file or API
            loadCommands: () => {
                // Simulating loading commands
                ArkaApp.config.commands.cmd = [
                    { name: 'dir', desc: 'نمایش لیست فایل‌ها و پوشه‌ها' },
                    { name: 'cd', desc: 'تغییر دایرکتوری' },
                    { name: 'ipconfig', desc: 'نمایش اطلاعات IP' },
                    { name: 'ping', desc: 'بررسی اتصال شبکه' },
                    { name: 'tasklist', desc: 'لیست فرآیندها' },
                    { name: 'taskkill', desc: 'پایان دادن به فرآیند' },
                    { name: 'systeminfo', desc: 'اطلاعات سیستم' },
                    { name: 'sfc', desc: 'تعمیر فایل‌های سیستمی' },
                    { name: 'chkdsk', desc: 'بررسی دیسک' },
                    { name: 'netstat', desc: 'وضعیت اتصالات شبکه' },
                    { name: 'sc', desc: 'مدیریت سرویس‌ها' },
                    { name: 'wmic', desc: 'رابط WMI' },
                    { name: 'diskpart', desc: 'مدیریت پارتیشن' },
                    { name: 'cipher', desc: 'رمزگذاری دیسک' },
                    { name: 'assoc', desc: 'نوع فایل مرتبط با پسوند' },
                    { name: 'ftype', desc: 'برنامه باز کننده نوع فایل' },
                    { name: 'driverquery', desc: 'لیست درایورها' },
                    { name: 'netsh', desc: 'پیکربندی شبکه' },
                    { name: 'gpupdate', desc: 'به‌روزرسانی سیاست گروهی' },
                    { name: 'reg', desc: 'کار با رجیستری' },
                    { name: 'takeown', desc: 'دسترسی مالکیت' },
                    { name: 'icacls', desc: 'تغییر دسترسی‌ها' },
                    { name: 'robocopy', desc: 'کپی پیشرفته' },
                    { name: 'xcopy', desc: 'کپی فایل/پوشه (منسوخ)' },
                    { name: 'format', desc: 'فرمت درایو' },
                    { name: 'copy', desc: 'کپی فایل' },
                    { name: 'move', desc: 'انتقال فایل' },
                    { name: 'del', desc: 'حذف فایل' },
                    { name: 'md', desc: 'ایجاد پوشه' },
                    { name: 'rd', desc: 'حذف پوشه' },
                    { name: 'type', desc: 'محتوای فایل متنی' },
                    { name: 'find', desc: 'پیدا کردن متن' },
                    { name: 'findstr', desc: 'پیدا کردن رشته' },
                    { name: 'echo', desc: 'نمایش پیام' },
                    { name: 'cls', desc: 'پاک کردن صفحه' },
                    { name: 'ver', desc: 'نسخه ویندوز' },
                    { name: 'date', desc: 'تاریخ' },
                    { name: 'time', desc: 'زمان' },
                    { name: 'hostname', desc: 'نام میزبان' },
                    { name: 'whoami', desc: 'نام کاربر فعلی' },
                    { name: 'set', desc: 'متغیرهای محیطی' }
                ];

                ArkaApp.config.commands.ps = [
                    { name: 'Get-Process', desc: 'دریافت اطلاعات فرآیندها' },
                    { name: 'Get-Service', desc: 'دریافت اطلاعات سرویس‌ها' },
                    { name: 'Get-NetIPConfiguration', desc: 'پیکربندی IP' },
                    { name: 'Test-NetConnection', desc: 'بررسی اتصال' },
                    { name: 'Get-ComputerInfo', desc: 'اطلاعات سیستم' },
                    { name: 'Get-EventLog', desc: 'ورودی‌های گزارش' },
                    { name: 'Get-WmiObject', desc: 'اشیاء WMI' },
                    { name: 'Get-ItemProperty', desc: 'خصوصیات آیتم' },
                    { name: 'Set-ItemProperty', desc: 'تنظیم خصوصیات آیتم' },
                    { name: 'Remove-Item', desc: 'حذف آیتم' },
                    { name: 'New-Item', desc: 'ایجاد آیتم' },
                    { name: 'Get-Content', desc: 'محتوای فایل' },
                    { name: 'Set-Content', desc: 'تنظیم محتوای فایل' },
                    { name: 'Add-Content', desc: 'افزودن محتوا' },
                    { name: 'Get-Command', desc: 'اطلاعات دستور' },
                    { name: 'Get-Help', desc: 'راهنمای دستور' },
                    { name: 'Get-Module', desc: 'ماژول‌های نصب شده' },
                    { name: 'Import-Module', desc: 'وارد کردن ماژول' },
                    { name: 'Export-Csv', desc: 'ذخیره در CSV' },
                    { name: 'ConvertTo-Json', desc: 'تبدیل به JSON' },
                    { name: 'Invoke-WebRequest', desc: 'درخواست وب' },
                    { name: 'Start-Process', desc: 'شروع فرآیند' },
                    { name: 'Stop-Process', desc: 'متوقف کردن فرآیند' },
                    { name: 'Restart-Computer', desc: 'راه‌اندازی مجدد' },
                    { name: 'Stop-Computer', desc: 'خاموش کردن' },
                    { name: 'Get-NetAdapter', desc: 'اداپتورهای شبکه' },
                    { name: 'Get-Disk', desc: 'اطلاعات دیسک' },
                    { name: 'Get-Volume', desc: 'اطلاعات ولوم' },
                    { name: 'Get-NetRoute', desc: 'جدول مسیریابی' },
                    { name: 'Set-NetIPInterface', desc: 'پیکربندی IP' },
                    { name: 'Get-NetFirewallRule', desc: 'قوانین فایروال' },
                    { name: 'Enable-NetFirewallRule', desc: 'فعال کردن قانون' },
                    { name: 'Disable-NetFirewallRule', desc: 'غیرفعال کردن قانون' },
                    { name: 'Get-LocalUser', desc: 'کاربران محلی' },
                    { name: 'Get-LocalGroup', desc: 'گروه‌های محلی' },
                    { name: 'Get-ScheduledTask', desc: 'وظایف زمان‌بندی شده' },
                    { name: 'Start-ScheduledTask', desc: 'شروع وظیفه' },
                    { name: 'Stop-ScheduledTask', desc: 'متوقف کردن وظیفه' },
                    { name: 'Get-HotFix', desc: 'به‌روزرسانی‌های نصب شده' },
                    { name: 'Get-WindowsUpdateLog', desc: 'گزارش به‌روزرسانی' },
                    { name: 'Get-AppxPackage', desc: 'بسته‌های UWP' },
                    { name: 'Get-ExecutionPolicy', desc: 'سیاست اجرای اسکریپت' },
                    { name: 'Set-ExecutionPolicy', desc: 'تنظیم سیاست اجرای اسکریپت' }
                ];

                ArkaApp.config.commands.run = [
                    { name: 'cmd', desc: 'اجرای خط فرمان' },
                    { name: 'powershell', desc: 'اجرای PowerShell' },
                    { name: 'msconfig', desc: 'پیکربندی سیستم' },
                    { name: 'regedit', desc: 'ویرایشگر رجیستری' },
                    { name: 'taskmgr', desc: 'مدیر وظیفه' },
                    { name: 'devmgmt.msc', desc: 'مدیریت دستگاه‌ها' },
                    { name: 'services.msc', desc: 'مدیریت سرویس‌ها' },
                    { name: 'dxdiag', desc: 'اطلاعات Direct X' },
                    { name: 'gpedit.msc', desc: 'سیاست گروهی (Pro/Ent)' },
                    { name: 'perfmon', desc: 'مانیتور عملکرد' },
                    { name: 'eventvwr.msc', desc: 'نمایشگر رویدادها' },
                    { name: 'diskmgmt.msc', desc: 'مدیریت دیسک' },
                    { name: 'compmgmt.msc', desc: 'مدیریت کامپیوتر' },
                    { name: 'cleanmgr', desc: 'پاک‌سازی دیسک' },
                    { name: 'defrag C:', desc: 'دیفرگمنت کردن C' },
                    { name: 'notepad', desc: 'اجرای نوت‌پد' },
                    { name: 'calc', desc: 'اجرای ماشین حساب' },
                    { name: 'mspaint', desc: 'اجرای نقاشی' },
                    { name: 'write', desc: 'اجرای Wordpad' },
                    { name: 'control', desc: 'پنل کنترل' },
                    { name: 'control printers', desc: 'مدیریت چاپگرها' },
                    { name: 'inetcpl.cpl', desc: 'تنظیمات اینترنت' },
                    { name: 'ncpa.cpl', desc: 'کانکشن‌های شبکه' },
                    { name: 'sysdm.cpl', desc: 'خواص سیستم' },
                    { name: 'appwiz.cpl', desc: 'نصب/حذف برنامه' },
                    { name: 'firewall.cpl', desc: 'تنظیمات فایروال' },
                    { name: 'timedate.cpl', desc: 'تاریخ و زمان' },
                    { name: 'main.cpl', desc: 'تنظیمات ماوس' },
                    { name: 'mmsys.cpl', desc: 'تنظیمات صدا' },
                    { name: 'desk.cpl', desc: 'تنظیمات نمایشگر' },
                    { name: 'intl.cpl', desc: 'تنظیمات منطقه' },
                    { name: 'usrmgr.cpl', desc: 'مدیریت کاربران (Home)' },
                    { name: 'secpol.msc', desc: 'تنظیمات امنیت (Pro/Ent)' },
                    { name: 'certmgr.msc', desc: 'مدیریت گواهینامه' },
                    { name: 'lusrmgr.msc', desc: 'مدیریت کاربران/گروه‌ها (Pro/Ent)' },
                    { name: 'mstsc', desc: 'اتصال راه دور' },
                    { name: 'mobsync', desc: 'همگام‌سازی' },
                    { name: 'explorer', desc: 'مرورگر فایل' },
                    { name: 'iexplore', desc: 'اینترنت اکسپلورر' },
                    { name: 'winver', desc: 'اطلاعات نسخه ویندوز' },
                    { name: 'shutdown /s /t 0', desc: 'خاموش کردن فوری' },
                    { name: 'shutdown /r /t 0', desc: 'راه‌اندازی مجدد فوری' },
                    { name: 'slmgr.vbs /dli', desc: 'وضعیت لایسنس ویندوز' }
                ];

                // Populate command lists in UI (Simulated, actual population happens in pageLoad)
                console.log('Commands loaded (simulated).');
            },

            findCommand: (query, type) => {
                if (!query || !type) return [];
                const commands = ArkaApp.config.commands[type] || [];
                return commands.filter(cmd =>
                    cmd.name.toLowerCase().includes(query.toLowerCase()) ||
                    cmd.desc.toLowerCase().includes(query.toLowerCase())
                );
            }
        };

        // ============================================
        // 9. Page Manager (SPA navigation)
        // ============================================

        const PageManager = {
            init: () => {
                // Attach event listeners to nav links
                document.querySelectorAll('.nav-link[data-page]').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const pageId = link.getAttribute('data-page');
                        PageManager.navigateTo(pageId);
                    });
                });

                // Load initial page
                PageManager.showPage('dashboard');
            },

            navigateTo: (pageId) => {
                // Track navigation event
                EventManager.track('page_navigation', { from: ArkaApp.state.currentPage, to: pageId });

                // Hide current page
                document.getElementById(`${ArkaApp.state.currentPage}-page`).classList.remove('active');
                // Remove active class from nav
                document.querySelector(`.nav-link[data-page="${ArkaApp.state.currentPage}"]`).classList.remove('active');

                // Show new page
                PageManager.showPage(pageId);

                // Update active nav link
                document.querySelector(`.nav-link[data-page="${pageId}"]`).classList.add('active');

                // Update state
                ArkaApp.state.currentPage = pageId;

                // Update URL hash (optional for SPA)
                window.location.hash = pageId;

                // Focus on page title for accessibility
                const titleElement = document.getElementById(`${pageId}Title`);
                if (titleElement) {
                    titleElement.focus({ preventScroll: true });
                }
            },

            showPage: (pageId) => {
                const pageElement = document.getElementById(`${pageId}-page`);
                if (pageElement) {
                    pageElement.classList.add('active');
                    // Trigger page-specific load logic if exists
                    if (typeof PageManager[`load${pageId.charAt(0).toUpperCase() + pageId.slice(1)}`] === 'function') {
                        PageManager[`load${pageId.charAt(0).toUpperCase() + pageId.slice(1)}`]();
                    }
                }
            },

            loadCmdSection: () => {
                // Populate CMD command list
                const listElement = document.getElementById('cmdCommandList');
                if (listElement) {
                    listElement.innerHTML = ''; // Clear existing
                    ArkaApp.config.commands.cmd.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => {
                            CommandManager.showDetails(cmd, 'cmd');
                        });
                        listElement.appendChild(item);
                    });
                }
            },

            loadPsSection: () => {
                // Populate PS command list
                const listElement = document.getElementById('psCommandList');
                if (listElement) {
                    listElement.innerHTML = ''; // Clear existing
                    ArkaApp.config.commands.ps.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => {
                            CommandManager.showDetails(cmd, 'ps');
                        });
                        listElement.appendChild(item);
                    });
                }
            },

            loadRunSection: () => {
                // Populate Run command list
                const listElement = document.getElementById('runCommandList');
                if (listElement) {
                    listElement.innerHTML = ''; // Clear existing
                    ArkaApp.config.commands.run.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => {
                            CommandManager.showDetails(cmd, 'run');
                        });
                        listElement.appendChild(item);
                    });
                }
            }
        };

        // ============================================
        // 10. Command Manager - Details View
        // ============================================

        CommandManager.showDetails = (command, type) => {
            // Update active state in list
            document.querySelectorAll(`#${type}CommandList .command-list-item`).forEach(item => {
                item.classList.remove('active');
            });
            // Find the clicked item and make it active (this requires a reference to the specific item clicked, which is handled in the click handler above)

            // Populate details based on type
            let titleId, contentId, pinBtnId, copyBtnId, execBtnId, detailsContent = '';

            switch (type) {
                case 'cmd':
                    titleId = 'commandDetailsTitle';
                    contentId = 'commandDetailsContent';
                    pinBtnId = 'pinCommandBtn';
                    copyBtnId = 'copyCommandBtn';
                    execBtnId = 'executeCommandBtn';
                    // Detailed description would come from a data source
                    detailsContent = `
                        <h4 class="command-details-title">${Utils.sanitizeInput(command.name)}</h4>
                        <p class="command-details-description">
                            ${Utils.sanitizeInput(command.desc)} - دستور <code>${Utils.sanitizeInput(command.name)}</code> در خط فرمان ویندوز برای انجام عمل خاصی استفاده می‌شود.
                        </p>
                        <div class="command-details-syntax">
                            ${Utils.sanitizeInput(command.name)} [پارامترها]
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها:</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">[پارامتر]</div>
                                <div class="parameter-desc">توضیح پارامتر.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. مثال کلی:</strong></p>
                                <div class="example-code">${Utils.sanitizeInput(command.name)}</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این یک دستور پایه است. برای اطلاعات بیشتر، از دستور <code>help ${command.name}</code> در CMD استفاده کنید.</p>
                        </div>
                    `;
                    break;
                case 'ps':
                    titleId = 'psCommandDetailsTitle';
                    contentId = 'psCommandDetailsContent';
                    pinBtnId = 'pinPsCommandBtn';
                    copyBtnId = 'copyPsCommandBtn';
                    execBtnId = 'executePsCommandBtn';
                    detailsContent = `
                        <h4 class="command-details-title">${Utils.sanitizeInput(command.name)}</h4>
                        <p class="command-details-description">
                            ${Utils.sanitizeInput(command.desc)} - دستور <code>${Utils.sanitizeInput(command.name)}</code> در PowerShell برای انجام عمل خاصی استفاده می‌شود.
                        </p>
                        <div class="command-details-syntax">
                            ${Utils.sanitizeInput(command.name)} [-پارامتر] <مقدار>
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها:</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">-پارامتر</div>
                                <div class="parameter-desc">توضیح پارامتر.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. مثال کلی:</strong></p>
                                <div class="example-code">${Utils.sanitizeInput(command.name)}</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این یک دستور پایه است. برای اطلاعات بیشتر، از دستور <code>Get-Help ${command.name}</code> در PowerShell استفاده کنید.</p>
                        </div>
                    `;
                    break;
                case 'run':
                    titleId = 'runCommandDetailsTitle';
                    contentId = 'runCommandDetailsContent';
                    pinBtnId = 'pinRunCommandBtn';
                    copyBtnId = 'copyRunCommandBtn';
                    execBtnId = 'executeRunCommandBtn';
                    detailsContent = `
                        <h4 class="command-details-title">${Utils.sanitizeInput(command.name)}</h4>
                        <p class="command-details-description">
                            ${Utils.sanitizeInput(command.desc)} - دستور <code>${Utils.sanitizeInput(command.name)}</code> در پنجره Run برای انجام عمل خاصی استفاده می‌شود.
                        </p>
                        <div class="command-details-syntax">
                            ${Utils.sanitizeInput(command.name)}
                        </div>
                        <div class="command-details-parameters">
                            <h5>پارامترها (در صورت وجود):</h5>
                            <div class="parameter-item">
                                <div class="parameter-name">[پارامتر]</div>
                                <div class="parameter-desc">توضیح پارامتر.</div>
                            </div>
                        </div>
                        <div class="command-details-examples">
                            <h5>مثال‌ها:</h5>
                            <div class="example-item">
                                <p><strong>1. اجرا معمولی:</strong></p>
                                <div class="example-code">${Utils.sanitizeInput(command.name)}</div>
                            </div>
                        </div>
                        <div class="command-details-notes">
                            <h5>نکات:</h5>
                            <p>این دستور مستقیماً از پنجره Run قابل اجرا است. معمولاً برای دسترسی سریع به ابزارهای سیستمی استفاده می‌شود.</p>
                        </div>
                    `;
                    break;
            }

            // Update UI
            if (titleId) document.getElementById(titleId).textContent = command.name;
            if (contentId) document.getElementById(contentId).innerHTML = detailsContent;

            // Store reference for copy/execute
            ArkaApp.state.activeCommandDetails = { command, type };

            // Attach event listeners for actions
            if (copyBtnId) {
                const copyBtn = document.getElementById(copyBtnId);
                copyBtn.onclick = () => CommandManager.copyCommand(command.name);
            }
            if (execBtnId) {
                const execBtn = document.getElementById(execBtnId);
                execBtn.onclick = () => CommandManager.executeCommand(command.name, type);
            }
            if (pinBtnId) {
                const pinBtn = document.getElementById(pinBtnId);
                pinBtn.onclick = () => CommandManager.pinCommand(command.name, type);
            }
        };

        CommandManager.copyCommand = async (command) => {
            try {
                await navigator.clipboard.writeText(command);
                Toast.show('دستور کپی شد!', 'success');
                EventManager.track('command_copied', { command });
            } catch (err) {
                console.error('Failed to copy: ', err);
                Toast.show('کپی انجام نشد. لطفاً دوباره تلاش کنید.', 'error');
            }
        };

        CommandManager.executeCommand = (command, type) => {
            // Show confirmation modal
            document.getElementById('executionCommandPreview').textContent = command;
            document.getElementById('executionModal').style.display = 'flex';

            // Handle confirmation
            document.getElementById('confirmExecutionBtn').onclick = () => {
                // In a real app, this would send the command to a secure backend for execution on the user's machine.
                // THIS IS A SIMULATION AND DOES NOT EXECUTE ANYTHING.
                Toast.show(`تلاش برای اجرای "${command}" از طریق ${type.toUpperCase()}... (شبیه‌سازی)`, 'info');
                console.log(`Execution simulation for: ${command} on ${type}`);
                EventManager.track('command_execution_attempt', { command, type });
                // Close modal
                document.getElementById('executionModal').style.display = 'none';
            };

            document.getElementById('cancelExecutionBtn').onclick = () => {
                document.getElementById('executionModal').style.display = 'none';
            };

            document.getElementById('closeExecutionModal').onclick = () => {
                document.getElementById('executionModal').style.display = 'none';
            };
        };

        CommandManager.pinCommand = (command, type) => {
            const key = `${type}_pinned`;
            let pinned = Storage.get(key, []);
            if (!pinned.includes(command)) {
                pinned.push(command);
                Storage.set(key, pinned);
                ArkaApp.state.pinnedCommands = pinned;
                Toast.show('دستور نشان شد!', 'success');
                EventManager.track('command_pinned', { command, type });
            } else {
                Toast.show('این دستور قبلاً نشان شده بود.', 'info');
            }
        };

        // ============================================
        // 11. AI Manager (Placeholder for AI logic)
        // ============================================

        const AIManager = {
            init: () => {
                // Attach event listeners for AI features
                document.getElementById('aiChatSendBtn').addEventListener('click', AIManager.handleChatInput);
                document.getElementById('aiChatInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        AIManager.handleChatInput();
                    }
                });

                document.querySelectorAll('.suggestion-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const suggestion = btn.getAttribute('data-suggestion');
                        AIManager.handleSuggestion(suggestion);
                    });
                });

                document.querySelectorAll('.tool-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const tool = card.getAttribute('data-tool');
                        AIManager.handleToolRequest(tool);
                    });
                });
            },

            handleChatInput: () => {
                const inputElement = document.getElementById('aiChatInput');
                const message = inputElement.value.trim();
                if (!message) return;

                // Add user message to chat
                AIManager.addMessageToChat(message, 'user');

                // Clear input
                inputElement.value = '';

                // Simulate AI response
                setTimeout(() => {
                    const aiResponse = AIManager.generateResponse(message);
                    AIManager.addMessageToChat(aiResponse, 'ai');
                }, 1000); // Simulate processing delay
            },

            addMessageToChat: (text, sender) => {
                const chatContainer = document.getElementById('chatMessages');
                const messageElement = document.createElement('div');
                messageElement.className = `message ${sender}`;
                messageElement.innerHTML = `
                    <div class="message-content">
                        <p>${Utils.sanitizeInput(text)}</p>
                    </div>
                    <div class="message-time">همین الان</div>
                `;
                chatContainer.appendChild(messageElement);
                // Scroll to bottom
                chatContainer.scrollTop = chatContainer.scrollHeight;
            },

            generateResponse: (input) => {
                // This is a very basic simulation. A real AI would connect to an API.
                const lowerInput = input.toLowerCase();
                if (lowerInput.includes('سیستم') && lowerInput.includes('داغ')) {
                    return "به نظر می‌رسد مشکل گرمای سیستم دارید. می‌توانید دستور <code>msinfo32</code> را اجرا کنید تا جزئیات سخت‌افزار را بررسی کنید. همچنین می‌توانید از بخش 'دستورات Run' دستور <code>perfmon</code> را برای بررسی مانیتور عملکرد امتحان کنید. آیا می‌خواهید راهنمایی بیشتری داشته باشید؟";
                }
                if (lowerInput.includes('فضای') && lowerInput.includes('دیسک')) {
                    return "برای آزاد کردن فضای دیسک، می‌توانید از دستور <code>cleanmgr</code> در بخش 'Run' استفاده کنید. همچنین دستور <code>dir /s</code> در CMD می‌تواند کمک کند تا فایل‌های بزرگ را پیدا کنید. آیا می‌خواهید چگونه این کار را انجام دهم؟";
                }
                if (lowerInput.includes('سرعت') && lowerInput.includes('ویندوز')) {
                    return "برای افزایش سرعت ویندوز، می‌توانید خدمات غیرضروری را غیرفعال کنید. از منوی بالا بخش 'PowerShell' را انتخاب کنید و دستور <code>Get-Service | Where-Object {$_.StartType -eq 'Automatic' -and $_.Status -eq 'Stopped'}</code> را جستجو کنید. سپس می‌توانید وضعیت آن‌ها را بررسی و تغییر دهید. همچنین دستور <code>msconfig</code> در 'Run' می‌تواند کمک کننده باشد.";
                }
                return "ممنون از پیام شما. من یک مدل زبانی هوش مصنوعی هستم و در حال حاضر قادر به اجرای مستقیم دستورات روی سیستم شما نیستم، اما می‌توانم راهنمایی‌های لازم را ارائه دهم. لطفاً مشکل یا سوال خود را با جزئیات بیشتری بیان کنید.";
            },

            handleSuggestion: (suggestion) => {
                let message = '';
                switch(suggestion) {
                    case 'optimize':
                        message = 'چگونه می‌توانم سیستم ویندوز خود را بهینه‌سازی کنم؟';
                        break;
                    case 'security':
                        message = 'چگونه می‌توانم امنیت سیستم خود را بررسی کنم؟';
                        break;
                    case 'gaming':
                        message = 'چگونه ویندوز را برای گیمینگ بهینه کنم؟';
                        break;
                    case 'script':
                        message = 'چگونه یک اسکریپت PowerShell بنویسم؟';
                        break;
                    case 'report':
                        message = 'چگونه گزارش عملکرد سیستم بگیرم؟';
                        break;
                    default:
                        message = 'سلام، کمکم کن.';
                }
                document.getElementById('aiChatInput').value = message;
                AIManager.handleChatInput();
            },

            handleToolRequest: (tool) => {
                let message = '';
                switch(tool) {
                    case 'cmd-helper':
                        message = 'راهنمای دستورات CMD لطفاً.';
                        break;
                    case 'ps-helper':
                        message = 'چطور یک اسکریپت PowerShell برای پاک‌سازی فایل‌های قدیمی بنویسم؟';
                        break;
                    case 'run-helper':
                        message = 'پیدا کردن مسیر مرورگر پیش‌فرض.';
                        break;
                    case 'system-analyzer':
                        message = 'بررسی مشکلات سیستم.';
                        break;
                    case 'security-advisor':
                        message = 'توصیه‌های امنیتی.';
                        break;
                    case 'performance-tuner':
                        message = 'تنظیمات بهینه عملکرد.';
                        break;
                    default:
                        message = 'در مورد ' + tool + ' کمکم کن.';
                }
                document.getElementById('aiChatInput').value = message;
                AIManager.handleChatInput();
            }
        };

        // ============================================
        // 12. Main Application Initialization
        // ============================================

        const initApp = async () => {
            console.log('Initializing Arka App v' + ArkaApp.config.version);

            // 1. Initialize Storage and State
            ArkaApp.state.permissions = Storage.get('arka_permissions', ArkaApp.state.permissions);
            ArkaApp.state.systemInfo = Storage.get('arka_system_info', ArkaApp.state.systemInfo);
            ArkaApp.state.chatHistory = Storage.get('arka_chat_history', ArkaApp.state.chatHistory);
            ArkaApp.state.pinnedCommands = [
                ...Storage.get('cmd_pinned', []),
                ...Storage.get('ps_pinned', []),
                ...Storage.get('run_pinned', [])
            ];

            // 2. Check for Mobile
            if (ArkaApp.state.isMobile) {
                document.getElementById('mobileWarningOverlay').style.display = 'flex';
                document.getElementById('closeMobileWarningBtn').addEventListener('click', () => {
                    document.getElementById('mobileWarningOverlay').style.display = 'none';
                });
            }

            // 3. Simulate Loading Progress
            const progressFill = document.getElementById('loadingProgressFill');
            const progressText = document.getElementById('loadingProgressText');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').classList.add('hidden');
                        document.body.classList.remove('no-js');
                        document.getElementById('mainContent').classList.add('loaded');
                        ArkaApp.state.isLoading = false;
                    }, 500);
                }
            }, 200); // Simulate loading time

            // 4. Initialize Managers after loading
            setTimeout(() => {
                // Load commands
                CommandManager.loadCommands();

                // Initialize Chart Manager
                ChartManager.init();

                // Initialize Page Manager
                PageManager.init();

                // Initialize AI Manager
                AIManager.init();

                // Attach global event listeners
                document.getElementById('themeToggleBtn').addEventListener('click', toggleTheme);
                document.getElementById('soundToggleBtn').addEventListener('click', toggleSound);

                // Attach search listeners
                document.getElementById('cmdSearch').addEventListener('input', Utils.debounce((e) => {
                    const query = e.target.value;
                    const results = CommandManager.findCommand(query, 'cmd');
                    // Update UI with results (simplified)
                    const listElement = document.getElementById('cmdCommandList');
                    listElement.innerHTML = '';
                    results.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => CommandManager.showDetails(cmd, 'cmd'));
                        listElement.appendChild(item);
                    });
                }, 300));

                document.getElementById('psSearch').addEventListener('input', Utils.debounce((e) => {
                    const query = e.target.value;
                    const results = CommandManager.findCommand(query, 'ps');
                    const listElement = document.getElementById('psCommandList');
                    listElement.innerHTML = '';
                    results.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => CommandManager.showDetails(cmd, 'ps'));
                        listElement.appendChild(item);
                    });
                }, 300));

                document.getElementById('runSearch').addEventListener('input', Utils.debounce((e) => {
                    const query = e.target.value;
                    const results = CommandManager.findCommand(query, 'run');
                    const listElement = document.getElementById('runCommandList');
                    listElement.innerHTML = '';
                    results.forEach(cmd => {
                        const item = document.createElement('div');
                        item.className = 'command-list-item';
                        item.innerHTML = `
                            <div>
                                <div class="command-name">${Utils.sanitizeInput(cmd.name)}</div>
                                <div class="command-desc">${Utils.sanitizeInput(cmd.desc)}</div>
                            </div>
                        `;
                        item.addEventListener('click', () => CommandManager.showDetails(cmd, 'run'));
                        listElement.appendChild(item);
                    });
                }, 300));

                // Modal Close Buttons
                document.querySelectorAll('.modal-close').forEach(btn => {
                    btn.addEventListener('click', function() {
                        this.closest('.modal-overlay').style.display = 'none';
                    });
                });

                // Close modals on overlay click
                document.querySelectorAll('.modal-overlay').forEach(overlay => {
                    overlay.addEventListener('click', function(e) {
                        if (e.target === this) {
                            this.style.display = 'none';
                        }
                    });
                });

            }, 1100); // Match the simulated loading time

            // 5. Request Basic Permissions (example)
            const profiler = new SystemProfiler();
            // Request basic info on initial load (this is just an example trigger)
            // In a real app, you might trigger this based on user action or context.
            // setTimeout(() => profiler.requestPermission('basicInfo'), 3000);

            console.log('Arka App initialized.');
        };

        // ============================================
        // 13. Helper Functions (Theme, Sound, etc.)
        // ============================================

        const toggleTheme = () => {
            ArkaApp.config.theme = ArkaApp.config.theme === 'dark' ? 'light' : 'dark';
            document.body.setAttribute('data-theme', ArkaApp.config.theme);
            Storage.set('arka_theme', ArkaApp.config.theme);
            Toast.show(`تم ${ArkaApp.config.theme} انتخاب شد.`, 'info');
            EventManager.track('theme_changed', { theme: ArkaApp.config.theme });
        };

        const toggleSound = () => {
            ArkaApp.config.soundEnabled = !ArkaApp.config.soundEnabled;
            document.getElementById('soundIcon').className = ArkaApp.config.soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
            Storage.set('arka_sound_enabled', ArkaApp.config.soundEnabled);
            Toast.show(ArkaApp.config.soundEnabled ? 'صدا فعال شد.' : 'صدا خاموش شد.', 'info');
            EventManager.track('sound_toggled', { enabled: ArkaApp.config.soundEnabled });
        };

        // ============================================
        // 14. Initialize the Application when DOM is loaded
        // ============================================

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }
    <script>
        // ============================================
        // 15. Enhanced Command Manager - Details View (Continued)
        // ============================================

        // Add more detailed command information for CMD section
        const detailedCmdCommands = {
            'dir': {
                name: 'dir',
                description: 'نمایش لیست فایل‌ها و پوشه‌های موجود در یک دایرکتوری',
                syntax: 'dir [Drive:][Path][Filename] [/A[[:]attributes]] [/B] [/C] [/D] [/L] [/N] [/O[[:]sortorder]] [/P] [/Q] [/R] [/S] [/T[[:]timefield]] [/W] [/X] [/4]',
                parameters: [
                    { name: '[Drive:][Path][Filename]', description: 'مکان دایرکتوری یا فایل مورد نظر برای لیست شدن.' },
                    { name: '/A[[:]attributes]', description: 'مشخص کردن ویژگی‌های فایل‌ها یا پوشه‌هایی که باید نمایش داده شوند (مثلاً فقط فایل‌های مخفی).' },
                    { name: '/B', description: 'حالت خام، فقط نام فایل‌ها و پوشه‌ها را نشان می‌دهد.' },
                    { name: '/S', description: 'جستجو در زیرشاخه‌ها.' },
                    { name: '/P', description: 'متوقف کردن خروجی پس از هر صفحه.' }
                ],
                examples: [
                    { example: 'dir', description: 'نمایش همه فایل‌ها در دایرکتوری فعلی' },
                    { example: 'dir C:\\*.txt', description: 'نمایش فقط فایل‌های متنی در درایو C' },
                    { example: 'dir /B', description: 'نمایش لیست فایل‌ها در حالت خام' }
                ],
                notes: 'این دستور یکی از پرکاربردترین دستورات CMD است. ترکیب‌های مختلف پارامترها می‌تواند اطلاعات بسیار دقیقی را ارائه دهد.'
            },
            'cd': {
                name: 'cd',
                description: 'تغییر دایرکتوری فعلی',
                syntax: 'cd [Drive:][Path] یا cd ..',
                parameters: [
                    { name: '[Drive:][Path]', description: 'مسیر دایرکتوری جدید.' },
                    { name: '..', description: 'برگرداندن یک سطح بالاتر.' }
                ],
                examples: [
                    { example: 'cd C:\\Users', description: 'رفتن به پوشه Users' },
                    { example: 'cd ..', description: 'برگشت یک سطح بالا' }
                ],
                notes: 'می‌توان از مسیرهای مطلق یا نسبی استفاده کرد.'
            },
            'ipconfig': {
                name: 'ipconfig',
                description: 'نمایش اطلاعات پیکربندی IP',
                syntax: 'ipconfig [/all] [/renew [Adapter]] [/release [Adapter]] [/flushdns]',
                parameters: [
                    { name: '/all', description: 'نمایش تمام اطلاعات پیکربندی.' },
                    { name: '/renew [Adapter]', description: 'تمدید اجاره IP.' },
                    { name: '/release [Adapter]', description: 'لغو اجاره IP.' },
                    { name: '/flushdns', description: 'پاک کردن کش DNS.' }
                ],
                examples: [
                    { example: 'ipconfig', description: 'نمایش اطلاعات پایه' },
                    { example: 'ipconfig /all', description: 'نمایش تمام اطلاعات' },
                    { example: 'ipconfig /flushdns', description: 'پاک کردن کش DNS' }
                ],
                notes: 'برای عیب‌یابی مشکلات شبکه بسیار مفید است.'
            },
            'ping': {
                name: 'ping',
                description: 'بررسی قابلیت دسترسی به یک میزبان شبکه',
                syntax: 'ping [-t] [-a] [-n count] [-l size] [-f] [-i TTL] [-v TOS] [-r count] [-s count] [[-j host-list] | [-k host-list]] [-w timeout] [-R] [-S srcaddr] [-4] [-6] target_name',
                parameters: [
                    { name: '-t', description: 'ارسال پینگ‌ها تا زمانی که کاربر متوقف کند (Ctrl+C).' },
                    { name: '-n count', description: 'تعداد پینگ‌های ارسالی.' },
                    { name: '-l size', description: 'اندازه بایت داده در هر پینگ.' },
                    { name: '-w timeout', description: 'زمان انتظار بر حسب میلی‌ثانیه.' }
                ],
                examples: [
                    { example: 'ping google.com', description: 'پینگ کردن گوگل' },
                    { example: 'ping -t 192.168.1.1', description: 'پینگ مداوم یک آی‌پی' }
                ],
                notes: 'برای تست اتصال شبکه و اندازه گیری ping latency کاربرد دارد.'
            },
            'tasklist': {
                name: 'tasklist',
                description: 'نمایش لیست فرآیندهای در حال اجرا',
                syntax: 'tasklist [/S system [/U username [/P [password]]]] [/M [module] | /SVC | /V] [/FI filter] [/FO format] [/NH]',
                parameters: [
                    { name: '/M [module]', description: 'لیست فرآیندهایی که یک ماژول خاص را بارگذاری کرده‌اند.' },
                    { name: '/SVC', description: 'نمایش سرویس‌های مرتبط با فرآیندها.' },
                    { name: '/V', description: 'نمایش اطلاعات بیشتر.' },
                    { name: '/FI filter', description: 'فیلتر کردن نتایج.' }
                ],
                examples: [
                    { example: 'tasklist', description: 'نمایش تمام فرآیندها' },
                    { example: 'tasklist /FI "MEMUSAGE gt 100000"', description: 'فرآیندهایی که بیش از 100MB حافظه مصرف می‌کنند' }
                ],
                notes: 'برای یافتن فرآیندهای پر مصرف کاربرد دارد.'
            },
            'taskkill': {
                name: 'taskkill',
                description: 'پایان دادن به یک فرآیند',
                syntax: 'taskkill [/S system [/U username [/P [password]]]] {[/FI filter] [/FI filter] ...} [/IM imagename | /PID pid] [/T] [/F]',
                parameters: [
                    { name: '/IM imagename', description: 'نام تصویر فرآیند (مثلاً notepad.exe).' },
                    { name: '/PID pid', description: 'شناسه فرآیند.' },
                    { name: '/F', description: 'نیروی پایان دادن (Force).' },
                    { name: '/T', description: 'پایان دادن به درخت فرآیند.' }
                ],
                examples: [
                    { example: 'taskkill /IM notepad.exe', description: 'بستن نوت‌پد' },
                    { example: 'taskkill /PID 1234 /F', description: 'نیروی بستن فرآیند با PID 1234' }
                ],
                notes: 'دقت کنید، بستن فرآیندهای سیستمی می‌تواند باعث ناپایداری شود.'
            },
            'systeminfo': {
                name: 'systeminfo',
                description: 'نمایش جزئیات سخت‌افزار و نرم‌افزار سیستم',
                syntax: 'systeminfo [/S system [/U username [/P [password]]]] [/FO format] [/NH]',
                parameters: [
                    { name: '/S system', description: 'نام سیستم راه دور.' },
                    { name: '/FO format', description: 'فرمت خروجی (TABLE، LIST، CSV).' }
                ],
                examples: [
                    { example: 'systeminfo', description: 'نمایش کلیه اطلاعات سیستم' },
                    { example: 'systeminfo /FO CSV', description: 'خروجی به صورت CSV' }
                ],
                notes: 'اطلاعات جامعی از سیستم عامل، سخت‌افزار، BIOS، و غیره ارائه می‌دهد.'
            },
            'sfc': {
                name: 'sfc',
                description: 'بررسی و تعمیر فایل‌های سیستمی ویندوز',
                syntax: 'sfc [/scannow] [/verifyonly] [/scanfile=<file>] [/verifyfile=<file>] [/offbootdir=<offline boot directory>] [/offwindir=<offline windows directory>]',
                parameters: [
                    { name: '/scannow', description: 'بررسی و تعمیر تمام فایل‌های سیستمی.' },
                    { name: '/verifyonly', description: 'فقط بررسی (بدون تعمیر).' },
                    { name: '/scanfile=<file>', description: 'بررسی یک فایل خاص.' }
                ],
                examples: [
                    { example: 'sfc /scannow', description: 'بررسی و تعمیر کامل' }
                ],
                notes: 'برای رفع مشکلات مربوط به فایل‌های سیستمی استفاده می‌شود. نیاز به اجرای CMD با دسترسی ادمین دارد.'
            },
            'chkdsk': {
                name: 'chkdsk',
                description: 'بررسی و تعمیر خطاها در دیسک',
                syntax: 'chkdsk [volume[[path]filename]]] [/f] [/v] [/r] [/x] [/i] [/c] [/l[:<size>]]',
                parameters: [
                    { name: 'volume', description: 'درایو مورد نظر (مثلاً C:).' },
                    { name: '/f', description: 'تعمیر خطاها.' },
                    { name: '/r', description: 'پیدا کردن بخش‌های خراب و بازیابی اطلاعات.' },
                    { name: '/x', description: 'فورس از دست دادن مونت درایو.' }
                ],
                examples: [
                    { example: 'chkdsk C:', description: 'بررسی درایو C' },
                    { example: 'chkdsk C: /f', description: 'بررسی و تعمیر درایو C' }
                ],
                notes: 'برای رفع مشکلات فیزیکی و منطقی دیسک استفاده می‌شود. نیاز به ادمین دارد و ممکن است نیاز به راه‌اندازی مجدد باشد.'
            },
            'netstat': {
                name: 'netstat',
                description: 'نمایش وضعیت اتصالات شبکه',
                syntax: 'netstat [-a] [-b] [-e] [-f] [-n] [-o] [-p Protocol] [-q] [-r] [-s] [-t] [Interval]',
                parameters: [
                    { name: '-a', description: 'نمایش اتصالات فعال و پورت‌های گوش داده.' },
                    { name: '-n', description: 'نمایش آدرس‌های عددی (IP و Port). بدون نام میزبان.' },
                    { name: '-o', description: 'نمایش شناسه فرآیند (PID) مربوط به هر اتصال.' },
                    { name: '-r', description: 'نمایش جدول مسیریابی.' }
                ],
                examples: [
                    { example: 'netstat -an', description: 'نمایش تمام اتصالات و پورت‌ها' },
                    { example: 'netstat -ano', description: 'همراه با PID فرآیند' }
                ],
                notes: 'برای تحلیل اتصالات شبکه و پیدا کردن فرآیندهای مرتبط با یک پورت کاربرد دارد.'
            },
            'sc': {
                name: 'sc',
                description: 'مدیریت سرویس‌های ویندوز',
                syntax: 'sc [\\ServerName] [command] [ServiceName] [options]',
                parameters: [
                    { name: 'query', description: 'پرس و جو درباره یک سرویس.' },
                    { name: 'start', description: 'شروع یک سرویس.' },
                    { name: 'stop', description: 'متوقف کردن یک سرویس.' },
                    { name: 'config', description: 'پیکربندی یک سرویس.' }
                ],
                examples: [
                    { example: 'sc query Spooler', description: 'بررسی وضعیت سرویس چاپ' },
                    { example: 'sc stop Spooler', description: 'متوقف کردن سرویس چاپ' },
                    { example: 'sc start Spooler', description: 'شروع سرویس چاپ' }
                ],
                notes: 'دستور بسیار قدرتمندی برای مدیریت سرویس‌های سیستمی است.'
            },
            'wmic': {
                name: 'wmic',
                description: 'رابط خط فرمان برای WMI (Windows Management Instrumentation)',
                syntax: 'wmic [GlobalSwitches] [Namespace] [Alias] [FormatNotification] [Action] [WhereClause] [PropertyList] [Get/Set/Call Extensions] [Value] [Assignment] [Value]',
                parameters: [
                    { name: 'computersystem', description: 'اطلاعات سیستم کامپیوتر.' },
                    { name: 'process', description: 'اطلاعات فرآیندها.' },
                    { name: 'service', description: 'اطلاعات سرویس‌ها.' },
                    { name: 'diskdrive', description: 'اطلاعات درایو دیسک.' }
                ],
                examples: [
                    { example: 'wmic computersystem get name', description: 'نام سیستم' },
                    { example: 'wmic process list brief', description: 'لیست فرآیندها' }
                ],
                notes: 'دستور پیشرفته برای کار با اشیاء WMI. نحوه استفاده پیچیده است.'
            },
            'diskpart': {
                name: 'diskpart',
                description: 'مدیریت پارتیشن‌های دیسک',
                syntax: 'diskpart (سپس دستورات داخل محیط diskpart)',
                parameters: [
                    { name: 'list disk', description: 'لیست دیسک‌ها.' },
                    { name: 'select disk N', description: 'انتخاب دیسک شماره N.' },
                    { name: 'list partition', description: 'لیست پارتیشن‌ها.' },
                    { name: 'create partition primary', description: 'ایجاد پارتیشن اصلی.' },
                    { name: 'delete partition', description: 'حذف پارتیشن.' },
                    { name: 'format', description: 'فرمت کردن.' },
                    { name: 'assign letter=X', description: 'اختصاص حرف X.' }
                ],
                examples: [
                    { example: 'diskpart -> list disk -> select disk 0 -> list partition', description: 'لیست پارتیشن‌های دیسک 0' }
                ],
                notes: 'دستور بسیار پیشرفته و خطرناک. تغییرات دائمی ایجاد می‌کند. دقت زیادی لازم است.'
            },
            'cipher': {
                name: 'cipher',
                description: 'رمزگذاری یا رمزگشایی دیسک یا فایل‌ها',
                syntax: 'cipher [/E | /D | /C | /L | /W | /R | /P] [pathname [...]]',
                parameters: [
                    { name: '/E', description: 'رمزگذاری یک دایرکتوری.' },
                    { name: '/D', description: 'رمزگشایی یک دایرکتوری.' },
                    { name: '/W', description: 'پاک کردن فضای خالی دیسک (پنهان کردن فایل‌های حذف شده).' }
                ],
                examples: [
                    { example: 'cipher /E C:\\MyFolder', description: 'رمزگذاری پوشه' }
                ],
                notes: 'برای رمزگذاری EFS (Encrypting File System) استفاده می‌شود.'
            },
            'assoc': {
                name: 'assoc',
                description: 'مشاهده یا تنظیم نوع فایل مرتبط با پسوندها',
                syntax: 'assoc [.ext[=File Type]]',
                parameters: [
                    { name: '.ext', description: 'پسوند فایل (مثلاً .txt).' },
                    { name: 'File Type', description: 'نوع فایل مرتبط (مثلاً txtfile).' }
                ],
                examples: [
                    { example: 'assoc .txt', description: 'مشاهده نوع فایل txt' },
                    { example: 'assoc .txt=Notepad', description: 'تغییر نوع فایل txt' }
                ],
                notes: 'برای مدیریت ارتباط پسوند فایل با نوع فایل در رجیستری استفاده می‌شود.'
            },
            'ftype': {
                name: 'ftype',
                description: 'مشاهده یا تنظیم برنامه‌ای که برای باز کردن نوع فایل استفاده می‌شود',
                syntax: 'ftype [file-type[=[open|print|printto]=command_string]]',
                parameters: [
                    { name: 'file-type', description: 'نوع فایل (مثلاً txtfile).' },
                    { name: 'command_string', description: 'دستور اجرا شونده (مسیر برنامه).' }
                ],
                examples: [
                    { example: 'ftype txtfile', description: 'مشاهده دستور باز کردن فایل txt' }
                ],
                notes: 'معمولاً با دستور assoc کار می‌کند.'
            },
            'driverquery': {
                name: 'driverquery',
                description: 'نمایش لیست درایورهای نصب شده',
                syntax: 'driverquery [/S system [/U username [/P [password]]]] [/FO format] [/NH] [/SI]',
                parameters: [
                    { name: '/FO format', description: 'فرمت خروجی.' },
                    { name: '/SI', description: 'شامل اطلاعات امنیتی.' }
                ],
                examples: [
                    { example: 'driverquery', description: 'لیست درایورها' }
                ],
                notes: 'برای بررسی درایورهای نصب شده کاربرد دارد.'
            },
            'netsh': {
                name: 'netsh',
                description: 'پیکربندی و عیب‌یابی شبکه',
                syntax: 'netsh [Context] [Command] [Parameters]',
                parameters: [
                    { name: 'interface', description: 'مدیریت اینترفیس‌های شبکه.' },
                    { name: 'wlan', description: 'مدیریت وای فای.' },
                    { name: 'firewall', description: 'مدیریت فایروال.' },
                    { name: 'show profiles', description: 'نمایش پروفایل‌های وای فای.' }
                ],
                examples: [
                    { example: 'netsh interface show interface', description: 'لیست اینترفیس‌های شبکه' },
                    { example: 'netsh wlan show profiles', description: 'پروفایل‌های وای فای' }
                ],
                notes: 'دستور بسیار پیچیده و قدرتمند برای مدیریت شبکه.'
            },
            'gpupdate': {
                name: 'gpupdate',
                description: 'به‌روزرسانی سیاست‌های گروهی',
                syntax: 'gpupdate [/Target:{Domain | Computer}] [/Force] [/Wait:<value>] [/Source:{LGPO | Registry}] [/Boot] [/Logoff]',
                parameters: [
                    { name: '/Target:Computer', description: 'فقط کامپیوتر.' },
                    { name: '/Target:User', description: 'فقط کاربر.' },
                    { name: '/Force', description: 'اجبار به اعمال تغییرات.' }
                ],
                examples: [
                    { example: 'gpupdate /force', description: 'اجبار به به‌روزرسانی' }
                ],
                notes: 'در محیط‌های دامنه کاربرد دارد.'
            },
            'reg': {
                name: 'reg',
                description: 'کار با رجیستری ویندوز',
                syntax: 'reg [command] [parameters]',
                parameters: [
                    { name: 'query', description: 'پرس و جو از رجیستری.' },
                    { name: 'add', description: 'افزودن مقدار.' },
                    { name: 'delete', description: 'حذف مقدار.' },
                    { name: 'export', description: 'خروجی گرفتن.' },
                    { name: 'import', description: 'وارد کردن.' }
                ],
                examples: [
                    { example: 'reg query "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"', description: 'پرس و جو از نسخه ویندوز' }
                ],
                notes: 'دستور خطرناک. تغییرات نادرست می‌تواند سیستم را غیرقابل استفاده کند.'
            },
            'takeown': {
                name: 'takeown',
                description: 'دریافت دسترسی مالکیت فایل یا پوشه',
                syntax: 'takeown [/s System [/u Username [/p [Password]]]] /f InputFile [/a] [/r [/h]]',
                parameters: [
                    { name: '/f InputFile', description: 'مسیر فایل یا پوشه.' },
                    { name: '/r', description: 'اعمال به زیرشاخه‌ها.' }
                ],
                examples: [
                    { example: 'takeown /f "C:\\ProblemFolder" /r', description: 'دریافت مالکیت پوشه و زیرشاخه‌ها' }
                ],
                notes: 'معمولاً قبل از استفاده از icacls برای تغییر دسترسی استفاده می‌شود.'
            },
            'icacls': {
                name: 'icacls',
                description: 'مشاهده یا تغییر دسترسی‌های فایل/پوشه',
                syntax: 'icacls name [/grant[:r] Sid:perm[...]] [/deny Sid:perm[...]] [/remove[:g|:d]] Sid[...]] [/T] [/C] [/L] [/Q] [/reset] [/setowner name] [/f] [/verify] [/v] [/r] [/p] [/c] [/t] [/h] [/o] [/x] [/y] [/z] [/g] [/d] [/r] [/s] [/e] [/i] [/l] [/b] [/u] [/a] [/m] [/n] [/f] [/v] [/o] [/x] [/y] [/z] [/g] [/d] [/r] [/s] [/e] [/i] [/l] [/b] [/u] [/a] [/m] [/n]',
                parameters: [
                    { name: '/grant Sid:perm', description: 'اعطای دسترسی.' },
                    { name: '/deny Sid:perm', description: 'منع دسترسی.' },
                    { name: '/remove Sid', description: 'حذف دسترسی.' },
                    { name: '/T', description: 'اعمال به زیرشاخه‌ها.' }
                ],
                examples: [
                    { example: 'icacls "C:\\MyFile.txt" /grant Users:R', description: 'اعطای دسترسی خواندن به کاربران' }
                ],
                notes: 'دستور پیشرفته برای مدیریت ACL (Access Control List).'
            },
            'robocopy': {
                name: 'robocopy',
                description: 'کپی پیشرفته فایل‌ها و پوشه‌ها',
                syntax: 'robocopy source destination [file [file]...] [options]',
                parameters: [
                    { name: '/E', description: 'کپی زیرشاخه‌ها، شامل پوشه‌های خالی.' },
                    { name: '/MIR', description: 'نگه داشتن مطابق (همانند ریز، اما حذف فایل‌های اضافی).' },
                    { name: '/LOG:file', description: 'ثبت در فایل.' }
                ],
                examples: [
                    { example: 'robocopy "C:\\Source" "D:\\Dest" /E', description: 'کپی کامل پوشه' }
                ],
                notes: 'جایگزین قدرتمندی برای xcopy.'
            },
            'xcopy': {
                name: 'xcopy',
                description: 'کپی کردن فایل‌ها و پوشه‌ها (منسوخ)',
                syntax: 'xcopy source [destination] [/w] [/p] [/c] [/f] [/s] [/e] [/v] [/y] [/i] [/r] [/h] [/a] [/b] [/k] [/o] [/x] [/g] [/d [:date]] [/exclude:file1[+file2][+file3]...]',
                parameters: [
                    { name: '/s', description: 'کپی زیرشاخه‌ها.' },
                    { name: '/e', description: 'همراه با پوشه‌های خالی.' },
                    { name: '/h', description: 'کپی فایل‌های مخفی.' }
                ],
                examples: [
                    { example: 'xcopy "C:\\Source" "D:\\Dest" /s /e', description: 'کپی پوشه و زیرشاخه‌ها' }
                ],
                notes: 'منسوخ شده، از robocopy استفاده کنید.'
            },
            'format': {
                name: 'format',
                description: 'فرمت کردن یک درایو',
                syntax: 'format volume [/FS:file-system] [/V:label] [/Q] [/A:size] [/C] [/X] [/P:passes] [/S:standard] [/F:size] [/T:tracks /N:sectors] [/B | /S] [/D]',
                parameters: [
                    { name: 'volume', description: 'درایو مورد نظر (مثلاً E:).' },
                    { name: '/FS:file-system', description: 'سیستم فایل (NTFS، FAT32، exFAT).' },
                    { name: '/Q', description: 'فرمت سریع.' }
                ],
                examples: [
                    { example: 'format E: /FS:NTFS', description: 'فرمت کردن درایو E با NTFS' }
                ],
                notes: 'دستور بسیار خطرناک. تمام داده‌های درایو را پاک می‌کند.'
            },
            'copy': {
                name: 'copy',
                description: 'کپی کردن فایل‌ها',
                syntax: 'copy [/d] [/v] [/n] [/y | /-y] [/z] [/l] source [/a | /b] [+ source [/a | /b] [+ ...]] destination [/a | /b]',
                parameters: [
                    { name: 'source', description: 'مسیر فایل منبع.' },
                    { name: 'destination', description: 'مسیر مقصد.' },
                    { name: '/y', description: 'بی‌پرسش نوشتن روی فایل‌های موجود.' }
                ],
                examples: [
                    { example: 'copy file1.txt file2.txt', description: 'کپی فایل' },
                    { example: 'copy *.txt C:\\Backup', description: 'کپی تمام txtها' }
                ],
                notes: 'برای کپی تک فایل یا چند فایل کاربرد دارد.'
            },
            'move': {
                name: 'move',
                description: 'انتقال فایل‌ها',
                syntax: 'move [/y | /-y] [drive:][path]filename1[,...] [drive:][path]filename2',
                parameters: [
                    { name: 'filename1', description: 'فایل یا فایل‌های منبع.' },
                    { name: 'filename2', description: 'مقصد.' },
                    { name: '/y', description: 'بی‌پرسش جایگزینی.' }
                ],
                examples: [
                    { example: 'move file.txt C:\\NewFolder', description: 'انتقال فایل' }
                ],
                notes: 'فایل را از مکان اولیه حذف و به مکان جدید منتقل می‌کند.'
            },
            'del': {
                name: 'del',
                description: 'حذف فایل‌ها',
                syntax: 'del [/p] [/f] [/s] [/q] [/a[[:]attributes]] names',
                parameters: [
                    { name: 'names', description: 'نام فایل یا الگو.' },
                    { name: '/f', description: 'حذف فایل‌های فقط خواندنی.' },
                    { name: '/s', description: 'حذف در زیرشاخه‌ها.' },
                    { name: '/q', description: 'حذف بی‌پرسش.' }
                ],
                examples: [
                    { example: 'del *.tmp', description: 'حذف تمام tmpها' },
                    { example: 'del /s /q "C:\\Temp\\*.*"', description: 'حذف تمام فایل‌های داخل Temp' }
                ],
                notes: 'دقت کنید، فایل‌ها به سطل بازیافت نمی‌روند.'
            },
            'md': {
                name: 'md',
                description: 'ایجاد یک پوشه جدید',
                syntax: 'md [drive:]path',
                parameters: [
                    { name: '[drive:]path', description: 'مسیر پوشه جدید.' }
                ],
                examples: [
                    { example: 'md NewFolder', description: 'ایجاد پوشه در مسیر فعلی' },
                    { example: 'md C:\\MyNewFolder', description: 'ایجاد پوشه در مسیر مشخص' }
                ],
                notes: 'همانند دستور mkdir.'
            },
            'rd': {
                name: 'rd',
                description: 'حذف یک پوشه',
                syntax: 'rd [/s] [/q] [drive:]path',
                parameters: [
                    { name: '[drive:]path', description: 'مسیر پوشه.' },
                    { name: '/s', description: 'حذف پوشه و تمام محتویات آن.' },
                    { name: '/q', description: 'حذف بی‌پرسش.' }
                ],
                examples: [
                    { example: 'rd EmptyFolder', description: 'حذف پوشه خالی' },
                    { example: 'rd /s /q "C:\\OldFolder"', description: 'حذف پوشه و محتویات' }
                ],
                notes: 'دقت کنید، فایل‌ها به سطل بازیافت نمی‌روند.'
            },
            'type': {
                name: 'type',
                description: 'نمایش محتوای یک فایل متنی',
                syntax: 'type [drive:][path]filename',
                parameters: [
                    { name: 'filename', description: 'نام فایل.' }
                ],
                examples: [
                    { example: 'type file.txt', description: 'نمایش محتوای فایل' }
                ],
                notes: 'برای فایل‌های متنی مناسب است.'
            },
            'find': {
                name: 'find',
                description: 'پیدا کردن متن در یک یا چند فایل',
                syntax: 'find [/v] [/c] [/n] [/i] [/off[LINE]] "string" [[drive:][path]filename[ ...]]',
                parameters: [
                    { name: '"string"', description: 'متن جستجو.' },
                    { name: '/i', description: 'نادیدن حروف بزرگ/کوچک.' }
                ],
                examples: [
                    { example: 'find "error" log.txt', description: 'پیدا کردن error در log' }
                ],
                notes: 'برای جستجوی متن در فایل‌های متنی.' },
            'findstr': {
                name: 'findstr',
                description: 'پیدا کردن رشته‌های متنی در فایل‌ها',
                syntax: 'findstr [/b] [/e] [/l] [/r] [/s] [/i] [/x] [/v] [/n] [/m] [/o] [/p] [/f:file] [/c:string] [/g:file] [/d:dir] [/a:color] [/f] "string" [[drive:][path]filename[ ...]]',
                parameters: [
                    { name: '"string"', description: 'رشته جستجو.' },
                    { name: '/i', description: 'نادیدن حروف بزرگ/کوچک.' },
                    { name: '/s', description: 'جستجو در زیرشاخه‌ها.' },
                    { name: '/c:string', description: 'جستجو چند رشته.' }
                ],
                examples: [
                    { example: 'findstr /i "warning" *.log', description: 'پیدا کردن warning در تمام logها' }
                ],
                notes: 'پیشرفته‌تر از find است.' },
            'echo': {
                name: 'echo',
                description: 'نمایش پیام یا فعال/غیرفعال کردن پردازش دستورات',
                syntax: 'echo [on | off] یا echo [message]',
                parameters: [
                    { name: 'on', description: 'فعال کردن نمایش دستورات.' },
                    { name: 'off', description: 'غیرفعال کردن نمایش دستورات.' },
                    { name: 'message', description: 'پیام مورد نظر.' }
                ],
                examples: [
                    { example: 'echo Hello World', description: 'چاپ پیام' },
                    { example: 'echo off', description: 'مخفی کردن دستورات بعدی' }
                ],
                notes: 'در اسکریپت‌های batch کاربرد دارد.' },
            'cls': {
                name: 'cls',
                description: 'پاک کردن صفحه CMD',
                syntax: 'cls',
                parameters: [],
                examples: [
                    { example: 'cls', description: 'پاک کردن صفحه' }
                ],
                notes: 'برای پاک کردن خروجی قبلی CMD.' },
            'ver': {
                name: 'ver',
                description: 'نمایش شماره نسخه ویندوز',
                syntax: 'ver',
                parameters: [],
                examples: [
                    { example: 'ver', description: 'نمایش نسخه' }
                ],
                notes: 'اطلاعات نسخه سیستم عامل.' },
            'date': {
                name: 'date',
                description: 'نمایش یا تنظیم تاریخ',
                syntax: 'date [/t] [/c] [date]',
                parameters: [
                    { name: '/t', description: 'فقط نمایش.' },
                    { name: 'date', description: 'تاریخ جدید (اگر دسترسی ادمین وجود داشته باشد).' }
                ],
                examples: [
                    { example: 'date', description: 'پرسش تاریخ' },
                    { example: 'date /t', description: 'فقط نمایش' }
                ],
                notes: 'تنظیم نیاز به ادمین دارد.' },
            'time': {
                name: 'time',
                description: 'نمایش یا تنظیم زمان',
                syntax: 'time [/t] [/c] [time]',
                parameters: [
                    { name: '/t', description: 'فقط نمایش.' },
                    { name: 'time', description: 'زمان جدید (اگر دسترسی ادمین وجود داشته باشد).' }
                ],
                examples: [
                    { example: 'time', description: 'پرسش زمان' },
                    { example: 'time /t', description: 'فقط نمایش' }
                ],
                notes: 'تنظیم نیاز به ادمین دارد.' },
            'hostname': {
                name: 'hostname',
                description: 'نمایش نام میزبان کامپیوتر',
                syntax: 'hostname',
                parameters: [],
                examples: [
                    { example: 'hostname', description: 'نمایش نام میزبان' }
                ],
                notes: 'نام کامپیوتر در شبکه.' },
            'whoami': {
                name: 'whoami',
                description: 'نمایش نام کاربر فعلی',
                syntax: 'whoami [/user] [/groups] [/priv] [/fqdn] [/logonid] [/upn]',
                parameters: [
                    { name: '/user', description: 'اطلاعات کاربر.' },
                    { name: '/groups', description: 'گروه‌های کاربر.' }
                ],
                examples: [
                    { example: 'whoami', description: 'نام کاربر' },
                    { example: 'whoami /groups', description: 'گروه‌های کاربر' }
                ],
                notes: 'برای شناسایی کاربر فعلی مفید است.' },
            'set': {
                name: 'set',
                description: 'نمایش، ایجاد یا حذف متغیرهای محیطی',
                syntax: 'set [variable=[string]]',
                parameters: [
                    { name: 'variable', description: 'نام متغیر.' },
                    { name: 'string', description: 'مقدار متغیر.' }
                ],
                examples: [
                    { example: 'set', description: 'نمایش تمام متغیرها' },
                    { example: 'set MYVAR=Hello', description: 'تنظیم متغیر' },
                    { example: 'echo %MYVAR%', description: 'چاپ متغیر' }
                ],
                notes: 'برای کار با متغیرهای محیطی در CMD و اسکریپت‌ها.' }
        };

        // Add more detailed command information for PowerShell section
        const detailedPsCommands = {
            'Get-Process': {
                name: 'Get-Process',
                description: 'دریافت اطلاعات فرآیندهای در حال اجرا',
                syntax: 'Get-Process [[-Name] <string[]>] [-FileVersionInfo] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام فرآیند یا فرآیندهای مورد نظر (بدون پسوند).' },
                    { name: '-FileVersionInfo', description: 'دریافت اطلاعات نسخه فایل برای فرآیند.' }
                ],
                examples: [
                    { example: 'Get-Process', description: 'نمایش همه فرآیندها' },
                    { example: 'Get-Process chrome', description: 'نمایش فرآیند chrome' },
                    { example: 'Get-Process | Where-Object {$_.WorkingSet64 -gt 100MB}', description: 'فرآیندهایی که بیش از 100MB حافظه مصرف می‌کنند' }
                ],
                notes: 'این دستور بسیار قدرتمند است و می‌تواند به همراه فیلترها و دیگر دستورات برای تحلیل عمیق‌تر سیستم استفاده شود.'
            },
            'Get-Service': {
                name: 'Get-Service',
                description: 'دریافت اطلاعات سرویس‌های ویندوز',
                syntax: 'Get-Service [[-Name] <string[]>] [-DependentServices] [-Include <string[]>] [-Exclude <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام سرویس.' },
                    { name: '-DependentServices', description: 'سرویس‌های وابسته.' }
                ],
                examples: [
                    { example: 'Get-Service', description: 'نمایش همه سرویس‌ها' },
                    { example: 'Get-Service Spooler', description: 'نمایش سرویس چاپ' }
                ],
                notes: 'برای مدیریت سرویس‌ها کاربرد دارد.'
            },
            'Get-NetIPConfiguration': {
                name: 'Get-NetIPConfiguration',
                description: 'دریافت اطلاعات پیکربندی IP',
                syntax: 'Get-NetIPConfiguration [-InterfaceAlias <string[]>] [-InterfaceIndex <UInt32[]>] [-Detailed] [-All] [<CommonParameters>]',
                parameters: [
                    { name: '-InterfaceAlias', description: 'نام مستعار اینترفیس.' },
                    { name: '-Detailed', description: 'اطلاعات جزئی.' }
                ],
                examples: [
                    { example: 'Get-NetIPConfiguration', description: 'اطلاعات IP' },
                    { example: 'Get-NetIPConfiguration -Detailed', description: 'اطلاعات جزئی' }
                ],
                notes: 'برای تحلیل تنظیمات شبکه.' },
            'Test-NetConnection': {
                name: 'Test-NetConnection',
                description: 'بررسی اتصال شبکه',
                syntax: 'Test-NetConnection [[-ComputerName] <string>] [[-Port] <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-ComputerName', description: 'نام یا IP میزبان.' },
                    { name: '-Port', description: 'شماره پورت.' }
                ],
                examples: [
                    { example: 'Test-NetConnection google.com', description: 'بررسی اتصال به گوگل' },
                    { example: 'Test-NetConnection 192.168.1.1 -Port 80', description: 'بررسی پورت 80' }
                ],
                notes: 'برای تست ping، DNS، Route، و پورت.' },
            'Get-ComputerInfo': {
                name: 'Get-ComputerInfo',
                description: 'دریافت جزئیات سخت‌افزار و نرم‌افزار سیستم',
                syntax: 'Get-ComputerInfo [[-Property] <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-Property', description: 'ویژگی خاص.' }
                ],
                examples: [
                    { example: 'Get-ComputerInfo', description: 'تمام اطلاعات' },
                    { example: 'Get-ComputerInfo -Property "WindowsProductName", "TotalPhysicalMemory"', description: 'اطلاعات خاص' }
                ],
                notes: 'اطلاعات جامعی از سیستم ارائه می‌دهد.' },
            'Get-EventLog': {
                name: 'Get-EventLog',
                description: 'دریافت ورودی‌های گزارش رویداد',
                syntax: 'Get-EventLog [-LogName] <string> [[-InstanceId] <long[]>] [-After <DateTime>] [-Before <DateTime>] [-EntryType <string[]>] [-Index <int[]>] [-Message <string>] [-Newest <int>] [-Source <string[]>] [-UserName <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-LogName', description: 'نام گزارش (مثلاً System، Application).' },
                    { name: '-Newest', description: 'تعداد ورودی‌های جدید.' }
                ],
                examples: [
                    { example: 'Get-EventLog -LogName System -Newest 10', description: '10 ورودی جدید سیستم' }
                ],
                notes: 'برای تحلیل مشکلات.' },
            'Get-WmiObject': {
                name: 'Get-WmiObject',
                description: 'دریافت اشیاء WMI',
                syntax: 'Get-WmiObject [[-Class] <string>] [-List] [-Namespace <string>] [-Impersonation <ImpersonationLevel>] [-Authentication <AuthenticationLevel>] [-Locale <string>] [-EnableAllPrivileges] [-ComputerName <string[]>] [-Credential <PSCredential>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-Class', description: 'نام کلاس WMI (مثلاً Win32_OperatingSystem).' }
                ],
                examples: [
                    { example: 'Get-WmiObject -Class Win32_OperatingSystem', description: 'اطلاعات سیستم عامل' }
                ],
                notes: 'برای دسترسی به داده‌های سیستم.' },
            'Get-ItemProperty': {
                name: 'Get-ItemProperty',
                description: 'دریافت خصوصیات یک آیتم',
                syntax: 'Get-ItemProperty [-Path] <string[]> [-Name <string[]>] [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر آیتم (مثلاً رجیستری یا فایل).' }
                ],
                examples: [
                    { example: 'Get-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"', description: 'اطلاعات رجیستری ویندوز' }
                ],
                notes: 'برای خواندن مقادیر رجیستری یا فایل.' },
            'Set-ItemProperty': {
                name: 'Set-ItemProperty',
                description: 'تنظیم خصوصیات یک آیتم',
                syntax: 'Set-ItemProperty [-Path] <string> [-Name] <string> [-Value] <Object> [-PassThru] [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [-Force] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر.' },
                    { name: '-Name', description: 'نام ویژگی.' },
                    { name: '-Value', description: 'مقدار جدید.' }
                ],
                examples: [
                    { example: 'Set-ItemProperty "HKCU:\\Control Panel\\Desktop" -Name WallpaperStyle -Value 2', description: 'تنظیم حالت تصویر زمینه' }
                ],
                notes: 'برای نوشتن در رجیستری یا فایل.' },
            'Remove-Item': {
                name: 'Remove-Item',
                description: 'حذف یک آیتم',
                syntax: 'Remove-Item [-Path] <string[]> [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [-Recurse] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر.' },
                    { name: '-Recurse', description: 'حذف زیرشاخه‌ها.' }
                ],
                examples: [
                    { example: 'Remove-Item "C:\\Temp\\MyFile.txt"', description: 'حذف فایل' },
                    { example: 'Remove-Item "C:\\Temp\\MyFolder" -Recurse', description: 'حذف پوشه و محتویات' }
                ],
                notes: 'دقت کنید، فایل‌ها به سطل بازیافت نمی‌روند.' },
            'New-Item': {
                name: 'New-Item',
                description: 'ایجاد یک آیتم جدید',
                syntax: 'New-Item [-Path] <string> [[-Name] <string>] [-ItemType <string>] [-Value <Object>] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر.' },
                    { name: '-ItemType', description: 'نوع (Directory، File).' }
                ],
                examples: [
                    { example: 'New-Item -ItemType Directory -Path "C:\\NewFolder"', description: 'ایجاد پوشه' }
                ],
                notes: 'برای ایجاد فایل یا پوشه.' },
            'Get-Content': {
                name: 'Get-Content',
                description: 'دریافت محتوای یک فایل',
                syntax: 'Get-Content [-Path] <string[]> [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [-ReadCount <int>] [-TotalCount <int>] [-Tail <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر فایل.' }
                ],
                examples: [
                    { example: 'Get-Content file.txt', description: 'خواندن فایل' }
                ],
                notes: 'برای خواندن محتوای فایل.' },
            'Set-Content': {
                name: 'Set-Content',
                description: 'تنظیم محتوای یک فایل',
                syntax: 'Set-Content [-Path] <string> [-Value] <Object[]> [-PassThru] [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [-Force] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر فایل.' },
                    { name: '-Value', description: 'محتوای جدید.' }
                ],
                examples: [
                    { example: 'Set-Content file.txt -Value "Hello World"', description: 'نوشتن در فایل' }
                ],
                notes: 'برای نوشتن در فایل.' },
            'Add-Content': {
                name: 'Add-Content',
                description: 'افزودن محتوا به یک فایل',
                syntax: 'Add-Content [-Path] <string[]> [-Value] <Object[]> [-PassThru] [-Filter <string>] [-Include <string[]>] [-Exclude <string[]>] [-Force] [<CommonParameters>]',
                parameters: [
                    { name: '-Path', description: 'مسیر فایل.' },
                    { name: '-Value', description: 'محتوای اضافه.' }
                ],
                examples: [
                    { example: 'Add-Content log.txt -Value "New log entry"', description: 'افزودن به فایل' }
                ],
                notes: 'برای اضافه کردن به فایل.' },
            'Get-Command': {
                name: 'Get-Command',
                description: 'دریافت اطلاعات درباره یک دستور',
                syntax: 'Get-Command [[-Name] <string[]>] [-CommandType <CommandTypes[]>] [-ModuleName <string[]>] [-FullyQualifiedModule <ModuleSpecification[]>] [-TotalCount <int>] [-Syntax] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام دستور.' }
                ],
                examples: [
                    { example: 'Get-Command Get-Process', description: 'اطلاعات دستور' }
                ],
                notes: 'برای کشف دستورات.' },
            'Get-Help': {
                name: 'Get-Help',
                description: 'دریافت راهنما برای یک دستور',
                syntax: 'Get-Help [[-Name] <string>] [-Path <string>] [-Category <string[]>] [-Component <string[]>] [-Functionality <string[]>] [-Role <string[]>] [-Full] [-Online] [-Examples] [-Parameter <string>] [-Detailed] [-All] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام دستور.' },
                    { name: '-Full', description: 'راهنمای کامل.' },
                    { name: '-Examples', description: 'مثال‌ها.' }
                ],
                examples: [
                    { example: 'Get-Help Get-Process', description: 'راهنمای دستور' },
                    { example: 'Get-Help Get-Process -Examples', description: 'مثال‌های دستور' }
                ],
                notes: 'برای یادگیری دستورات.' },
            'Get-Module': {
                name: 'Get-Module',
                description: 'دریافت ماژول‌های نصب شده',
                syntax: 'Get-Module [[-Name] <string[]>] [-All] [-ListAvailable] [-Refresh] [<CommonParameters>]',
                parameters: [
                    { name: '-ListAvailable', description: 'همه ماژول‌های موجود.' }
                ],
                examples: [
                    { example: 'Get-Module', description: 'ماژول‌های بارگذاری شده' },
                    { example: 'Get-Module -ListAvailable', description: 'همه ماژول‌ها' }
                ],
                notes: 'برای مدیریت ماژول‌ها.' },
            'Import-Module': {
                name: 'Import-Module',
                description: 'وارد کردن یک ماژول',
                syntax: 'Import-Module [-Name] <string[]> [-Alias <string[]>] [-ArgumentList <Object[]>] [-AsCustomObject] [-Cmdlet <string[]>] [-DisableNameChecking] [-Force] [-Global] [-Prefix <string>] [-Function <string[]>] [-Variable <string[]>] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام ماژول.' }
                ],
                examples: [
                    { example: 'Import-Module NetSecurity', description: 'بارگذاری ماژول' }
                ],
                notes: 'برای استفاده از دستورات یک ماژول.' },
            'Export-Csv': {
                name: 'Export-Csv',
                description: 'ذخیره اشیاء در یک فایل CSV',
                syntax: 'Export-Csv [-InputObject] <PSObject> [-Path] <string> [-Force] [-NoClobber] [-Encoding <string>] [-Append] [<CommonParameters>]',
                parameters: [
                    { name: '-InputObject', description: 'داده ورودی (معمولاً pipe می‌شود).' },
                    { name: '-Path', description: 'مسیر فایل CSV.' }
                ],
                examples: [
                    { example: 'Get-Process | Export-Csv -Path "processes.csv"', description: 'ذخیره فرآیندها در CSV' }
                ],
                notes: 'برای گزارش‌گیری.' },
            'ConvertTo-Json': {
                name: 'ConvertTo-Json',
                description: 'تبدیل اشیاء به فرمت JSON',
                syntax: 'ConvertTo-Json [-InputObject] <PSObject> [-Depth <int>] [-Compress] [-EnumsAsStrings] [-AsArray] [<CommonParameters>]',
                parameters: [
                    { name: '-InputObject', description: 'داده ورودی.' },
                    { name: '-Depth', description: 'عمق تبدیل.' }
                ],
                examples: [
                    { example: 'Get-ComputerInfo | ConvertTo-Json', description: 'تبدیل اطلاعات سیستم به JSON' }
                ],
                notes: 'برای کار با APIها یا ذخیره داده.' },
            'Invoke-WebRequest': {
                name: 'Invoke-WebRequest',
                description: 'درخواست یک وب',
                syntax: 'Invoke-WebRequest [-Uri] <System.Uri> [-Method <WebRequestMethod>] [-UseBasicParsing] [-SessionVariable <string>] [-AllowUnencryptedAuthentication] [-Authentication <WebAuthenticationType>] [-Credential <pscredential>] [-CertificateThumbprint <string>] [-Certificate <System.Security.Cryptography.X509Certificates.X509Certificate>] [-UserAgent <string>] [-DisableKeepAlive] [-Headers <hashtable>] [-MaximumRedirection <int>] [-MaximumRetryCount <int>] [-RetryIntervalSec <int>] [-Body <Object>] [-ContentType <string>] [-TransferEncoding <string>] [-InFile <string>] [-OutFile <string>] [-ResumeOn <System.Net.Http.HttpResponseMessage>] [-SkipCertificateCheck] [-SkipHeaderValidation] [<CommonParameters>]',
                parameters: [
                    { name: '-Uri', description: 'آدرس URL.' },
                    { name: '-Method', description: 'متد HTTP (GET، POST).' },
                    { name: '-OutFile', description: 'ذخیره خروجی در فایل.' }
                ],
                examples: [
                    { example: 'Invoke-WebRequest -Uri "https://httpbin.org/get" -Method GET', description: 'درخواست GET' },
                    { example: 'Invoke-WebRequest -Uri "https://example.com/file.zip" -OutFile "file.zip"', description: 'دانلود فایل' }
                ],
                notes: 'برای تعامل با وب و APIها.' },
            'Start-Process': {
                name: 'Start-Process',
                description: 'شروع یک فرآیند',
                syntax: 'Start-Process [-FilePath] <string> [-ArgumentList <string[]>] [-WorkingDirectory <string>] [-LoadUserProfile] [-NoNewWindow] [-PassThru] [-RedirectStandardError <string>] [-RedirectStandardInput <string>] [-RedirectStandardOutput <string>] [-Verb <string>] [-WindowStyle <ProcessWindowStyle>] [-Wait] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-FilePath', description: 'مسیر فایل اجرایی.' },
                    { name: '-ArgumentList', description: 'آرگومان‌ها.' },
                    { name: '-Verb', description: 'کار (RunAs برای ادمین).' }
                ],
                examples: [
                    { example: 'Start-Process notepad.exe', description: 'اجرای نوت‌پد' },
                    { example: 'Start-Process cmd.exe -Verb RunAs', description: 'CMD با دسترسی ادمین' }
                ],
                notes: 'برای اجرای برنامه‌ها.' },
            'Stop-Process': {
                name: 'Stop-Process',
                description: 'متوقف کردن یک فرآیند',
                syntax: 'Stop-Process [-Id] <int[]> [-PassThru] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>] یا Stop-Process [-InputObject] <Process[]> [-PassThru] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Id', description: 'PID فرآیند.' },
                    { name: '-Force', description: 'نیروی توقف.' }
                ],
                examples: [
                    { example: 'Stop-Process -Name notepad', description: 'بستن نوت‌پد' },
                    { example: 'Stop-Process -Id 1234 -Force', description: 'نیروی بستن PID 1234' }
                ],
                notes: 'برای بستن فرآیندها.' },
            'Restart-Computer': {
                name: 'Restart-Computer',
                description: 'راه‌اندازی مجدد کامپیوتر',
                syntax: 'Restart-Computer [[-ComputerName] <string[]>] [-Credential <PSCredential>] [-ThrottleLimit <int>] [-Authentication <AuthenticationLevel>] [-DcomAuthentication <PSCredential>] [-Protocol <DcomProtocol>] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Force', description: 'نیروی راه‌اندازی مجدد.' }
                ],
                examples: [
                    { example: 'Restart-Computer -Force', description: 'راه‌اندازی مجدد' }
                ],
                notes: 'نیاز به دسترسی ادمین دارد.' },
            'Stop-Computer': {
                name: 'Stop-Computer',
                description: 'خاموش کردن کامپیوتر',
                syntax: 'Stop-Computer [[-ComputerName] <string[]>] [-Credential <PSCredential>] [-ThrottleLimit <int>] [-Authentication <AuthenticationLevel>] [-DcomAuthentication <PSCredential>] [-Protocol <DcomProtocol>] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Force', description: 'نیروی خاموش کردن.' }
                ],
                examples: [
                    { example: 'Stop-Computer -Force', description: 'خاموش کردن' }
                ],
                notes: 'نیاز به دسترسی ادمین دارد.' },
            'Get-NetAdapter': {
                name: 'Get-NetAdapter',
                description: 'دریافت اطلاعات اداپتورهای شبکه',
                syntax: 'Get-NetAdapter [[-Name] <string[]>] [-IncludeHidden] [-Physical] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام اداپتور.' },
                    { name: '-Physical', description: 'فقط اداپتورهای فیزیکی.' }
                ],
                examples: [
                    { example: 'Get-NetAdapter', description: 'همه اداپتورها' },
                    { example: 'Get-NetAdapter -Physical', description: 'فیزیکی‌ها' }
                ],
                notes: 'برای مدیریت شبکه.' },
            'Get-Disk': {
                name: 'Get-Disk',
                description: 'دریافت اطلاعات دیسک‌ها',
                syntax: 'Get-Disk [[-Number] <UInt32[]>] [-CimSession <CimSession>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-Number', description: 'شماره دیسک.' }
                ],
                examples: [
                    { example: 'Get-Disk', description: 'همه دیسک‌ها' }
                ],
                notes: 'برای مدیریت دیسک.' },
            'Get-Volume': {
                name: 'Get-Volume',
                description: 'دریافت اطلاعات ولوم‌ها',
                syntax: 'Get-Volume [[-DriveLetter] <char[]>] [-CimSession <CimSession>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-DriveLetter', description: 'حرف درایو.' }
                ],
                examples: [
                    { example: 'Get-Volume', description: 'همه ولوم‌ها' },
                    { example: 'Get-Volume -DriveLetter C', description: 'ولوم C' }
                ],
                notes: 'برای مدیریت فضای دیسک.' },
            'Get-NetRoute': {
                name: 'Get-NetRoute',
                description: 'دریافت جدول مسیریابی',
                syntax: 'Get-NetRoute [[-DestinationPrefix] <string[]>] [-NextHop <string[]>] [-InterfaceAlias <string[]>] [-InterfaceIndex <UInt32[]>] [-AddressFamily <AddressFamily>] [-PolicyStore <string>] [-AsJob] [-CimSession <CimSession>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-AddressFamily', description: 'IPv4 یا IPv6.' }
                ],
                examples: [
                    { example: 'Get-NetRoute', description: 'همه مسیرها' }
                ],
                notes: 'برای تحلیل مسیرهای شبکه.' },
            'Set-NetIPInterface': {
                name: 'Set-NetIPInterface',
                description: 'تنظیم پیکربندی اینترفیس IP',
                syntax: 'Set-NetIPInterface [-InterfaceAlias <string[]>] [-InterfaceIndex <UInt32[]>] [-AddressFamily <AddressFamily>] [-AdminSolicitationLimit <UInt32>] [-AdvertisingEnabled <bool>] [-AutomaticMetricEnabled <bool>] [-Dhcp <string>] [-DirectedBroadcastEnabled <bool>] [-DnsAutoConfigurationEnabled <bool>] [-DnsEnabled <bool>] [-DnsSuffix <string>] [-ForwardingEnabled <bool>] [-IgnoreDefaultRoute< bool>] [-ManagedAddressConfigurationEnabled <bool>] [-MulticastForwarding <string>] [-NlMtu <UInt32>] [-OtherStatefulConfigurationEnabled <bool>] [-RouterDiscovery <string>] [-WeakHostReceive <string>] [-WeakHostSend <string>] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-InterfaceAlias', description: 'نام اینترفیس.' },
                    { name: '-AutomaticMetricEnabled', description: 'فعال/غیرفعال کردن متریک خودکار.' }
                ],
                examples: [
                    { example: 'Set-NetIPInterface -InterfaceAlias "Ethernet" -AutomaticMetric Enabled', description: 'فعال کردن متریک خودکار' }
                ],
                notes: 'برای پیکربندی پیشرفته شبکه.' },
            'Get-NetFirewallRule': {
                name: 'Get-NetFirewallRule',
                description: 'دریافت قوانین فایروال',
                syntax: 'Get-NetFirewallRule [-Name <string[]>] [-DisplayName <string[]>] [-Group <string[]>] [-Platform <string[]>] [-PolicyStore <string[]>] [-Profile <string[]>] [-Direction <string[]>] [-Action <string[]>] [-Enabled <string[]>] [-And <CimSession[]>] [-Or <CimSession[]>] [-AsJob] [-CimSession <CimSession[]>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-DisplayName', description: 'نام نمایشی قانون.' },
                    { name: '-Enabled', description: 'وضعیت فعال/غیرفعال.' }
                ],
                examples: [
                    { example: 'Get-NetFirewallRule -DisplayName "*Windows*" -Enabled True', description: 'قوانین فعال مربوط به ویندوز' }
                ],
                notes: 'برای مدیریت فایروال.' },
            'Enable-NetFirewallRule': {
                name: 'Enable-NetFirewallRule',
                description: 'فعال کردن قانون فایروال',
                syntax: 'Enable-NetFirewallRule [-Name] <string[]> [-PassThru] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام قانون.' }
                ],
                examples: [
                    { example: 'Enable-NetFirewallRule -Name "MyRule"', description: 'فعال کردن قانون' }
                ],
                notes: 'برای فعال کردن قانون.' },
            'Disable-NetFirewallRule': {
                name: 'Disable-NetFirewallRule',
                description: 'غیرفعال کردن قانون فایروال',
                syntax: 'Disable-NetFirewallRule [-Name] <string[]> [-PassThru] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام قانون.' }
                ],
                examples: [
                    { example: 'Disable-NetFirewallRule -Name "MyRule"', description: 'غیرفعال کردن قانون' }
                ],
                notes: 'برای غیرفعال کردن قانون.' },
            'Get-LocalUser': {
                name: 'Get-LocalUser',
                description: 'دریافت کاربران محلی',
                syntax: 'Get-LocalUser [[-Name] <string[]>] [-Include <string[]>] [-Exclude <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام کاربر.' }
                ],
                examples: [
                    { example: 'Get-LocalUser', description: 'همه کاربران' }
                ],
                notes: 'برای مدیریت کاربران.' },
            'Get-LocalGroup': {
                name: 'Get-LocalGroup',
                description: 'دریافت گروه‌های محلی',
                syntax: 'Get-LocalGroup [[-Name] <string[]>] [-Include <string[]>] [-Exclude <string[]>] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام گروه.' }
                ],
                examples: [
                    { example: 'Get-LocalGroup', description: 'همه گروه‌ها' }
                ],
                notes: 'برای مدیریت گروه‌ها.' },
            'Get-ScheduledTask': {
                name: 'Get-ScheduledTask',
                description: 'دریافت وظایف زمان‌بندی شده',
                syntax: 'Get-ScheduledTask [[-TaskName] <string[]>] [-TaskPath <string[]>] [-AsJob] [-CimSession <CimSession[]>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-TaskName', description: 'نام وظیفه.' },
                    { name: '-TaskPath', description: 'مسیر وظیفه.' }
                ],
                examples: [
                    { example: 'Get-ScheduledTask', description: 'همه وظایف' }
                ],
                notes: 'برای مدیریت وظایف.' },
            'Start-ScheduledTask': {
                name: 'Start-ScheduledTask',
                description: 'شروع یک وظیفه زمان‌بندی شده',
                syntax: 'Start-ScheduledTask [-TaskName] <string[]> [-TaskPath <string>] [-AsJob] [-CimSession <CimSession[]>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-TaskName', description: 'نام وظیفه.' }
                ],
                examples: [
                    { example: 'Start-ScheduledTask -TaskName "MyTask"', description: 'شروع وظیفه' }
                ],
                notes: 'برای شروع وظیفه.' },
            'Stop-ScheduledTask': {
                name: 'Stop-ScheduledTask',
                description: 'متوقف کردن یک وظیفه زمان‌بندی شده',
                syntax: 'Stop-ScheduledTask [-TaskName] <string[]> [-TaskPath <string>] [-AsJob] [-CimSession <CimSession[]>] [-ThrottleLimit <int>] [<CommonParameters>]',
                parameters: [
                    { name: '-TaskName', description: 'نام وظیفه.' }
                ],
                examples: [
                    { example: 'Stop-ScheduledTask -TaskName "MyTask"', description: 'متوقف کردن وظیفه' }
                ],
                notes: 'برای توقف وظیفه.' },
            'Get-HotFix': {
                name: 'Get-HotFix',
                description: 'دریافت لیست به‌روزرسانی‌های نصب شده',
                syntax: 'Get-HotFix [[-Id] <string[]>] [-ComputerName <string[]>] [-Credential <PSCredential>] [<CommonParameters>]',
                parameters: [
                    { name: '-Id', description: 'شماره به‌روزرسانی.' }
                ],
                examples: [
                    { example: 'Get-HotFix', description: 'همه به‌روزرسانی‌ها' }
                ],
                notes: 'برای بررسی نصب به‌روزرسانی‌ها.' },
            'Get-WindowsUpdateLog': {
                name: 'Get-WindowsUpdateLog',
                description: 'دریافت گزارش به‌روزرسانی‌های ویندوز',
                syntax: 'Get-WindowsUpdateLog [-LogPath <string>] [-SummaryPath <string>] [<CommonParameters>]',
                parameters: [
                    { name: '-LogPath', description: 'مسیر گزارش.' }
                ],
                examples: [
                    { example: 'Get-WindowsUpdateLog', description: 'گزارش به‌روزرسانی' }
                ],
                notes: 'برای تحلیل مشکلات به‌روزرسانی.' },
            'Get-AppxPackage': {
                name: 'Get-AppxPackage',
                description: 'دریافت بسته‌های نصب شده UWP',
                syntax: 'Get-AppxPackage [[-Name] <string>] [-AllUsers] [-User <string>] [-PackageTypeFilter <string>] [<CommonParameters>]',
                parameters: [
                    { name: '-Name', description: 'نام بسته.' },
                    { name: '-AllUsers', description: 'همه کاربران.' }
                ],
                examples: [
                    { example: 'Get-AppxPackage', description: 'همه بسته‌ها' }
                ],
                notes: 'برای مدیریت اپ‌های UWP.' },
            'Get-ExecutionPolicy': {
                name: 'Get-ExecutionPolicy',
                description: 'دریافت سیاست اجرای اسکریپت',
                syntax: 'Get-ExecutionPolicy [[-Scope] <ExecutionPolicyScope>] [-List] [<CommonParameters>]',
                parameters: [
                    { name: '-Scope', description: 'محدوده (CurrentUser، LocalMachine، ...).' }
                ],
                examples: [
                    { example: 'Get-ExecutionPolicy', description: 'سیاست فعلی' }
                ],
                notes: 'برای بررسی مجاز بودن اجرای اسکریپت.' },
            'Set-ExecutionPolicy': {
                name: 'Set-ExecutionPolicy',
                description: 'تنظیم سیاست اجرای اسکریپت',
                syntax: 'Set-ExecutionPolicy [-ExecutionPolicy] <ExecutionPolicy> [-Scope <ExecutionPolicyScope>] [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]',
                parameters: [
                    { name: '-ExecutionPolicy', description: 'سیاست (Restricted، RemoteSigned، ...).' },
                    { name: '-Scope', description: 'محدوده.' },
                    { name: '-Force', description: 'بدون تأیید.' }
                ],
                examples: [
                    { example: 'Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser', description: 'تنظیم سیاست' }
                ],
                notes: 'نیاز به دسترسی ادمین دارد.' }
        };

        // Add more detailed command information for Run section
        const detailedRunCommands = {
            'cmd': {
                name: 'cmd',
                description: 'اجرای خط فرمان (Command Prompt)',
                syntax: 'cmd [/A | /U] [/Q] [/D] [/E:ON | /E:OFF] [/F:ON | /F:OFF] [/V:ON | /V:OFF] [[/S] [/C | /K] string]',
                parameters: [
                    { name: '/C', description: 'اجرای دستور مشخص شده و سپس خروج.' },
                    { name: '/K', description: 'اجرای دستور مشخص شده و ماندن در CMD.' },
                    { name: '/S', description: 'تغییر نحوه پردازش /C یا /K.' }
                ],
                examples: [
                    { example: 'cmd', description: 'باز کردن CMD معمولی' },
                    { example: 'cmd /C dir C:\\', description: 'اجرای یک دستور و خروج' },
                    { example: 'cmd /K ipconfig', description: 'اجرای یک دستور و ماندن در CMD' }
                ],
                notes: 'این دستور یکی از پایه‌ای‌ترین راه‌های دسترسی به محیط خط فرمان است. برای اجرای بیشتر دستورات CMD مناسب است.'
            },
            'powershell': {
                name: 'powershell',
                description: 'اجرای PowerShell',
                syntax: 'powershell.exe [-ExecutionPolicy {Bypass | AllSigned | RemoteSigned | Restricted}] [-NoLogo] [-NonInteractive] [-NoProfile] [-WindowStyle {Normal | Minimized | Maximized | Hidden}] [-Command { - | filename [args] | {scriptblock} [-args args] }]',
                parameters: [
                    { name: '-ExecutionPolicy', description: 'سیاست اجرای اسکریپت.' },
                    { name: '-NoProfile', description: 'عدم بارگذاری پروفایل.' },
                    { name: '-Command', description: 'اجرای یک دستور یا اسکریپت.' }
                ],
                examples: [
                    { example: 'powershell', description: 'باز کردن PowerShell' },
                    { example: 'powershell -NoProfile', description: 'بدون پروفایل' },
                    { example: 'powershell -Command "Get-Process"', description: 'اجرای یک دستور' }
                ],
                notes: 'محیط پیشرفته‌تر نسبت به CMD.' },
            'msconfig': {
                name: 'msconfig',
                description: 'پیکربندی سیستم ویندوز',
                syntax: 'msconfig',
                parameters: [],
                examples: [
                    { example: 'msconfig', description: 'باز کردن پیکربندی سیستم' }
                ],
                notes: 'برای مدیریت موارد راه‌اندازی و خدمات.' },
            'regedit': {
                name: 'regedit',
                description: 'ویرایشگر رجیستری',
                syntax: 'regedit [/s] [filename]',
                parameters: [
                    { name: '/s', description: 'اجرای فایل .reg بدون نمایش.' }
                ],
                examples: [
                    { example: 'regedit', description: 'باز کردن ویرایشگر' }
                ],
                notes: 'برای دسترسی مستقیم به رجیستری. دقت زیادی لازم است.' },
            'taskmgr': {
                name: 'taskmgr',
                description: 'مدیر وظیفه (Task Manager)',
                syntax: 'taskmgr',
                parameters: [],
                examples: [
                    { example: 'taskmgr', description: 'باز کردن مدیر وظیفه' }
                ],
                notes: 'برای نظارت بر فرآیندها و منابع.' },
            'devmgmt.msc': {
                name: 'devmgmt.msc',
                description: 'مدیریت دستگاه‌ها',
                syntax: 'devmgmt.msc',
                parameters: [],
                examples: [
                    { example: 'devmgmt.msc', description: 'باز کردن مدیریت دستگاه‌ها' }
                ],
                notes: 'برای مدیریت درایورها و دستگاه‌های سخت‌افزاری.' },
            'services.msc': {
                name: 'services.msc',
                description: 'مدیریت سرویس‌ها',
                syntax: 'services.msc',
                parameters: [],
                examples: [
                    { example: 'services.msc', description: 'باز کردن مدیریت سرویس‌ها' }
                ],
                notes: 'برای مدیریت سرویس‌های سیستم.' },
            'dxdiag': {
                name: 'dxdiag',
                description: 'اطلاعات سخت‌افزار دیسک ت Direct X',
                syntax: 'dxdiag',
                parameters: [],
                examples: [
                    { example: 'dxdiag', description: 'باز کردن اطلاعات Direct X' }
                ],
                notes: 'برای بررسی اطلاعات گرافیک و صدا.' },
            'gpedit.msc': {
                name: 'gpedit.msc',
                description: 'ویرایشگر سیاست گروهی (Professional/Enterprise)',
                syntax: 'gpedit.msc',
                parameters: [],
                examples: [
                    { example: 'gpedit.msc', description: 'باز کردن سیاست گروهی' }
                ],
                notes: 'در ویندوز Home در دسترس نیست.' },
            'perfmon': {
                name: 'perfmon',
                description: 'مانیتور عملکرد',
                syntax: 'perfmon',
                parameters: [],
                examples: [
                    { example: 'perfmon', description: 'باز کردن مانیتور عملکرد' }
                ],
                notes: 'برای نظارت پیشرفته بر عملکرد.' },
            'eventvwr.msc': {
                name: 'eventvwr.msc',
                description: 'نمایشگر رویدادها',
                syntax: 'eventvwr.msc',
                parameters: [],
                examples: [
                    { example: 'eventvwr.msc', description: 'باز کردن گزارش رویدادها' }
                ],
                notes: 'برای تحلیل خطاها و عملکرد.' },
            'diskmgmt.msc': {
                name: 'diskmgmt.msc',
                description: 'مدیریت دیسک',
                syntax: 'diskmgmt.msc',
                parameters: [],
                examples: [
                    { example: 'diskmgmt.msc', description: 'باز کردن مدیریت دیسک' }
                ],
                notes: 'برای مدیریت پارتیشن‌ها و درایوها.' },
            'compmgmt.msc': {
                name: 'compmgmt.msc',
                description: 'مدیریت کامپیوتر',
                syntax: 'compmgmt.msc',
                parameters: [],
                examples: [
                    { example: 'compmgmt.msc', description: 'باز کردن مدیریت کامپیوتر' }
                ],
                notes: 'مرکزی برای مدیریت سیستم.' },
            'cleanmgr': {
                name: 'cleanmgr',
                description: 'پاک‌سازی دیسک',
                syntax: 'cleanmgr [/d DriveLetter] [/sageset:Number] [/sagerun:Number]',
                parameters: [
                    { name: '/d DriveLetter', description: 'درایو مورد نظر.' }
                ],
                examples: [
                    { example: 'cleanmgr', description: 'باز کردن پاک‌سازی دیسک' }
                ],
                notes: 'برای آزاد کردن فضای دیسک.' },
            'defrag': {
                name: 'defrag',
                description: 'دیفرگمنت کردن درایو',
                syntax: 'defrag [Volume] [/U] [/V] [/A] [/F] [/H] [/M [Time] [/I [Time]] [/X] [/B] [/R [Threshold]] [/L] [/E [Volume] [...]] [/O] [/L]',
                parameters: [
                    { name: 'Volume', description: 'درایو مورد نظر (مثلاً C:).' },
                    { name: '/U', description: 'نمایش پیشرفت.' },
                    { name: '/V', description: 'نمایش اطلاعات جزئی.' },
                    { name: '/O', description: 'بهینه‌سازی کامل.' }
                ],
                examples: [
                    { example: 'defrag C:', description: 'دیفرگمنت C' },
                    { example: 'defrag C: /O', description: 'بهینه‌سازی کامل C' }
                ],
                notes: 'برای بهبود عملکرد HDD.' },
            'notepad': {
                name: 'notepad',
                description: 'اجرای نوت‌پد',
                syntax: 'notepad [FileName]',
                parameters: [
                    { name: 'FileName', description: 'نام فایل برای باز کردن.' }
                ],
                examples: [
                    { example: 'notepad', description: 'اجرای نوت‌پد' },
                    { example: 'notepad file.txt', description: 'باز کردن فایل' }
                ],
                notes: 'ویرایشگر متن ساده.' },
            'calc': {
                name: 'calc',
                description: 'اجرای ماشین حساب',
                syntax: 'calc',
                parameters: [],
                examples: [
                    { example: 'calc', description: 'اجرای ماشین حساب' }
                ],
                notes: 'ابزار ماشین حساب.' },
            'mspaint': {
                name: 'mspaint',
                description: 'اجرای نقاشی مایکروسافت',
                syntax: 'mspaint [FileName]',
                parameters: [
                    { name: 'FileName', description: 'نام فایل تصویر.' }
                ],
                examples: [
                    { example: 'mspaint', description: 'اجرای نقاشی' }
                ],
                notes: 'ابزار نقاشی.' },
            'write': {
                name: 'write',
                description: 'اجرای ویرایشگر واژه (Wordpad)',
                syntax: 'write [FileName]',
                parameters: [
                    { name: 'FileName', description: 'نام فایل.' }
                ],
                examples: [
                    { example: 'write', description: 'اجرای Wordpad' }
                ],
                notes: 'ویرایشگر پیشرفته‌تر از نوت‌پد.' },
            'control': {
                name: 'control',
                description: 'پنل کنترل',
                syntax: 'control [PageName]',
                parameters: [
                    { name: 'PageName', description: 'نام صفحه خاص (اختیاری).' }
                ],
                examples: [
                    { example: 'control', description: 'باز کردن پنل کنترل' }
                ],
                notes: 'مرکز تنظیمات سیستم.' },
            'control printers': {
                name: 'control printers',
                description: 'مدیریت چاپگرها',
                syntax: 'control printers',
                parameters: [],
                examples: [
                    { example: 'control printers', description: 'باز کردن مدیریت چاپگرها' }
                ],
                notes: 'برای مدیریت چاپگرها.' },
            'inetcpl.cpl': {
                name: 'inetcpl.cpl',
                description: 'تنظیمات اینترنت',
                syntax: 'inetcpl.cpl',
                parameters: [],
                examples: [
                    { example: 'inetcpl.cpl', description: 'باز کردن تنظیمات اینترنت' }
                ],
                notes: 'برای تنظیمات مرورگر.' },
            'ncpa.cpl': {
                name: 'ncpa.cpl',
                description: 'کانکشن‌های شبکه',
                syntax: 'ncpa.cpl',
                parameters: [],
                examples: [
                    { example: 'ncpa.cpl', description: 'باز کردن کانکشن‌های شبکه' }
                ],
                notes: 'برای مدیریت اتصالات شبکه.' },
            'sysdm.cpl': {
                name: 'sysdm.cpl',
                description: 'خواص سیستم',
                syntax: 'sysdm.cpl',
                parameters: [],
                examples: [
                    { example: 'sysdm.cpl', description: 'باز کردن خواص سیستم' }
                ],
                notes: 'برای تنظیمات سیستم و سخت‌افزار.' },
            'appwiz.cpl': {
                name: 'appwiz.cpl',
                description: 'نصب/حذف برنامه‌ها',
                syntax: 'appwiz.cpl',
                parameters: [],
                examples: [
                    { example: 'appwiz.cpl', description: 'باز کردن نصب/حذف برنامه‌ها' }
                ],
                notes: 'برای مدیریت نرم‌افزارها.' },
            'firewall.cpl': {
                name: 'firewall.cpl',
                description: 'تنظیمات فایروال',
                syntax: 'firewall.cpl',
                parameters: [],
                examples: [
                    { example: 'firewall.cpl', description: 'باز کردن تنظیمات فایروال' }
                ],
                notes: 'برای مدیریت فایروال.' },
            'timedate.cpl': {
                name: 'timedate.cpl',
                description: 'تنظیمات تاریخ و زمان',
                syntax: 'timedate.cpl',
                parameters: [],
                examples: [
                    { example: 'timedate.cpl', description: 'باز کردن تنظیمات تاریخ و زمان' }
                ],
                notes: 'برای تنظیم ساعت و تاریخ.' },
            'main.cpl': {
                name: 'main.cpl',
                description: 'تنظیمات ماوس',
                syntax: 'main.cpl',
                parameters: [],
                examples: [
                    { example: 'main.cpl', description: 'باز کردن تنظیمات ماوس' }
                ],
                notes: 'برای تنظیمات ماوس.' },
            'mmsys.cpl': {
                name: 'mmsys.cpl',
                description: 'تنظیمات صدا',
                syntax: 'mmsys.cpl',
                parameters: [],
                examples: [
                    { example: 'mmsys.cpl', description: 'باز کردن تنظیمات صدا' }
                ],
                notes: 'برای تنظیمات صدا.' },
            'desk.cpl': {
                name: 'desk.cpl',
                description: 'تنظیمات نمایشگر',
                syntax: 'desk.cpl',
                parameters: [],
                examples: [
                    { example: 'desk.cpl', description: 'باز کردن تنظیمات نمایشگر' }
                ],
                notes: 'برای تنظیمات صفحه نمایش.' },
            'intl.cpl': {
                name: 'intl.cpl',
                description: 'تنظیمات منطقه',
                syntax: 'intl.cpl',
                parameters: [],
                examples: [
                    { example: 'intl.cpl', description: 'باز کردن تنظیمات منطقه' }
                ],
                notes: 'برای تنظیمات زبان و منطقه.' },
            'usrmgr.cpl': {
                name: 'usrmgr.cpl',
                description: 'مدیریت کاربران (Home)',
                syntax: 'usrmgr.cpl',
                parameters: [],
                examples: [
                    { example: 'usrmgr.cpl', description: 'باز کردن مدیریت کاربران' }
                ],
                notes: 'در ویندوز Home محدود است.' },
            'secpol.msc': {
                name: 'secpol.msc',
                description: 'تنظیمات امنیت محلی (Professional/Enterprise)',
                syntax: 'secpol.msc',
                parameters: [],
                examples: [
                    { example: 'secpol.msc', description: 'باز کردن تنظیمات امنیت محلی' }
                ],
                notes: 'در ویندوز Home در دسترس نیست.' },
            'certmgr.msc': {
                name: 'certmgr.msc',
                description: 'مدیریت گواهینامه‌ها',
                syntax: 'certmgr.msc',
                parameters: [],
                examples: [
                    { example: 'certmgr.msc', description: 'باز کردن مدیریت گواهینامه‌ها' }
                ],
                notes: 'برای مدیریت گواهی‌ها.' },
            'lusrmgr.msc': {
                name: 'lusrmgr.msc',
                description: 'مدیریت کاربران و گروه‌های محلی (Professional/Enterprise)',
                syntax: 'lusrmgr.msc',
                parameters: [],
                examples: [
                    { example: 'lusrmgr.msc', description: 'باز کردن مدیریت کاربران محلی' }
                ],
                notes: 'در ویندوز Home در دسترس نیست.' },
            'mstsc': {
                name: 'mstsc',
                description: 'اتصال دسکتاپ از راه دور',
                syntax: 'mstsc [/v:ServerName] [/admin] [/f] [/w:width] [/h:height] ...',
                parameters: [
                    { name: '/v:ServerName', description: 'نام یا IP سرور.' }
                ],
                examples: [
                    { example: 'mstsc', description: 'باز کردن اتصال راه دور' }
                ],
                notes: 'برای دسترسی از راه دور.' },
            'mobsync': {
                name: 'mobsync',
                description: 'همگام‌سازی',
                syntax: 'mobsync',
                parameters: [],
                examples: [
                    { example: 'mobsync', description: 'باز کردن همگام‌سازی' }
                ],
                notes: 'برای همگام‌سازی داده.' },
            'explorer': {
                name: 'explorer',
                description: 'اجرای مرورگر فایل',
                syntax: 'explorer [Path]',
                parameters: [
                    { name: 'Path', description: 'مسیر اولیه.' }
                ],
                examples: [
                    { example: 'explorer', description: 'باز کردن مرورگر فایل' },
                    { example: 'explorer C:\\Users', description: 'باز کردن مسیر خاص' }
                ],
                notes: 'مرورگر فایل پیش‌فرض.' },
            'iexplore': {
                name: 'iexplore',
                description: 'اجرای اینترنت اکسپلورر',
                syntax: 'iexplore [URL]',
                parameters: [
                    { name: 'URL', description: 'آدرس وب.' }
                ],
                examples: [
                    { example: 'iexplore', description: 'اجرای اینترنت اکسپلورر' }
                ],
                notes: 'مرورگر قدیمی مایکروسافت.' },
            'winver': {
                name: 'winver',
                description: 'نمایش اطلاعات نسخه ویندوز',
                syntax: 'winver',
                parameters: [],
                examples: [
                    { example: 'winver', description: 'نمایش نسخه ویندوز' }
                ],
                notes: 'اطلاعات نسخه و ساخت.' },
            'shutdown': {
                name: 'shutdown',
                description: 'خاموش کردن یا راه‌اندازی مجدد سیستم',
                syntax: 'shutdown [/s | /r | /l | /a] [/t time] [/c "comment"] ...',
                parameters: [
                    { name: '/s', description: 'خاموش کردن.' },
                    { name: '/r', description: 'راه‌اندازی مجدد.' },
                    { name: '/t time', description: 'زمان انتظار به ثانیه.' },
                    { name: '/c "comment"', description: 'توضیح.' }
                ],
                examples: [
                    { example: 'shutdown /s /t 0', description: 'خاموش کردن فوری' },
                    { example: 'shutdown /r /t 60', description: 'راه‌اندازی مجدد بعد از 60 ثانیه' }
                ],
                notes: 'نیاز به دسترسی ادمین ممکن است داشته باشد.' },
            'slmgr.vbs': {
                name: 'slmgr.vbs',
                description: 'مدیریت لایسنس ویندوز',
                syntax: 'slmgr.vbs [Option]',
                parameters: [
                    { name: '/dli', description: 'نمایش وضعیت لایسنس.' },
                    { name: '/dlv', description: 'نمایش جزئیات لایسنس.' },
                    { name: '/xpr', description: 'تاریخ انقضا.' }
                ],
                examples: [
                    { example: 'slmgr.vbs /dli', description: 'بررسی وضعیت لایسنس' }
                ],
                notes: 'برای مدیریت فعال‌سازی.' }
        };

        // Override the showDetails function to use detailed information
        CommandManager.showDetails = (command, type) => {
            // Update active state in list
            document.querySelectorAll(`#${type}CommandList .command-list-item`).forEach(item => {
                item.classList.remove('active');
            });

            // Find the detailed info
            let detailedInfo = null;
            let titleId, contentId, pinBtnId, copyBtnId, execBtnId, detailsContent = '';

            switch (type) {
                case 'cmd':
                    detailedInfo = detailedCmdCommands[command.name];
                    titleId = 'commandDetailsTitle';
                    contentId = 'commandDetailsContent';
                    pinBtnId = 'pinCommandBtn';
                    copyBtnId = 'copyCommandBtn';
                    execBtnId = 'executeCommandBtn';
                    break;
                case 'ps':
                    detailedInfo = detailedPsCommands[command.name];
                    titleId = 'psCommandDetailsTitle';
                    contentId = 'psCommandDetailsContent';
                    pinBtnId = 'pinPsCommandBtn';
                    copyBtnId = 'copyPsCommandBtn';
                    execBtnId = 'executePsCommandBtn';
                    break;
                case 'run':
                    detailedInfo = detailedRunCommands[command.name];
                    titleId = 'runCommandDetailsTitle';
                    contentId = 'runCommandDetailsContent';
                    pinBtnId = 'pinRunCommandBtn';
                    copyBtnId = 'copyRunCommandBtn';
                    execBtnId = 'executeRunCommandBtn';
                    break;
            }

            if (!detailedInfo) {
                // Fallback to basic if detailed not found
                detailedInfo = command;
            }

            // Build HTML content
            detailsContent = `
                <h4 class="command-details-title">${Utils.sanitizeInput(detailedInfo.name)}</h4>
                <p class="command-details-description">
                    ${Utils.sanitizeInput(detailedInfo.description)}
                </p>
                <div class="command-details-syntax">
                    ${Utils.sanitizeInput(detailedInfo.syntax)}
                </div>
                <div class="command-details-parameters">
                    <h5>پارامترها:</h5>
                    ${detailedInfo.parameters.map(param => `
                        <div class="parameter-item">
                            <div class="parameter-name">${Utils.sanitizeInput(param.name)}</div>
                            <div class="parameter-desc">${Utils.sanitizeInput(param.description)}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="command-details-examples">
                    <h5>مثال‌ها:</h5>
                    ${detailedInfo.examples.map(ex => `
                        <div class="example-item">
                            <p><strong>${Utils.sanitizeInput(ex.example)}:</strong></p>
                            <div class="example-code">${Utils.sanitizeInput(ex.example)}</div>
                            <p>${Utils.sanitizeInput(ex.description)}</p>
                        </div>
                    `).join('')}
                </div>
                <div class="command-details-notes">
                    <h5>نکات:</h5>
                    <p>${Utils.sanitizeInput(detailedInfo.notes)}</p>
                </div>
            `;

            // Update UI
            if (titleId) document.getElementById(titleId).textContent = detailedInfo.name;
            if (contentId) document.getElementById(contentId).innerHTML = detailsContent;

            // Store reference for copy/execute
            ArkaApp.state.activeCommandDetails = { command: detailedInfo, type };

            // Attach event listeners for actions
            if (copyBtnId) {
                const copyBtn = document.getElementById(copyBtnId);
                copyBtn.onclick = () => CommandManager.copyCommand(detailedInfo.name);
            }
            if (execBtnId) {
                const execBtn = document.getElementById(execBtnId);
                execBtn.onclick = () => CommandManager.executeCommand(detailedInfo.name, type);
            }
            if (pinBtnId) {
                const pinBtn = document.getElementById(pinBtnId);
                pinBtn.onclick = () => CommandManager.pinCommand(detailedInfo.name, type);
            }
        };

        // ============================================
        // 16. Enhanced AI Manager (with context and history)
        // ============================================

        AIManager.handleChatInput = () => {
            const inputElement = document.getElementById('aiChatInput');
            const message = inputElement.value.trim();
            if (!message) return;

            // Add user message to chat and history
            AIManager.addMessageToChat(message, 'user');
            ArkaApp.state.chatHistory.push({ sender: 'user', text: message, timestamp: new Date().toISOString() });

            // Clear input
            inputElement.value = '';

            // Simulate AI response with context
            setTimeout(() => {
                const aiResponse = AIManager.generateResponse(message, ArkaApp.state.chatHistory);
                AIManager.addMessageToChat(aiResponse, 'ai');
                ArkaApp.state.chatHistory.push({ sender: 'ai', text: aiResponse, timestamp: new Date().toISOString() });

                // Save updated history
                Storage.set('arka_chat_history', ArkaApp.state.chatHistory);
            }, 1000); // Simulate processing delay
        };

        AIManager.generateResponse = (input, history) => {
            // Improved simulation with context
            const lowerInput = input.toLowerCase();
            const lastUserMessage = history.filter(h => h.sender === 'user').pop();

            // Contextual responses based on previous messages
            if (history.length > 2 && lastUserMessage && lastUserMessage.text.toLowerCase().includes('داغ')) {
                if (lowerInput.includes('چگونه') || lowerInput.includes('راه') || lowerInput.includes('کمک')) {
                    return "برای حل مشکل گرمای سیستم، می‌توانید ابتدا دستور <code>msinfo32</code> را از بخش 'Run' اجرا کنید تا اطلاعات سخت‌افزار را بررسی کنید. اگر پردازنده یا گرافیک شما مدام در حد بالا کار می‌کنند، ممکن است یک فرآیند مشکوک باشد. می‌توانید از <code>tasklist</code> در CMD یا <code>Get-Process</code> در PowerShell برای بررسی فرآیندهای پر مصرف استفاده کنید. همچنین چک کنید که خنک‌کننده‌ها (فروترها) دچار گرد و غبار نشده باشند. آیا می‌خواهید نحوه بررسی فرآیندهای پر مصرف را بدانید؟";
                }
            }

            if (lowerInput.includes('سیستم') && lowerInput.includes('داغ')) {
                return "به نظر می‌رسد مشکل گرمای سیستم دارید. می‌توانید دستور <code>msinfo32</code> را از بخش 'Run' اجرا کنید تا جزئیات سخت‌افزار را بررسی کنید. همچنین می‌توانید از بخش 'دستورات' دستور <code>perfmon</code> را برای بررسی مانیتور عملکرد امتحان کنید. آیا می‌خواهید راهنمایی بیشتری داشته باشید؟";
            }
            if (lowerInput.includes('فضای') && lowerInput.includes('دیسک')) {
                return "برای آزاد کردن فضای دیسک، می‌توانید از دستور <code>cleanmgr</code> در بخش 'Run' استفاده کنید. همچنین دستور <code>dir /s</code> در CMD می‌تواند کمک کند تا فایل‌های بزرگ را پیدا کنید. آیا می‌خواهید چگونه این کار را انجام دهم؟";
            }
            if (lowerInput.includes('سرعت') && lowerInput.includes('ویندوز')) {
                return "برای افزایش سرعت ویندوز، می‌توانید خدمات غیرضروری را غیرفعال کنید. از منوی بالا بخش 'PowerShell' را انتخاب کنید و دستور <code>Get-Service | Where-Object {$_.StartType -eq 'Automatic' -and $_.Status -eq 'Stopped'}</code> را جستجو کنید. سپس می‌توانید وضعیت آن‌ها را بررسی و تغییر دهید. همچنین دستور <code>msconfig</code> در 'Run' می‌تواند کمک کننده باشد.";
            }
            if (lowerInput.includes('cmd') || lowerInput.includes('خط فرمان')) {
                return "CMD (خط فرمان) یک محیط متنی برای اجرای دستورات ویندوز است. می‌توانید دستوراتی مانند <code>dir</code> برای لیست فایل‌ها، <code>ipconfig</code> برای اطلاعات شبکه، یا <code>tasklist</code> برای فرآیندها را اجرا کنید. از منوی بالا بخش 'CMD' را انتخاب کنید تا لیست کامل دستورات را ببینید و کمک لازم را دریافت کنید.";
            }
            if (lowerInput.includes('powershell')) {
                return "PowerShell یک محیط پیشرفته‌تر نسبت به CMD است که از اسکریپت‌نویسی پشتیبانی می‌کند. می‌توانید از دستوراتی مانند <code>Get-Process</code>، <code>Get-Service</code>، یا <code>Get-NetIPConfiguration</code> استفاده کنید. از منوی بالا بخش 'PowerShell' را انتخاب کنید تا لیست کامل دستورات را ببینید.";
            }
            if (lowerInput.includes('run')) {
                return "پنجره 'Run' (یا دستور Run) امکان اجرای سریع برنامه‌ها و ابزارهای سیستمی را فراهم می‌کند. دستوراتی مانند <code>msconfig</code>، <code>regedit</code>، <code>taskmgr</code> و بسیاری دیگر را می‌توان از این طریق اجرا کرد. از منوی بالا بخش 'Run' را انتخاب کنید.";
            }
            if (lowerInput.includes('سلام') || lowerInput.includes('درود') || lowerInput.includes('خوبی')) {
                return "درود! من دستیار هوش مصنوعی Arka هستم. چطور می‌تونم کمکتون کنم؟ می‌تونی در مورد مشکل سیستمت، دستور خاصی که نیاز داری یا نحوه اجرای کاری بپرسی. من می‌تونم بین CMD، PowerShell و Run کمک کنم.";
            }
            if (lowerInput.includes('ممنون') || lowerInput.includes('خوب بود')) {
                return "خواهش می‌کنم! اگر سوال دیگه‌ای داشتی، در خدمتم.";
            }

            return "ممنون از پیام شما. من یک مدل زبانی هوش مصنوعی هستم و در حال حاضر قادر به اجرای مستقیم دستورات روی سیستم شما نیستم، اما می‌توانم راهنمایی‌های لازم را بر اساس دانش خود ارائه دهم. لطفاً مشکل یا سوال خود را با جزئیات بیشتری بیان کنید. می‌توانم در مورد دستورات CMD، PowerShell یا Run کمک کنم.";
        };

        // Load chat history on init
        AIManager.loadHistory = () => {
            const chatContainer = document.getElementById('chatMessages');
            chatContainer.innerHTML = ''; // Clear current chat view
            ArkaApp.state.chatHistory.forEach(msg => {
                AIManager.addMessageToChat(msg.text, msg.sender);
            });
        };

        // ============================================
        // 17. Enhanced Page Manager (with history load)
        // ============================================

        PageManager.loadAiCenter = () => {
            // Load chat history when AI center is opened
            AIManager.loadHistory();
        };

        // ============================================
        // 18. Quick Actions Handler
        // ============================================

        const QuickActions = {
            init: () => {
                document.querySelectorAll('.action-btn[data-action]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = btn.getAttribute('data-action');
                        QuickActions.executeAction(action);
                    });
                });
            },

            executeAction: (action) => {
                EventManager.track('quick_action_clicked', { action });
                let commandToExecute = '';
                let type = 'run'; // Default to Run for these quick actions

                switch (action) {
                    case 'disk-cleanup':
                        commandToExecute = 'cleanmgr';
                        break;
                    case 'defrag':
                        commandToExecute = 'defrag C:';
                        break;
                    case 'update':
                        commandToExecute = 'wuapp'; // Opens Windows Update UI
                        break;
                    case 'backup':
                        commandToExecute = 'control /name Microsoft.BackupAndRestore'; // Opens Backup UI
                        break;
                    case 'optimize':
                        commandToExecute = 'msconfig';
                        break;
                    case 'security-scan':
                        // This is a common command for Windows Defender quick scan
                        commandToExecute = 'powershell -WindowStyle Hidden -Command "Start-MpScan -ScanType QuickScan"';
                        type = 'cmd'; // Technically runs via cmd, but executes ps command
                        break;
                    default:
                        Toast.show('این اقدام هنوز پیاده‌سازی نشده است.', 'warning');
                        return;
                }

                if (commandToExecute) {
                    Toast.show(`در حال تلاش برای اجرای "${commandToExecute}"...`, 'info');
                    // Simulate execution as before
                    CommandManager.executeCommand(commandToExecute, type);
                }
            }
        };

        // ============================================
        // 19. System Alert Manager (Simulated)
        // ============================================

        const SystemAlertManager = {
            alerts: [
                { id: 1, type: 'warning', title: 'به‌روزرسانی در دسترس', message: 'به‌روزرسانی امنیتی برای ویندوز موجود است. لطفاً در اسرع وقت نصب کنید.', time: '10:30' },
                { id: 2, type: 'info', title: 'پشتیبان‌گیری توصیه می‌شود', message: 'آخرین نسخه پشتیبان سیستم شما بیش از یک هفته است. در نظر داشته باشید یک نسخه جدید تهیه کنید.', time: '09:45' },
                { id: 3, type: 'warning', title: 'دیسک C: پر است', message: 'فضای دیسک C: به 90% رسیده است. پیشنهاد می‌شود فایل‌های زائد را پاک کنید.', time: '08:15' }
            ],

            showNextAlert: () => {
                // In a real app, this would be triggered by system events or polling.
                // Here we just simulate showing an alert periodically.
                const container = document.getElementById('systemAlertsContainer');
                if (container && SystemAlertManager.alerts.length > 0) {
                    const alertData = SystemAlertManager.alerts.pop(); // Get the last one
                    SystemAlertManager.displayAlert(alertData);
                }
            },

            displayAlert: (alertData) => {
                const container = document.getElementById('systemAlertsContainer');
                const alertElement = document.createElement('div');
                alertElement.className = `system-alert alert-${alertData.type} show`;
                alertElement.setAttribute('role', 'alert');
                alertElement.setAttribute('aria-live', 'polite');
                alertElement.innerHTML = `
                    <div class="toast-content">
                        <div class="toast-icon">${alertData.type === 'warning' ? '⚠️' : 'ℹ️'}</div>
                        <div class="toast-message">
                            <strong>${Utils.sanitizeInput(alertData.title)}</strong><br>
                            ${Utils.sanitizeInput(alertData.message)}
                        </div>
                    </div>
                    <button class="toast-close" aria-label="بستن اعلان">&times;</button>
                `;

                container.appendChild(alertElement);

                // Auto-hide after 10 seconds
                setTimeout(() => {
                    alertElement.classList.remove('show');
                    setTimeout(() => {
                        if (alertElement.parentNode) {
                            alertElement.parentNode.removeChild(alertElement);
                        }
                    }, 300);
                }, 10000);

                alertElement.querySelector('.toast-close').addEventListener('click', () => {
                    alertElement.classList.remove('show');
                    setTimeout(() => {
                        if (alertElement.parentNode) {
                            alertElement.parentNode.removeChild(alertElement);
                        }
                    }, 300);
                });
            }
        };

        // ============================================
        // 20. Improved Event Tracking (Rate Limited)
        // ============================================

        EventManager.track = (eventName, eventData = {}) => {
            if (typeof eventName !== 'string') {
                console.error('Invalid event name:', eventName);
                return;
            }

            // Rate limiting - max 10 events per second per user session
            const now = Date.now();
            if (!ArkaApp.state.eventTimestamps) {
                ArkaApp.state.eventTimestamps = [];
            }
            const recentEvents = ArkaApp.state.eventTimestamps.filter(ts => now - ts < 1000);
            if (recentEvents.length >= 10) {
                console.warn('Event rate limit exceeded for session');
                return;
            }
            recentEvents.push(now);
            ArkaApp.state.eventTimestamps = recentEvents.slice(-20); // Keep last 20 timestamps

            // Log event
            const eventLog = {
                event: eventName,
                data: Utils.deepClone(eventData),
                time: now,
                url: window.location.href,
                userAgent: navigator.userAgent,
                language: navigator.language
            };
            // console.log(`📊 Event tracked: ${eventName}`, eventLog); // Comment out for prod

            // Store in memory
            ArkaApp.state.eventLog.push(eventLog);

            // Store in localStorage for persistence (last 100)
            Storage.set('arka_events', ArkaApp.state.eventLog.slice(-100));
        };

        // ============================================
        // 21. Sound Manager (Placeholder - Preload simulation)
        // ============================================

        const SoundManager = {
            init: () => {
                // In a real app, you would preload sounds here.
                // For this static demo, we just simulate the availability.
                console.log('SoundManager initialized (simulated)');
                // ArkaApp.sounds.click = new Audio('path/to/click.wav');
                // ArkaApp.sounds.success = new Audio('path/to/success.wav');
                // ArkaApp.sounds.error = new Audio('path/to/error.wav');
                // ArkaApp.sounds.terminal = new Audio('path/to/terminal.wav');
                // Preload simulation
                ArkaApp.config.soundEnabled = Storage.get('arka_sound_enabled', ArkaApp.config.soundEnabled);
                document.getElementById('soundIcon').className = ArkaApp.config.soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
            }
        };

        // ============================================
        // 22. Theme Manager (with localStorage persistence)
        // ============================================

        const ThemeManager = {
            init: () => {
                const savedTheme = Storage.get('arka_theme', ArkaApp.config.theme);
                ThemeManager.setTheme(savedTheme);
            },

            setTheme: (theme) => {
                ArkaApp.config.theme = theme;
                document.body.setAttribute('data-theme', theme);
                Storage.set('arka_theme', theme);
                // Update theme icon if necessary
                // This is handled by the toggle function now
            }
        };

        // ============================================
        // 23. Main Initialization Updates
        // ============================================

        const initApp = async () => {
            console.log('Initializing Arka App v' + ArkaApp.config.version);

            // 1. Initialize Storage and State
            ArkaApp.state.permissions = Storage.get('arka_permissions', ArkaApp.state.permissions);
            ArkaApp.state.systemInfo = Storage.get('arka_system_info', ArkaApp.state.systemInfo);
            ArkaApp.state.chatHistory = Storage.get('arka_chat_history', ArkaApp.state.chatHistory);
            ArkaApp.state.pinnedCommands = [
                ...Storage.get('cmd_pinned', []),
                ...Storage.get('ps_pinned', []),
                ...Storage.get('run_pinned', [])
            ];

            // 2. Check for Mobile
            if (ArkaApp.state.isMobile) {
                document.getElementById('mobileWarningOverlay').style.display = 'flex';
                document.getElementById('closeMobileWarningBtn').addEventListener('click', () => {
                    document.getElementById('mobileWarningOverlay').style.display = 'none';
                });
            }

            // 3. Simulate Loading Progress
            const progressFill = document.getElementById('loadingProgressFill');
            const progressText = document.getElementById('loadingProgressText');
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `${progress}%`;
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        document.getElementById('loadingOverlay').classList.add('hidden');
                        document.body.classList.remove('no-js');
                        document.getElementById('mainContent').classList.add('loaded');
                        ArkaApp.state.isLoading = false;
                    }, 500);
                }
            }, 200); // Simulate loading time

            // 4. Initialize Managers after loading
            setTimeout(() => {
                // Load commands
                CommandManager.loadCommands();

                // Initialize Chart Manager
                ChartManager.init();

                // Initialize Sound Manager
                SoundManager.init();

                // Initialize Theme Manager
                ThemeManager.init();

                // Initialize Page Manager
                PageManager.init();

                // Initialize AI Manager
                AIManager.init();

                // Initialize Quick Actions
                QuickActions.init();

                // Attach global event listeners
                document.getElementById('themeToggleBtn').addEventListener('click', toggleTheme);
                document.getElementById('soundToggleBtn').addEventListener('click', toggleSound);

                // Attach search listeners (already defined above, no need to redefine)

                // Modal Close Buttons (already defined above, no need to redefine)

                // Close modals on overlay click (already defined above, no need to redefine)

                // Initialize System Alert Manager simulation
                // Show an alert every 30 seconds for demo
                // setInterval(SystemAlertManager.showNextAlert, 30000);

            }, 1100); // Match the simulated loading time

            // 5. Request Basic Permissions (example)
            const profiler = new SystemProfiler();
            // Request basic info on initial load (this is just an example trigger)
            // setTimeout(() => profiler.requestPermission('basicInfo'), 3000);

            console.log('Arka App initialized.');
        };

    </script>
</body>
</html>
